<!DOCTYPE html>
<html lang="en"><head><title>msfconsole :: Cardboard Iguana Security</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto Sans Mono&amp;family=Noto Sans:wght@400;700&amp;family=Noto Sans:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Cardboard Iguana Security"/><meta property="og:title" content="msfconsole :: Cardboard Iguana Security"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="msfconsole :: Cardboard Iguana Security"/><meta name="twitter:description" content="Basic Metasploit flow: use $MODULE_NAME set $OPTIONS run You can use msfconsole as a shell, but there’s no redirect functionality. Commands back — exit the current module db_nmap $FLAGS $IP — run Nmap and dump the results into the Metasploit DB; all Nmap $FLAGS are supported and Metasploit will elevate privileges if necessary help — get Metasploit help history — display command history hosts — display known hosts in DB hosts -d — delete saved hosts from DB info — show module information (including exploit target options) jobs — check the status of background jobs options (advanced) — show module/exploit options (or “advanced” options) run/exploit — run the selected exploit run -j — run the selected exploit as a background job search — search modules; query to a particular type of module using the type: parameter (e.g., search type:exploit wordpress) services — display services discovered in known hosts in DB sessions — list open meterpreter sessions on a box sessions -i $SESSION_NUMER — connect to meterpreter session $SESSION_NUMBER show auxiliary — show auxiliary modules, filtered by relevancy if called from within a module show exploits — show exploit modules show options — show module options show payloads — show payload modules, filtered by relevancy if called from within a module spool — save all console output to a log file (useful for record-keeping) use — select a Metasploit module/exploit vulns — display vulnerabilities discovered in known hosts in DB workspace — use workspaces; keeps database results isolated per engagement Note that you can also call regular shell commands (ip, ls, etc.) from msfconsole."/><meta property="og:description" content="Basic Metasploit flow: use $MODULE_NAME set $OPTIONS run You can use msfconsole as a shell, but there’s no redirect functionality. Commands back — exit the current module db_nmap $FLAGS $IP — run Nmap and dump the results into the Metasploit DB; all Nmap $FLAGS are supported and Metasploit will elevate privileges if necessary help — get Metasploit help history — display command history hosts — display known hosts in DB hosts -d — delete saved hosts from DB info — show module information (including exploit target options) jobs — check the status of background jobs options (advanced) — show module/exploit options (or “advanced” options) run/exploit — run the selected exploit run -j — run the selected exploit as a background job search — search modules; query to a particular type of module using the type: parameter (e.g., search type:exploit wordpress) services — display services discovered in known hosts in DB sessions — list open meterpreter sessions on a box sessions -i $SESSION_NUMER — connect to meterpreter session $SESSION_NUMBER show auxiliary — show auxiliary modules, filtered by relevancy if called from within a module show exploits — show exploit modules show options — show module options show payloads — show payload modules, filtered by relevancy if called from within a module spool — save all console output to a log file (useful for record-keeping) use — select a Metasploit module/exploit vulns — display vulnerabilities discovered in known hosts in DB workspace — use workspaces; keeps database results isolated per engagement Note that you can also call regular shell commands (ip, ls, etc.) from msfconsole."/><meta property="og:image:type" content="image/webp"/><meta property="og:image:alt" content="Basic Metasploit flow: use $MODULE_NAME set $OPTIONS run You can use msfconsole as a shell, but there’s no redirect functionality. Commands back — exit the current module db_nmap $FLAGS $IP — run Nmap and dump the results into the Metasploit DB; all Nmap $FLAGS are supported and Metasploit will elevate privileges if necessary help — get Metasploit help history — display command history hosts — display known hosts in DB hosts -d — delete saved hosts from DB info — show module information (including exploit target options) jobs — check the status of background jobs options (advanced) — show module/exploit options (or “advanced” options) run/exploit — run the selected exploit run -j — run the selected exploit as a background job search — search modules; query to a particular type of module using the type: parameter (e.g., search type:exploit wordpress) services — display services discovered in known hosts in DB sessions — list open meterpreter sessions on a box sessions -i $SESSION_NUMER — connect to meterpreter session $SESSION_NUMBER show auxiliary — show auxiliary modules, filtered by relevancy if called from within a module show exploits — show exploit modules show options — show module options show payloads — show payload modules, filtered by relevancy if called from within a module spool — save all console output to a log file (useful for record-keeping) use — select a Metasploit module/exploit vulns — display vulnerabilities discovered in known hosts in DB workspace — use workspaces; keeps database results isolated per engagement Note that you can also call regular shell commands (ip, ls, etc.) from msfconsole."/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:url" content="https://cardboard-iguana.com/grimoire/static/social-images/..-obsidian-spells-msfconsole.md.webp"/><meta name="twitter:image" content="https://cardboard-iguana.com/grimoire/static/social-images/..-obsidian-spells-msfconsole.md.webp"/><meta property="og:image" content="https://cardboard-iguana.com/grimoire/static/social-images/..-obsidian-spells-msfconsole.md.webp"/><meta property="twitter:domain" content="cardboard-iguana.com/grimoire"/><meta property="og:url" content="https://cardboard-iguana.com/grimoire/spells/msfconsole"/><meta property="twitter:url" content="https://cardboard-iguana.com/grimoire/spells/msfconsole"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="Basic Metasploit flow: use $MODULE_NAME set $OPTIONS run You can use msfconsole as a shell, but there’s no redirect functionality. Commands back — exit the current module db_nmap $FLAGS $IP — run Nmap and dump the results into the Metasploit DB; all Nmap $FLAGS are supported and Metasploit will elevate privileges if necessary help — get Metasploit help history — display command history hosts — display known hosts in DB hosts -d — delete saved hosts from DB info — show module information (including exploit target options) jobs — check the status of background jobs options (advanced) — show module/exploit options (or “advanced” options) run/exploit — run the selected exploit run -j — run the selected exploit as a background job search — search modules; query to a particular type of module using the type: parameter (e.g., search type:exploit wordpress) services — display services discovered in known hosts in DB sessions — list open meterpreter sessions on a box sessions -i $SESSION_NUMER — connect to meterpreter session $SESSION_NUMBER show auxiliary — show auxiliary modules, filtered by relevancy if called from within a module show exploits — show exploit modules show options — show module options show payloads — show payload modules, filtered by relevancy if called from within a module spool — save all console output to a log file (useful for record-keeping) use — select a Metasploit module/exploit vulns — display vulnerabilities discovered in known hosts in DB workspace — use workspaces; keeps database results isolated per engagement Note that you can also call regular shell commands (ip, ls, etc.) from msfconsole."/><meta name="generator" content="Quartz"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="spells/msfconsole"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"></div><div class="center"><div class="page-header"><header><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="..//">Cardboard Iguana Security</a><p> / </p></div><div class="breadcrumb-element"><a href="../spells/">spells</a><p> / </p></div><div class="breadcrumb-element"><a href>msfconsole</a></div></nav><div class="spacer"></div><button class="darkmode" id="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button><div class="search"><button class="search-button" id="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div></header><div class="popover-hint"><p show-comma="true" class="content-meta"><time datetime="2025-01-03T18:19:44.255Z">Friday, January 3, 2025</time><span>7 min read</span></p><ul class="tags"><li><a href="../tags/Application/Metasploit/msfconsole" class="internal tag-link">Application/Metasploit/msfconsole</a></li><li><a href="../tags/AttackCycle/CommandAndControl" class="internal tag-link">AttackCycle/CommandAndControl</a></li><li><a href="../tags/AttackCycle/AntiForensics" class="internal tag-link">AttackCycle/AntiForensics</a></li><li><a href="../tags/AttackCycle/Exploitation" class="internal tag-link">AttackCycle/Exploitation</a></li><li><a href="../tags/Application/SSH" class="internal tag-link">Application/SSH</a></li><li><a href="../tags/Application/Nmap" class="internal tag-link">Application/Nmap</a></li><li><a href="../tags/Protocol/TCP" class="internal tag-link">Protocol/TCP</a></li><li><a href="../tags/Protocol/UDP" class="internal tag-link">Protocol/UDP</a></li><li><a href="../tags/Protocol/HTTP" class="internal tag-link">Protocol/HTTP</a></li><li><a href="../tags/Protocol/SMB" class="internal tag-link">Protocol/SMB</a></li><li><a href="../tags/Protocol/SMTP" class="internal tag-link">Protocol/SMTP</a></li><li><a href="../tags/Application/MySQL" class="internal tag-link">Application/MySQL</a></li><li><a href="../tags/AttackCycle/Exploitation/BruteForcing" class="internal tag-link">AttackCycle/Exploitation/BruteForcing</a></li><li><a href="../tags/Cryptography/Hashes/NT" class="internal tag-link">Cryptography/Hashes/NT</a></li><li><a href="../tags/Application/Metasploit/msfvenom" class="internal tag-link">Application/Metasploit/msfvenom</a></li><li><a href="../tags/Application/Metasploit/meterpreter" class="internal tag-link">Application/Metasploit/meterpreter</a></li><li><a href="../tags/Application/PsExec" class="internal tag-link">Application/PsExec</a></li><li><a href="../tags/OS/Windows" class="internal tag-link">OS/Windows</a></li><li><a href="../tags/Application/JohnTheRipper" class="internal tag-link">Application/JohnTheRipper</a></li><li><a href="../tags/Protocol/RDP" class="internal tag-link">Protocol/RDP</a></li><li><a href="../tags/AttackCycle/LateralMovement" class="internal tag-link">AttackCycle/LateralMovement</a></li><li><a href="../tags/Application/proxychains" class="internal tag-link">Application/proxychains</a></li><li><a href="../tags/Protocol/SOCKS" class="internal tag-link">Protocol/SOCKS</a></li></ul></div></div><article class="popover-hint"><p>Basic Metasploit flow:</p>
<ul>
<li><code>use $MODULE_NAME</code></li>
<li><code>set $OPTIONS</code></li>
<li><code>run</code></li>
</ul>
<p>You can use msfconsole as a shell, but there’s no redirect functionality.</p>
<h2 id="commands">Commands<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#commands" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li><code>back</code> — exit the current module</li>
<li><code>db_nmap $FLAGS $IP</code> — run <a href="../spells/Nmap" class="internal alias" data-slug="spells/Nmap">Nmap</a> and dump the results into the Metasploit DB; all <a href="../spells/Nmap" class="internal alias" data-slug="spells/Nmap">Nmap</a> <code>$FLAGS</code> are supported and Metasploit will elevate privileges if necessary</li>
<li><code>help</code> — get Metasploit help</li>
<li><code>history</code> — display command history</li>
<li><code>hosts</code> — display known hosts in DB</li>
<li><code>hosts -d</code> — delete saved hosts from DB</li>
<li><code>info</code> — show module information (including exploit target options)</li>
<li><code>jobs</code> — check the status of background jobs</li>
<li><code>options</code> (<code>advanced</code>) — show module/exploit options (or “advanced” options)</li>
<li><code>run</code>/<code>exploit</code> — run the selected exploit</li>
<li><code>run -j</code> — run the selected exploit as a background job</li>
<li><code>search</code> — search modules; query to a particular type of module using the <code>type:</code> parameter (e.g., <code>search type:exploit wordpress</code>)</li>
<li><code>services</code> — display services discovered in known hosts in DB</li>
<li><code>sessions</code> — list open <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a> sessions on a box</li>
<li><code>sessions -i $SESSION_NUMER</code> — connect to <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a> session <code>$SESSION_NUMBER</code></li>
<li><code>show auxiliary</code> — show auxiliary modules, filtered by relevancy if called from within a module</li>
<li><code>show exploits</code> — show exploit modules</li>
<li><code>show options</code> — show module options</li>
<li><code>show payloads</code> — show payload modules, filtered by relevancy if called from within a module</li>
<li><code>spool</code> — save all console output to a log file (useful for record-keeping)</li>
<li><code>use</code> — select a Metasploit module/exploit</li>
<li><code>vulns</code> — display vulnerabilities discovered in known hosts in DB</li>
<li><code>workspace</code> — use workspaces; keeps database results isolated per engagement</li>
</ul>
<p>Note that you can also call regular shell commands (ip, ls, etc.) from msfconsole. You can also background processes using <code>Ctrl + Z</code> (Metasploit will trap this, so you don’t have to worry about backgrounding the entire msfconsole).</p>
<h2 id="modules">Modules<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#modules" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Module categories:</p>
<ul>
<li>Auxiliary (odds-n-ends)</li>
<li>Encoders (re-encode exploits to thwart signature-based anti-malware solutions)</li>
<li>Evasion (attempt to directly evade anti-malware solutions)</li>
<li>Exploits</li>
<li>NOPS (no-op code that can be used to pad exploits to a needed size)</li>
<li>Payloads (what you want to run if the exploit is successful; often, but not always, some kind of shell)</li>
<li>Post (additional post-exploitation tools)</li>
</ul>
<p>Note that Metasploit 6 apparently calls these “framework plugins” now.</p>
<ul>
<li><strong>Remember:</strong> Open up the port Metasploit’s going to use in your firewall <em>before</em> running the exploit. Generally this is port 4444 by default (set with LPORT).</li>
<li><strong>Also Remember:</strong> Be sure to set LHOST (and, when applicable, SRVHOST) correctly, even if it’s not indicated by the module. Metasploit’s guesses about which interface to use aren’t always correct… (I find using the explicit IP address works better than specifying the interface device or leaving SRVHOST at the default of 0.0.0.0.)</li>
<li><strong>Also <em>also</em> Remember:</strong> Sometimes you might find yourself in the position of trying to exploit a service over an <a href="../spells/SSH" class="internal alias" data-slug="spells/SSH">SSH</a> tunnel (for example, if you’re trying to exploit a service that’s not exposed externally in order to elevate your privileges). When doing this, remember that LHOST is still your machine’s external address, as the exploit won’t be connecting back over the <a href="../spells/SSH" class="internal alias" data-slug="spells/SSH">SSH</a> tunnel (obviously)! Since LHOST is also used to determine where the exploit’s listener binds to, it’s sometimes necessary to set the optional ReverseListenerBindAddress in these cases (typically when you do this, LHOST will be some remote system you’re tunneled into, and ReverseListenerBindAddress will be 127.0.0.1).</li>
</ul>
<h3 id="options">Options<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#options" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>The common RHOSTS option accepts IP addresses, ranges, CIDR networks, and even a file with one target per line (specify as <code>file:/path/to/file.txt</code>).</p>
<p>Most modules support the ARCH, PAYLOAD, and SESSION options (for specifying target architecture, the payload to deliver, or session number to connect to). However, these are <em>not</em> shown when running <code>show options</code>.</p>
<p>You can reset individual parameters using <code>unset</code>, and reset the entire module using <code>unset all</code>.</p>
<p>Equivalent module commands:</p>
<ul>
<li><code>set -g</code> = <code>setg</code></li>
<li><code>unset -g</code> = <code>unsetg</code></li>
<li><code>run</code> = <code>exploit</code></li>
</ul>
<p>Some exploit modules have a <code>check</code> option which attempts to determine if a target is vulnerable without actually exploiting it. Alternately, other modules have a paired auxiliary scanner. Many <em>don’t</em> have a check at all. YMMV!</p>
<h2 id="payloads">Payloads<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#payloads" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Payloads can be divided into:</p>
<ul>
<li>Singles (self-contained; also indicated by the use of an <code>_</code> separating “shell” from the rest of the payload name, as in <code>shell_reverse_tcp</code>)</li>
<li>Stagers (small applications that establish a connection back to the attacker to download a larger, more complex payload)</li>
<li>Stages (payloads designed to be downloaded by a stager; also indicated by the use of a <code>/</code> separating “shell” from the rest of the payload name, as in <code>shell/reverse_tcp</code>)</li>
</ul>
<p>Payloads follow the OS/ARCHITECTURE/PAYLOAD (though ARCHITECTURE is not included for 32-bit Windows payloads).</p>
<blockquote class="callout important" data-callout="important">
<div class="callout-title">
                  <div class="callout-icon"></div>
                  <div class="callout-title-inner"><p>Important</p></div>
                  
                </div>
<div class="callout-content">
<p>Metasploit defaults to sending 32-bit payloads, but an increasing number of things won’t work on a 64-bit system from a 32-bit <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a> shell. It’s probably best to explicitly set the <code>payload</code> option to use a 64-bit payload unless you <em>know</em> that you’ll be dealing with a 32-bit system.</p>
</div>
</blockquote>
<p>List all available payloads using <code>msfvenom --list payloads</code> or <code>show payloads</code> from within the Metasploit console.</p>
<p>A specific payload can be set in the Metasploit console use the <code>set PAYLOAD full/path/to/payload</code>.</p>
<p>If you initially get a native shell, use the <code>post/multi/manage/shell_to_meterpreter</code> module to upgrade to Meterpeter.</p>
<blockquote class="callout note" data-callout="note">
<div class="callout-title">
                  <div class="callout-icon"></div>
                  <div class="callout-title-inner"><p>Note</p></div>
                  
                </div>
<div class="callout-content">
<p><code>shell_to_meterpreter</code> creates a new connection on a new port, by default 4433.</p>
</div>
</blockquote>
<h3 id="scanners">Scanners<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#scanners" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Use <code>search portscan</code> to display built-in Metasploit port scanners. Note that msfconsole needs to be run as root for many scans to work — just like <a href="../spells/Nmap" class="internal alias" data-slug="spells/Nmap">Nmap</a>. That said, in my experience the fancier <a href="../spells/TCP" class="internal alias" data-slug="spells/TCP">TCP</a> scans (for example, SYN) don’t work over a VPN… So maybe best to stick with <a href="../spells/Nmap" class="internal alias" data-slug="spells/Nmap">Nmap</a>.</p>
<p>Targeted scanners can be more useful, however:</p>
<ul>
<li>The <code>auxiliary/scanner/discovery/udp_sweep</code> module will probe for common <a href="../spells/UDP" class="internal alias" data-slug="spells/UDP">UDP</a> services.</li>
<li>The <code>auxiliary/scanner/http/http_version</code> module will give you <a href="../spells/HTTP" class="internal alias" data-slug="spells/HTTP">HTTP</a> server version information.</li>
<li>The <code>auxiliary/scanner/smb/smb_login</code> module will allow you to conduct brute-force and password spraying attacks against Samba logins.</li>
</ul>
<p>Metasploit has a variety of Samba/CIFS scanners too (use <code>search scanner/smb</code> to list them), as well as modules for basic enumeration such as <code>smtp_version</code>/<code>smtp_enum</code> (for <a href="../spells/SMTP" class="internal alias" data-slug="spells/SMTP">SMTP</a>) and <code>mysql_sql</code> (for <a href="../spells/MySQL" class="internal alias" data-slug="spells/MySQL">MySQL</a>, though this seems to just be a thin wrapper around the <a href="../spells/MySQL" class="internal alias" data-slug="spells/MySQL">MySQL</a> command line client).</p>
<h3 id="exploits">Exploits<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#exploits" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><code>exploit/multi/handler</code> — Catch a shell produced using <a href="../spells/msfvenom" class="internal alias" data-slug="spells/msfvenom">msfvenom</a>. Note that you’ll need to use <code>set payload</code> to tell Metasploit <em>what</em> it’s catching — for example, <code>windows/meterpreter/reverse_tcp</code> (or <code>windows/x64/meterpreter/reverse_tcp</code>). Both regular reverse shells and <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a> sessions can be caught this way.</li>
<li><code>exploit/windows/smb/psexec</code> — Call PsExec over SMB (instantiates <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a> by default). <em>Only works if <code>SMBUser</code> has admin privileges on the target!</em></li>
</ul>
<p>Note that any Windows exploit that requires a password will also accept an NTLM hash (the LMHash part can be replaced by an appropriately-sized string of 0 characters if not available).</p>
<h3 id="meterpreter">meterpreter<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#meterpreter" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Potentially useful Metsploit modules to <code>run</code> from/besides <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a>:</p>
<ul>
<li><code>post/windows/gather/checkvm</code> — try to determine if we’re in a VM</li>
<li><code>post/multi/recon/local_exploit_suggester</code> — find possible privilege escalation exploits (can be slow/unreliably on 64-bit architectures)</li>
<li><code>post/windows/gather/enum_shares</code> — enumerate shares</li>
<li><code>auxiliary/scanner/smb/smb_enumusers_domain</code> — enumerate SMB domain users (requires existing admin credentials)</li>
<li><code>post/windows/gather/hashdump</code> — same as the <a href="https://www.utc.edu/sites/default/files/2021-04/4660-lab6.pdf" class="external" target="_blank">hashdump command<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>, but pushes the hashes into the Metasploit DB</li>
<li><code>post/windows/gather/smart_hashdump GETSYSTEM=FALSE</code> — same as the hashdump command, but pushes the hashes into the Metasploit DB and ignores system accounts</li>
<li><code>auxiliary/analyze/crack_windows</code> — sic <a href="../spells/John-the-Ripper" class="internal alias" data-slug="spells/John-the-Ripper">John the Ripper</a> or <a href="../spells/Hashcat" class="internal alias" data-slug="spells/Hashcat">Hashcat</a> on <a href="../spells/NTLM-hashes" class="internal alias" data-slug="spells/NTLM-hashes">NTLM hashes</a> stored in the Metasploit DB</li>
<li><code>post/windows/manage/enable_rdp</code> — enable RDP access (requires admin privileges)</li>
<li><code>post/multi/manage/autoroute</code> — manipulate target routing for pivoting</li>
<li><code>auxiliary/server/socks_proxy</code> — start a SOCKS proxy</li>
<li><code>exploit/windows/local/persistence</code> — sets up a persistent connection (you probably want to <code>set STARTUP SYSTEM</code>)… <em>without a password!</em></li>
</ul>
<blockquote class="callout tip" data-callout="tip">
<div class="callout-title">
                  <div class="callout-icon"></div>
                  <div class="callout-title-inner"><p>Tip</p></div>
                  
                </div>
<div class="callout-content">
<p>It is generally more useful to background <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a> and then run these commands through the Metasploit console, as within <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a> they need to have all options specified on the “run” command line (in the console you can access help, actually <em>see</em> what the options are, etc.).</p>
</div>
</blockquote>
<p>There seem to be a lot of options for the <code>post/multi/manage/autoroute</code> and <code>auxiliary/server/socks_proxy</code> modules, but I don’t see a way to access them from <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a> (it looks like to get help you need to background <a href="../spells/meterpreter" class="internal alias" data-slug="spells/meterpreter">meterpreter</a> and use the console).</p>
<p>The advantage of setting up a SOCKS proxy on the target is that you can then use proxychains to route through the target; this can allow you to pivot more deeply into the network that you’re attacking. (You probably want to create a custom proxychains.conf file to do this. Fortunately, /etc/proxychains.conf is well documented.)</p>
<h3 id="cifs">CIFS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cifs" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Metasploit can also enumerate CIFS users using the <code>auxiliary/smb/smb_lookupsid</code> module.</p>
<p>Like <a href="../spells/Nmap" class="internal alias" data-slug="spells/Nmap">Nmap</a>, I’ve found this to be a bit unreliable on UNIX-like systems.</p>
<h3 id="ms-sql">MS SQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ms-sql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p></p><blockquote class="transclude" data-url="Metasploit-MS-SQL-modules" data-block data-embed-alias="spells/Metasploit MS SQL modules"><h1>Metasploit MS SQL modules</h1><p>Metasploit provides <a href="https://github.com/slyth11907/Cheatsheets/blob/master/Cheatsheet_AttackingMSSQL.txt" class="external" target="_blank">a lot of tools<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> for enumerating and exploiting <a href="../spells/Metasploit-MS-SQL-modules/../../spells/MS-SQL" class="internal alias" data-slug="spells/MS-SQL">MS SQL</a>.</p>
<ul>
<li><code>auxiliary/scanner/mssql/mssql_ping</code> — Discover <a href="../spells/Metasploit-MS-SQL-modules/../../spells/MS-SQL" class="internal alias" data-slug="spells/MS-SQL">MS SQL</a> servers (alternatively, use <code>--script=ms-sql-info</code> with <a href="../spells/Metasploit-MS-SQL-modules/../../spells/Nmap" class="internal alias" data-slug="spells/Nmap">Nmap</a>)</li>
<li><code>auxiliary/scanner/mssql/mssql_login</code> — Brute force logins</li>
<li><code>auxiliary/admin/mssql/mssql_enum</code> — Enumerate databases</li>
<li><code>exploit/windows/mssql/mssql_payload</code> — Get a shell</li>
</ul><a href="../spells/Metasploit-MS-SQL-modules" class="internal transclude-src">Link to original</a></blockquote><p></p></article><hr/><div class="page-footer"><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li><a href="../spells/meterpreter" class="internal">meterpreter</a></li></ul></div></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false}"></div><button id="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" id="toc" class aria-controls="toc-content" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content" class><ul class="overflow"><li class="depth-0"><a href="#commands" data-for="commands">Commands</a></li><li class="depth-0"><a href="#modules" data-for="modules">Modules</a></li><li class="depth-1"><a href="#options" data-for="options">Options</a></li><li class="depth-0"><a href="#payloads" data-for="payloads">Payloads</a></li><li class="depth-1"><a href="#scanners" data-for="scanners">Scanners</a></li><li class="depth-1"><a href="#exploits" data-for="exploits">Exploits</a></li><li class="depth-1"><a href="#meterpreter" data-for="meterpreter">meterpreter</a></li><li class="depth-1"><a href="#cifs" data-for="cifs">CIFS</a></li><li class="depth-1"><a href="#ms-sql" data-for="ms-sql">MS SQL</a></li></ul></div></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.4.0</a> © 2025</p><ul><li><a href="/">Home</a></li><li><a href="https://github.com/necopinus/resume/raw/main/resume.pdf">Resume</a></li><li><a href="/#contact">Contact</a></li><li><a href="/grimoire/index.xml">RSS Feed</a></li></ul></footer></div></div></body><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script src="../postscript.js" type="module"></script></html>